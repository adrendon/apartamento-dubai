"use strict";(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[3202],{82240:(t,e,i)=>{i.d(e,{U:()=>S});var s=i(68909);class n{constructor(t,e,i){return this.thisType=t,this.container=e,this.mesh=i(),this.mesh.name=`${t.name}`,this.material=this.mesh.material,this.geometry=this.mesh.geometry,this}opacity(t){return this.material.opacity=t,this}}function a(t,e){e.forEach((e=>{Object.getOwnPropertyNames(e.prototype).forEach((i=>{t.prototype[i]=e.prototype[i]}))}))}class o{constructor(){this.animationInit=!1}initAnimationMixin(t,e){this.animState={scale:e?e.clone():new s.Vector3(1,1,1),position:t?t.clone():new s.Vector3,target:{hasInitialTarget:!1,scale:e?e.clone():new s.Vector3(1,1,1),position:t?t.clone():new s.Vector3},start:{scale:e?e.clone():new s.Vector3(1,1,1),position:t?t.clone():new s.Vector3},temp:{pos:new s.Vector3,scale:new s.Vector3,makeScale:new s.Vector3},easing:{startTime:0,duration:0,easePosition:void 0,easeScale:void 0,active:!1}},this.animationInit=!0}update(t,e,i){if(!this.animationInit)throw Error(`${o.name} call this.initAnimationMixin() in ${this.style} constructor to enable update, because I said so.`);this.mesh.position.copy(t),i&&this.mesh.quaternion.copy(i);const s=this.vector3From(e);return s.equals(this.mesh.scale)||this.mesh.scale.copy(s),this.animState.scale.copy(this.mesh.scale),this.animState.position.copy(this.mesh.position),this.mesh.updateMatrixWorld(!0),this}animate(t,e,i,s){if(!this.animationInit)throw Error(`${o.name} call this.initAnimationMixin() in ${this.style} constructor to enable animations, because I said so.`);const n=this.vector3From(i),a=!this.animState.target.position.equals(e)||!this.animState.target.scale.equals(n);if(this.animState.target.scale.copy(n),this.animState.target.position.copy(e),this.animState.target.hasInitialTarget)if(null!=(null==s?void 0:s.duration)&&s.duration>0){const t=performance.now()/1e3;!a&&this.animState.easing.active||(this.animState.start.position.copy(this.mesh.position),this.animState.start.scale.copy(this.mesh.scale),this.animState.easing.startTime=t,this.animState.easing.duration=s.duration,this.animState.easing.easePosition=s.easePosition,this.animState.easing.easeScale=s.easeScale,this.animState.easing.active=!0);const i=t-this.animState.easing.startTime,o=this.animState.easing.duration,r=this.animState.easing.easePosition?this.animState.easing.easePosition(i,0,1,o):Math.min(i/o,1),h=this.animState.easing.easeScale?this.animState.easing.easeScale(i,0,1,o):Math.min(i/o,1),c=Math.min(i/o,1),l=this.animState.temp.pos.copy(this.animState.start.position).lerp(e,r),p=this.animState.temp.scale.copy(this.animState.start.scale).lerp(n,h);c>=1&&(this.animState.easing.active=!1),this.update(l,p)}else{this.animState.easing.active=!1;const i=this.animState.temp.pos.copy(this.mesh.position).lerp(e,t),s=this.animState.temp.scale.copy(this.mesh.scale).lerp(n,t);this.update(i,s)}else this.animState.target.hasInitialTarget=!0,this.update(e,n);return this}vector3From(t){if(t instanceof s.Vector3)return this.animState.temp.makeScale.copy(t).clamp(h,c);if("number"==typeof t)return this.animState.temp.makeScale.set(t,t,t).clamp(h,c);throw Error("Unexpected scale input")}}const r=.01,h=new s.Vector3(r,r,r),c=new s.Vector3(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);class l{toggle(t,e){return t?this.container.add(this.mesh):this.container.remove(this.mesh),this.isVisible=t,null==e||e(t,this),this}}class p extends n{constructor(t,e){super(p,t,(()=>new s.Mesh(new s.BoxGeometry(1,1,1),new s.MeshBasicMaterial(e)))),this.container=t,this.style="Box",this.mesh.frustumCulled=!1,this.geometry.computeBoundingBox(),this.initAnimationMixin()}}a(p,[o,l]);class m extends n{constructor(t,e){super(m,t,(()=>{const t=new s.Box3Helper((new s.Box3).setFromCenterAndSize(new s.Vector3,new s.Vector3(1,1,1)));return new s.LineSegments(t.geometry,t.material)})),this.container=t,this.style="BoxWireframeMesh",e&&this.material.setValues(e),this.mesh.frustumCulled=!1,this.initAnimationMixin()}}a(m,[l,o]);class u extends n{constructor(t,e){super(u,t,(()=>new s.CameraHelper(e))),this.container=t,this.style="CameraHelper",this.updateCamera(e)}updateCamera(t){return this.mesh.camera.copy(this.camWithSaneFarDistance(t)),this.mesh.update(),this}camWithSaneFarDistance(t){const e=t.clone();return e.far=5,e}}a(u,[l]);class g extends n{constructor(t,e){super(g,t,(()=>new s.Mesh(new s.PlaneGeometry(1),new s.MeshBasicMaterial(e)))),this.container=t,this.style="PlaneMesh",this.radius=1;const i=new s.Matrix4;i.makeRotationFromEuler(new s.Euler(-Math.PI/2,0,0,"XYZ")),this.geometry.applyMatrix4(i),this.mesh.frustumCulled=!1,this.initAnimationMixin()}}a(g,[l,o]);class d extends n{constructor(t,e){super(d,t,(()=>new s.Mesh(new s.SphereGeometry(1),new s.MeshBasicMaterial(e)))),this.container=t,this.style="SphereMesh",this.radius=1,this.mesh.frustumCulled=!1,this.initAnimationMixin()}}a(d,[l,o]);var w=i(38069);class y extends n{constructor(t,e){return super(y,t,(()=>new s.Line(new s.BufferGeometry,new s.LineBasicMaterial(Object.assign({color:w.V.MP_BRAND,opacity:1,transparent:!0},e))))),this.container=t,this.positionsBuffer=new s.BufferAttribute(new Float32Array(150),3),this.point=new s.Vector3,this.points={start:new s.Vector3,control:new s.Vector3,end:new s.Vector3},this.updatePoints=(t,e,i)=>{this.points.start.copy(this.curve.v0.copy(t)),this.points.control.copy(this.curve.v1.copy(e)),this.points.end.copy(this.curve.v2.copy(i));for(let t=0;t<50;t++){const e=t/49;this.curve.getPoint(e,this.point),this.positionsBuffer.setXYZ(t,this.point.x,this.point.y,this.point.z)}return this.positionsBuffer.needsUpdate=!0,this},this.animatePoints=(t,e,i,s)=>{const{start:n,control:a,end:o}=this.points;return n.equals(a)&&n.equals(o)?(this.updatePoints(e,i,s),this):(n.lerp(e,t),a.lerp(i,t),o.lerp(s,t),this.updatePoints(n,a,o),this)},this.mesh.frustumCulled=!1,this.curve=new s.QuadraticBezierCurve3(new s.Vector3,new s.Vector3,new s.Vector3),this.geometry.setAttribute("position",this.positionsBuffer),this.geometry.computeBoundingBox(),this}}a(y,[l]);var b=i(52514),f=i(4679);class S{constructor(t,e={}){this.cache={},this.helperCache={},this.style={},this.toggle=t=>(this.options.scene&&(t?this.options.scene.add(this.options.container):this.options.scene.remove(this.options.container)),this),this.box=(t,e)=>(this.cache[x.box][t]||(this.cache[x.box][t]=new p(this.options.container,e).toggle(!0)),this.cache[x.box][t]),this.boxWire=(t,e)=>(this.cache[x.boxWire][t]||(this.cache[x.boxWire][t]=new m(this.options.container,e).toggle(!0)),this.cache[x.boxWire][t]),this.cam=(t,e)=>(this.cache[x.cameraHelper][t]||(this.cache[x.cameraHelper][t]=new u(this.options.container,e).toggle(!0)),this.cache[x.cameraHelper][t]),this.label=(t,e,i,s=.25)=>{if(!this.labelCreator){const{color:t,backgroundColor:e,backgroundOpacity:i,background:s}=this.options;this.labelCreator=new b.Il(Object.assign({color:t,background:s,backgroundColor:e,backgroundOpacity:i,wordWrapWidth:650},this.style))}if(!this.cache[x.label][t]){const n=this.labelCreator.createLabel();this.cache[x.label][t]=n,n.position.copy(i),n.text=e,n.scaleFactor=s,this.options.container.add(n)}return this.cache[x.label][t]},this.line=(t,e=this.options.lineColor,i=this.options.linewidth)=>(this.cache[x.line][t]||(this.cache[x.line][t]=f.e.makeLine({color:e,linewidth:i,container:this.options.container})),this.cache[x.line][t]),this.plane=(t,e)=>(this.cache[x.plane][t]||(this.cache[x.plane][t]=new g(this.options.container,e).toggle(!0)),this.cache[x.plane][t]),this.setStyle=t=>{this.style=t},this.sphere=(t,e)=>(this.cache[x.sphere][t]||(this.cache[x.sphere][t]=new d(this.options.container,e).toggle(!0)),this.cache[x.sphere][t]),this.triangle=(t,e,i,n,a)=>{if(!this.cache[x.triangle][t]){const o=new Float32Array(9);e.toArray(o,0),i.toArray(o,3),n.toArray(o,6);const r=new s.BufferGeometry;r.setAttribute("position",new s.BufferAttribute(o,3));const h=new s.Mesh(r,new s.MeshBasicMaterial(a));this.options.container.add(h),this.cache[x.triangle][t]=new d(this.options.container,a).toggle(!0)}return this.cache[x.triangle][t]},this.spline=(t,e)=>(this.cache[x.spline][t]||(this.cache[x.spline][t]=new y(this.options.container,e).toggle(!0)),this.cache[x.spline][t]),this.randomColor=t=>{if(void 0!==t){if(!this.helperCache[V.color][t]){const e=new s.Color(M(),M(),M());this.helperCache[V.color][t]=e}return this.helperCache[V.color][t]}return new s.Color(M(),M(),M())},this.randomVector3=t=>{if(void 0!==t){if(!this.helperCache[V.vector3][t]){const e=new s.Vector3(2*(.5-M()),2*(.5-M()),2*(.5-M()));this.helperCache[V.vector3][t]=e}return this.helperCache[V.vector3][t]}return new s.Vector3(2*(.5-M()),2*(.5-M()),2*(.5-M()))},this.toggleAll=t=>{for(const e of Object.values(x)){const i=Object.values(this.cache[e]);for(const e of i)"toggle"in e&&e.toggle(t)}return this},this.options=Object.assign(Object.assign({},v),t),this.style=e;for(const t of Object.values(x))this.cache[t]={};for(const t of Object.values(V))this.helperCache[t]={};this.options.scene&&this.toggle(!0)}async addToScene(t){return this.options.scene=t,this.toggle(!0),this}}const M=()=>Math.random(),v={lineColor:w.V.WHITE.clone(),linewidth:2,color:w.V.WHITE.clone(),background:!0,backgroundColor:w.V.WHITE.clone(),backgroundOpacity:.5,container:new s.Group};var x,V;!function(t){t.box="box",t.boxWire="boxWire",t.label="label",t.line="line",t.plane="plane",t.sphere="sphere",t.spline="spline",t.triangle="triangle",t.cameraHelper="cameraHelper"}(x||(x={})),function(t){t.color="color",t.vector3="vector3"}(V||(V={}))},83075:(t,e,i)=>{i.d(e,{P:()=>a,m:()=>o});var s=i(6687),n=i(99276);const a=t=>!!t&&t instanceof n.B,o={hasMeshGroup:t=>"object"==typeof t&&!!t&&"meshGroup"in t,hasMeshSubgroup:t=>"object"==typeof t&&!!t&&"meshSubgroup"in t,hasLayerId:t=>"object"==typeof t&&!!t&&"layerId"in t,isRoomMesh:a,isVisibleRoomMesh:t=>a(t)&&(0,s.dW)(t)}}}]);