"use strict";(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[2276],{12850:(e,t,n)=>{n.r(t),n.d(t,{default:()=>d});var i=n(15564),s=n(90082),a=n(32484),r=n(71687),o=n(72311);const{TEXTURE_SETTINGS:l,clearRaycastHits:u}=a.yJ;const d=async function(e){if(!o.DEBUG_TILEDMESH_SETTINGS.debug)return;const t=await e.getModuleBySymbol(s.ZF),n=await e.getModuleBySymbol(r.GR),a=t.addPanel(i.F.TITLE,i.F.HOTKEYS,{width:350});await t.loadPromise.then((()=>{const e="meshtextures";[{panel:a,header:e,setting:"disableTextureStreamBelowLod",initialValue:()=>-1,onChange:e=>{e>-1&&n.textureQualityMap.limitStreamingBelow(e)},urlParam:!0,rangePrecision:0,range:[-1,7]},{panel:a,header:e,setting:"textureStreamPause",initialValue:()=>l.debugPauseTexStream,onChange:e=>{l.debugPauseTexStream=e},urlParam:!0},{panel:a,header:e,setting:"textureStreamRaycastHits",initialValue:()=>l.debugLOD,onChange:e=>{l.debugLOD=e,e||u()},urlParam:!0},{panel:a,header:e,setting:"debugRTTQuality",initialValue:()=>l.debugRttQuality,onChange:e=>{l.debugRttQuality=e,e||n.setMeshOverlay({})},urlParam:!0},{panel:a,header:e,setting:"debugRTTScores",initialValue:()=>l.debugRttScores,onChange:e=>{l.debugRttScores=e,e||n.setMeshOverlay({})},urlParam:!0}].forEach((e=>t.registerMenuEntry(e)))}))}},82012:(e,t,n)=>{n.r(t),n.d(t,{default:()=>x});var i=n(68909),s=n(84440),a=n(25316),r=n(90082),o=n(26072),l=n(32502),u=n(47299),d=n(50839),h=n(22278),c=n(14240),g=n(90351),m=n(2593),M=n(71687),p=n(82240);Math.PI,Math.PI;function f(e,t){return e+Math.random()*(t-e)}var y=n(81662),v=n(72773);async function x(e){const t=await e.getModuleBySymbol(M.GR),[n,x,T]=await Promise.all([e.market.waitForData(a.o),e.getModuleBySymbol(r.ZF),e.getModuleBySymbol(M.UN)]);await x.loadPromise.then((()=>{let a=null;x.registerMenuEntry({header:"Mesh",setting:"Toggle Trim Bounds",initialValue:()=>!1,onChange:n=>{a||(a=new p.U,e.getModuleBySymbol(M.M7).then((e=>null==a?void 0:a.addToScene(e.getScene()))));for(const e of t.meshTrimData.meshTrimsById.values)a.boxWire(e.id,{color:-1===e.meshGroup?new i.Color("red"):(0,s.Mq)(e.meshGroup)}).update(e.position,e.scale.clone().multiplyScalar(.5),e.rotation).toggle(n)},urlParam:!0}),x.registerButton("Mesh","Toggle visible",(()=>{t.meshes.forEach((e=>{e.modelMesh.visible=!e.modelMesh.visible}))})),x.registerButton("Mesh","Toggle UV debug",(()=>{const e=t.meshes.entries()[0][1].renderer.chunkRenderingModeOverride?null:l.f.UV;t.setChunkRenderingMode(e)})),x.registerButton("Mesh","Toggle depth",(()=>{const e=t.meshes.entries()[0][1].renderer.chunkRenderingModeOverride?null:l.f.Depth;t.setChunkRenderingMode(e)})),x.registerButton("Mesh","Toggle transparent",(()=>{const e=t.meshes.entries()[0][1].renderer.chunkRenderingModeOverride?null:l.f.Transparent;t.setChunkRenderingMode(e)})),x.registerButton("Mesh","Toggle wireframe",(()=>{const e=t.meshes.entries()[0][1].renderer.chunkRenderingModeOverride?null:l.f.Wireframe;t.setChunkRenderingMode(e)}));let r=!0===Boolean(new URLSearchParams(window.location.search).get("flat"));const S=()=>{t.meshes.forEach((e=>{e.modelMesh instanceof g.f&&e.modelMesh.notifyOnChunksLoaded((e=>{for(const t of e)t.setFlatShading(r)}));for(const t of e.modelMesh.chunks)t.setFlatShading(r)}))};S(),x.registerButton("Mesh","Toggle flat shading",(()=>{r=!r,S()}));const b=(()=>{let e=!1;return(n,a)=>{const r=new i.Vector4(1,1,1,0);var o;e=!e,o=n||e,t.meshes.forEach((e=>{for(const t of e.modelMesh.chunks){const e=a?100*t.id:100*t.meshSubgroup,n=o?(0,s.Zd)(.5,e):r;t.setColorOverlay(n)}}))}})();x.registerButton("Mesh","Highlight Rooms",b),x.registerButton("Mesh","Highlight Chunks",(()=>b(!0,!0))),x.registerButton("Mesh","Random Mesh Trims",(()=>async function(e,t){const n=[],{meshBounds:s}=await t.market.waitForData(h.U),{meshTrimData:a}=await t.getModuleBySymbol(M.GR);for(let t=0;t<e;t++){const e=new c.e(new i.Vector3(f(s.min.x,s.max.x),(s.min.y+s.max.y)/2,f(s.min.z,s.max.z)),new i.Vector3(f(.1,2),s.getSize(new i.Vector3).y+.1,f(.1,2)),(new i.Quaternion).setFromAxisAngle(y.B1.UP,Math.random()*Math.PI),Number.MAX_SAFE_INTEGER,!0,v.Zu,new Date,new Date,void 0,"temp",!0,!0);e.transient=!0,n.push(e)}a.add(...n)}(5,e))),n.onSettingChanged(u.Vp,(e=>{t.meshes.forEach((t=>{const n=T.getFullBounds();for(const i of t.modelMesh.chunks)i.setMaterialsUniform({floorTrimHeight:1-e/100,floorHeightMin:n.min.y,floorHeightMax:n.max.y},!0)}))}));const w=(e,t,i,s,a)=>{x.registerSetting(e,t,i,!0,o.u.NONE,a),n.onSettingChanged(t,s)};w("Wireframe",u._Z,!1,(e=>{t.meshes.forEach((t=>{for(const n of t.modelMesh.chunks)n.setWireframe(e)}))}));const E={[d.d.Wireframe]:{Wireframe:["thickness","wireframeOpacity","stroke","fillEnabled","fill","insideAltColor","dualStroke","secondThickness"],"Wireframe Dashes":["dashEnabled","dashLength","dashAnimate","dashOverlap"],"Wireframe Advanced":["squeeze","squeezeMin","squeezeMax"]}};for(const e in E){const n=m.f.uniforms[e];for(const i in E[e])for(const s of E[e][i])w(i,s,n[s].value,(e=>{t.meshes.forEach((t=>{for(const n of t.modelMesh.chunks)n.setMaterialsUniform({[s]:e})}))}),n[s].range)}}))}},72311:(e,t,n)=>{n.r(t),n.d(t,{DEBUG_TILEDMESH_SETTINGS:()=>p,default:()=>V,tiledMeshDebugMenu:()=>w});var i=n(68909),s=n(77201),a=n(90082),r=n(97800),o=n(71687),l=n(84440),u=n(25712),d=n(32484),h=n(47299),c=n(90351),g=n(15564);const m=new r.Vy("tiled-mesh"),{TILEDMESH_SETTINGS:M}=d.yJ,p={hideMenu:"1"!==(0,r.P3)("dmenu","0"),debug:"1"===(0,r.P3)("debugTiles","0")||"1"===(0,r.P3)("debug-tiles","0"),statsTiles:!1,statsTileset:!0,statsTextures:!0,statsTextureStream:!0};let f=null;function y(e,t,n){f||(f=document.createElement("div"),f.style.color="#FFFFFF",f.style.fontFamily="Roboto",f.style.fontWeight="300",f.style.fontSize="12px",f.style.position="absolute",f.style.top="85px",f.style.width="500px",f.style.pointerEvents="none",f.style.whiteSpace="pre",f.style.zIndex="99999",f.style.textShadow="0 0 1px black, 0 0 1px black, 0 0 1px black, 0 0 1px black",document.body.appendChild(f));let i="\n\n";i+=function(e){const t=e.threeRenderer.info,n=`three:\n  drawCalls: ${t.render.calls}\n  geometries: ${t.memory.geometries}\n  textures: ${t.memory.textures}\n  triangles: ${t.render.triangles}\n  memory allocated (megs): ${Math.floor(e.estimatedGPUMemoryAllocated()/2**20)}`;return n}(e),i+=p.statsTextureStream?function(e){const t=`\ntextureStreaming:\n  downloadingTiles: ${e.downloadingTiles} / ${e.totalTiles}\n  downloadingTextures: ${e.loadingTextures}\n`,n="  downloaded:\n"+Object.keys(e.totalTextures).map((t=>`    ${t}: ${e.totalTextures[t]} `)).join("\n")+"\n";return t+n}(n):"",t.forEach(((e,t)=>{const n=e.modelMesh;i+=`\n\n<mesh: id:${t}>`,i+=p.statsTileset?function(e,t){var n,i,s,a,r;if(t instanceof c.f==!1)return"\n  (not a tiled mesh)\n";const o=null==e?void 0:e.tilesRenderer,l=Object.values(null!==(n=null==o?void 0:o.tileSets)&&void 0!==n?n:[])[0];return`\n  tileset: preset: ${null===(i=null==l?void 0:l.asset.extras)||void 0===i?void 0:i.preset}, depth: ${null===(s=null==l?void 0:l.asset.extras)||void 0===s?void 0:s.depth}, version: ${null==l?void 0:l.asset.tilesetVersion}\n  view: errorTarget: ${null===(a=null==t?void 0:t.settings)||void 0===a?void 0:a.errorTarget}, maxLOD: ${null===(r=null==t?void 0:t.settings)||void 0===r?void 0:r.maxLOD}, detail: '${null==t?void 0:t.detail}'\n`}(n.tileLoader,n):"",i+=p.statsTiles?function(e){if(!e)return"";const t=e.tilesRenderer,n=t.visibleTiles,i={};n.forEach((e=>{var t;const n=`lod${null===(t=e.extras)||void 0===t?void 0:t.level}`,s=i[n]||0;i[n]=s+1}));const{stats:s,downloadQueue:a,parseQueue:r,lruCache:o}=t,{active:l,downloading:u,inFrustum:d,parsing:h,used:c,visible:g}=s,m=`  tiles:\n    tiles in frustum: ${d}\n    visible: ${g}`+Object.keys(i).sort().map((e=>`\n     ${e} tiles: ${i[e]||0}`)).join()+`\n    downloading gltf: ${u}\n    parsing gltf: ${h}\n    active: ${l}\n    used: ${c}\n    queues:\n      download: ${a.currJobs} running, ${a.items.length} waiting\n      parse: ${r.currJobs} running, ${r.items.length} waiting\n    lruCache: ${o.itemSet.size}\n`;return m}(n.tileLoader):"",i+=`</mesh: id:${t}>`})),f.textContent=i}function v(e,t,n,a,r,o){S&&(e.forEach(((e,n)=>{e.modelMesh&&!T.has(e.modelMesh)&&e.modelMesh instanceof c.f&&(T.add(e.modelMesh),x.push(...function(e,t,n,s){const a=[{panel:e,header:t.tile+": "+n,setting:"maxLOD: "+n,initialValue:()=>{var e,t;return null!==(t=null===(e=null==s?void 0:s.settings)||void 0===e?void 0:e.maxLOD)&&void 0!==t?t:M.maxLOD},onChange:e=>{s&&s.settings&&(s.settings.maxLOD=e)},range:[0,4],rangePrecision:0},{panel:e,header:t.tile+": "+n,setting:"nonMeshMaxLOD: "+n,initialValue:()=>{var e,t;return null!==(t=null===(e=null==s?void 0:s.settings)||void 0===e?void 0:e.nonMeshMaxLOD)&&void 0!==t?t:M.nonMeshMaxLOD},onChange:e=>{s&&s.settings&&(s.settings.nonMeshMaxLOD=e)},range:[0,4],rangePrecision:0},{panel:e,header:t.tile+": "+n,setting:"minLOD: "+n,initialValue:()=>{var e,t;return null!==(t=null===(e=null==s?void 0:s.settings)||void 0===e?void 0:e.minLOD)&&void 0!==t?t:M.minLOD},onChange:e=>{s&&s.settings&&(s.settings.minLOD=e)},range:[0,4],rangePrecision:0},{panel:e,header:t.tile+": "+n,setting:"errorTarget:"+n,initialValue:()=>{var e,t;return null!==(t=null===(e=null==s?void 0:s.settings)||void 0===e?void 0:e.errorTarget)&&void 0!==t?t:M.errorTarget},onChange:e=>{s&&s.settings&&(s.settings.errorTarget=e)},range:[0,20],rangePrecision:1,urlParam:!0},{panel:e,header:t.tile+": "+n,setting:"disableTileUpdates:"+n,initialValue:()=>{var e,t;return null!==(t=null===(e=null==s?void 0:s.settings)||void 0===e?void 0:e.disableTileUpdates)&&void 0!==t?t:M.disableTileUpdates},onChange:e=>{s&&s.settings&&(s.settings.disableTileUpdates=e)}},{panel:e,header:t.tile+": "+n,setting:"disposeModel: "+n,initialValue:()=>{var e,t;return null!==(t=null===(e=null==s?void 0:s.settings)||void 0===e?void 0:e.disposeModel)&&void 0!==t?t:M.disposeModel},onChange:e=>{s&&s.settings&&(s.settings.disposeModel=e)}},{panel:e,header:t.tile+": "+n,setting:"pos on z axis: "+n,initialValue:()=>0,onChange:e=>{s.position.copy(new i.Vector3(0,0,e)),s.updateMatrixWorld(!0)},range:[-100,100],rangePrecision:0}];return a}(t,a,n,e.modelMesh)),x.push(...function(e,t,n,i,a,r){const o=i.tileLoader,d=E(o,r,((e,t)=>e.setWireframe(t))),h=function(e,t){const n={scale:1},i=(t,i)=>{if(!t)return;const s=e.container.tilesByChunkId.get(t.id),a=(null==s?void 0:s.__error)||1e-4,r=t.lod!==M.maxLOD&&a>M.errorTarget?1:.5,o=Math.max(0,Math.min(1,1-n.scale/a)),l=i?C(t.lod,o,r):null;t.setColorOverlay(l)},a=E(e,t,i),r=(0,s.f9)((()=>a.colorize(e.container.chunks)));return{toggle:e=>{e?r.renew():r.cancel(),a.toggle(e)},colorize:a.colorize,subscription:r,config:n}}(o,r),c=E(o,r,((e,t)=>{e.setColorOverlay(t?C(e.lod,1,.5):null)})),g=E(o,r,((e,t)=>{e.setColorOverlay(t?(0,l.Zd)(.5,e.id||0):null)})),p=E(o,r,((e,t)=>{var n;const i=o.container.tilesByChunkId.get(e.id);e.setColorOverlay(t?(0,l.Zd)(.5,(0,u.s5)((null===(n=null==i?void 0:i.content)||void 0===n?void 0:n.uri)||"missing")||0):null)})),f=E(o,r,((e,t)=>{e.setColorOverlay(t?(0,l.Zd)(.5,(e.meshGroup<<16)+e.meshSubgroup||0):null)})),y=E(o,r,((e,t)=>{e.setColorOverlay(t?(0,l.Zd)(.5,e.meshSubgroup||0):null)})),v=E(o,r,((e,t)=>{e.setColorOverlay(t?(0,l.Zd)(.5,e.meshGroup||0):null)})),x=E(o,r,((e,t)=>{e.setColorOverlay(t?(0,l.Zd)(.5,(0,u.s5)(e.textureName)||0):null)})),T=E(o,r,((e,t)=>{const n=o.container.tilesByChunkId.get(e.id);e.setColorOverlay(t?(0,l.Zd)(.5,(null==n?void 0:n.geometricError)||0):null)})),S=a.slots,b=i.textureQualityMap,w=E(o,r,((e,t)=>{const n=S.find((t=>t.textureName===e.textureName));if(n){const i=n.loading?1:n.quality>b.min(e.lod)?.7:.3,s=b.maxTexelSize/b.get(n.quality).texelSize;e.setColorOverlay(t?C(e.lod,s,i):null)}})),P=(0,s.f9)((()=>w.colorize(o.container.chunks)));let V="none";const z={none:void 0,byError:h,byGeometricError:T,byTile:p,bySubgroup:y,byMeshgroup:v,bySubAndMeshgroup:f,byTexture:x,byStreamedTextures:{subscription:P,toggle:e=>{e?P.renew():P.cancel(),e&&m.info("colorize=byStreamedTextures solid color: loading, dark color: streamed, light color: basis"),w.toggle(e)}},byChunk:g,byLod:c},B=[{panel:e,header:`${t.viz}: ${n}`,setting:"disableTileUpdates:"+n,initialValue:()=>{var e;return(null===(e=null==i?void 0:i.settings)||void 0===e?void 0:e.disableTileUpdates)||!1},onChange:e=>{i&&i.settings&&(i.settings.disableTileUpdates=e)},urlParam:!0},{panel:e,header:`${t.viz}: ${n}`,setting:"wireframe:"+n,initialValue:()=>!1,onChange:d.toggle,urlParam:!0},{panel:e,header:`${t.viz}: ${n}`,setting:"colorize:"+n,initialValue:()=>"none",onChange:e=>{var t,n;null===(t=z[V])||void 0===t||t.toggle(!1),null===(n=z[e])||void 0===n||n.toggle(!0),V=e},options:Object.keys(z),urlParam:!0},{panel:e,header:`${t.viz}: ${n}`,setting:"colorizeByErrorScale:"+n,initialValue:()=>1,onChange:e=>{h.config.scale=e},range:[0,6],rangePrecision:3,urlParam:!0}];return B}(t,a,n,e.modelMesh,r,o)))})),x.length&&(x.forEach((e=>n.registerMenuEntry(e))),x.length=0))}const x=[],T=new Set;let S=!1,b=null;async function w(e){if(!p.debug)return;const t=await e.getModuleBySymbol(a.ZF),n=await e.getModuleBySymbol(o.mL),i=await e.getModuleBySymbol(o.M7),s=i.getScene(),l=await e.getModuleBySymbol(o.GR);await l.firstMeshLoadPromise,await(0,r.cb)(100);const u=t.tryGetSetting(h.sz,!1),d=t.addPanel(g.F.TITLE,g.F.HOTKEYS,{width:350}),c={viz:"visualize",stats:"stats",tile:"tileset",log:"log"};function f(){b||(b=setInterval((()=>{y(i,l.meshes,l.meshTextureLoader),v(l.meshes,d,t,c,l.meshTextureLoader,e)}),150))}const x=[{panel:d,header:c.stats,setting:"tilesetStatsOverlay",initialValue:()=>p.statsTileset,onChange:e=>{p.statsTileset=e,e&&f()},urlParam:!0},{panel:d,header:c.stats,setting:"tileStatsOverlay",initialValue:()=>p.statsTiles,onChange:e=>{p.statsTiles=e,e&&f()},urlParam:!0},{panel:d,header:c.stats,setting:"textureStatsOverlay",initialValue:()=>p.statsTextures,onChange:e=>{p.statsTextures=e,e&&f()},urlParam:!0},{panel:d,header:c.stats,setting:"textureStreamingOverlay",initialValue:()=>p.statsTextureStream,onChange:e=>{p.statsTextureStream=e,e&&f()},urlParam:!0}],T=[{panel:d,header:c.log,buttonName:"Log: App State",callback:()=>{m.warn(l.meshes),m.warn(n),m.warn(s),m.warn(t)}}];u&&(p.hideMenu||await(0,r.cb)(1e3).then((()=>{t.getSettingsGui().loadGuiPackage().then((()=>{t.getSettingsGui().toggle(t.getMainPanelId()),t.getSettingsGui().toggle(t.getMainPanelId())}))})),await(0,r.cb)(16),S||(await(0,r.cb)(16),S=!0,function(e,t,n,i){const s=[{panel:e,header:t.tile,setting:"smallMeshThreshold",initialValue:()=>M.smallMeshThreshold,onChange:e=>{M.smallMeshThreshold=e,i.forEach((t=>{const n=t.modelMesh;n&&n.settings&&(n.settings.smallMeshThreshold=e)}))},range:[0,100],rangePrecision:1,urlParam:!0},{panel:e,header:t.tile,setting:"smallMeshErrorMultiplier",initialValue:()=>M.smallMeshErrorMultiplier,onChange:e=>{M.smallMeshErrorMultiplier=e,i.forEach((t=>{const n=t.modelMesh;n&&n.settings&&(n.settings.smallMeshErrorMultiplier=e)}))},range:[.01,2],rangePrecision:2,urlParam:!0},{panel:e,header:t.tile,setting:"displayActiveTiles",initialValue:()=>M.displayActiveTiles,onChange:e=>{M.displayActiveTiles=e,i.forEach((t=>{const n=t.modelMesh;n&&n.settings&&(n.settings.displayActiveTiles=e)}))},urlParam:!0},{panel:e,header:t.tile,setting:"loadSiblings",initialValue:()=>M.loadSiblings,onChange:e=>{M.loadSiblings=e,i.forEach((t=>{const n=t.modelMesh;n&&n.settings&&(n.settings.loadSiblings=e)}))},urlParam:!0},{panel:e,header:t.tile,setting:"autoDisableRendererCulling",initialValue:()=>M.autoDisableRendererCulling,onChange:e=>{M.autoDisableRendererCulling=e,i.forEach((t=>{const n=t.modelMesh;n&&n.settings&&(n.settings.autoDisableRendererCulling=e)}))},urlParam:!0},{panel:e,header:t.tile,setting:"stopAtEmptyTiles",initialValue:()=>M.stopAtEmptyTiles,onChange:e=>{M.stopAtEmptyTiles=e,i.forEach((t=>{const n=t.modelMesh;n&&n.settings&&(n.settings.stopAtEmptyTiles=e)}))},urlParam:!0},{panel:e,header:t.tile,setting:"limitMemoryUsage",initialValue:()=>M.limitMemoryUsage,onChange:e=>{M.limitMemoryUsage=e,i.forEach((t=>{const n=t.modelMesh;n&&n.settings&&(n.settings.limitMemoryUsage=e)}))},urlParam:!0},{panel:e,header:t.tile,setting:"allocatedMegsBeforeLimitingLod",initialValue:()=>M.allocatedMegsBeforeLimitingLod,onChange:e=>{M.allocatedMegsBeforeLimitingLod=e,i.forEach((t=>{const n=t.modelMesh;n&&n.settings&&(n.settings.allocatedMegsBeforeLimitingLod=e)}))},urlParam:!0,range:[100,1e3]},{panel:e,header:t.tile,setting:"lruMinExtraTiles",initialValue:()=>M.lruMinExtraTiles,onChange:e=>{M.lruMinExtraTiles=e,i.forEach((t=>{const n=t.modelMesh;n&&n.settings&&(n.settings.lruMinExtraTiles=e)}))},urlParam:!0,range:[0,2e3]},{panel:e,header:t.tile,setting:"lruMaxTiles",initialValue:()=>M.lruMaxTiles,onChange:e=>{M.lruMaxTiles=e,i.forEach((t=>{const n=t.modelMesh;n&&n.settings&&(n.settings.lruMaxTiles=e)}))},urlParam:!0,range:[0,2e3]},{panel:e,header:t.tile,setting:"lruUnloadPercent",initialValue:()=>M.lruUnloadPercent,onChange:e=>{M.lruUnloadPercent=e,i.forEach((t=>{const n=t.modelMesh;n&&n.settings&&(n.settings.lruUnloadPercent=e)}))},urlParam:!0,range:[0,1]},{panel:e,header:"Priority",setting:"errorMultiplierRaycastOcclusion",initialValue:()=>M.errorMultiplierRaycastOcclusion,onChange:e=>{M.errorMultiplierRaycastOcclusion=e,i.forEach((t=>{const n=t.modelMesh;n&&n.settings&&(n.settings.errorMultiplierRaycastOcclusion=e)}))},range:[.001,1],rangePrecision:2},{panel:e,header:"Priority",setting:"errorMultiplierHiddenFloors",initialValue:()=>M.errorMultiplierHiddenFloors,onChange:e=>{M.errorMultiplierHiddenFloors=e,i.forEach((t=>{const n=t.modelMesh;n&&n.settings&&(n.settings.errorMultiplierHiddenFloors=e)}))},range:[.001,1],rangePrecision:2}];return s}(d,c,0,l.meshes).forEach((e=>t.registerMenuEntry(e))),x.forEach((e=>t.registerMenuEntry(e))),T.forEach((e=>t.registerMenuButton(e)))))}function E(e,t,n){let i=!1;const a=e=>{t.after(s.Rb.End).then((()=>{e.forEach((e=>{e&&n(e,i)}))}))},r=e.notifyOnChunksLoaded(a);r.cancel();return{toggle:t=>{t?r.renew():r.cancel(),t!==i&&(i=t,a([...e.container.chunks]))},colorize:a,subscription:r}}const P={0:new i.Vector4(1,0,0,1),1:new i.Vector4(0,1,0,1),2:new i.Vector4(0,0,1,1),3:new i.Vector4(1,1,1,1),4:new i.Vector4(1,0,1,1),5:new i.Vector4(0,1,1,1),6:new i.Vector4(1,1,0,1),7:new i.Vector4(0,0,0,1)};function C(e,t,n){var s,a;const r=null!==(a=null===(s=P[e])||void 0===s?void 0:s.clone())&&void 0!==a?a:new i.Vector4;return r.multiplyScalar(t),r.setW(n),r}const V=w},15564:(e,t,n)=>{n.d(t,{F:()=>i});const i={TITLE:"streamed-mesh (T)",HOTKEYS:[n(71397).D.T]}},32484:(e,t,n)=>{n.d(t,{yJ:()=>r});var i=n(80112),s=n(47299),a=n(14971);const r={TEXTURE_SETTINGS:s.Ay,TILEDMESH_SETTINGS:i.W,clearRaycastHits:a.Jn}},14240:(e,t,n)=>{n.d(t,{e:()=>u});var i=n(68909),s=n(77201),a=n(35535),r=n(30443),o=n(45205);const l=new i.Vector3;class u extends s.vm{constructor(e,t,n,s,a,r,l=new Date,u=new Date,d,h,c,g){super(),this.position=e,this.scale=t,this.rotation=n,this.enabled=a,this.meshGroup=r,this.created=l,this.modified=u,this.discardContents=!0,this.activeInPanoMode=!0,this.transient=!1,this._rotationMatrix=new i.Matrix4,this._matrix=new i.Matrix4,this.id=d||`${this.meshGroup}`+(0,o.D)(11),this.index=s,this.name=h,this.discardContents=void 0===c||c,this.activeInPanoMode=void 0===g||g}get sid(){return this.id}isPointTrimmed(e,t){return!!this.enabled&&(!(t&&!this.activeInPanoMode)&&(this.discardContents?this.isPointInside(e):!this.isPointInside(e)))}getTransformationMatrix(e){return(e=e||new i.Matrix4).compose(this.position,this.rotation,this.scale),e}getInverseTransformationMatrix(e){return(e=this.getTransformationMatrix(e)).invert(),e}isPointInside(e){this.getInverseTransformationMatrix(this._matrix);const t=l.copy(e).applyMatrix4(this._matrix);return t.x<.5&&t.x>-.5&&t.y<.5&&t.y>-.5&&t.z<.5&&t.z>-.5}updateRotationMatrix(){const e=this.rotation,t=this.rotation.clone().set(e.x,e.y,e.z,-e.w);this._rotationMatrix.makeRotationFromQuaternion(t.normalize())}get rotationMatrix(){return this.updateRotationMatrix(),this._rotationMatrix}static getUnitAABB(){return new i.Box3(new i.Vector3(-.5,-.5,-.5),new i.Vector3(.5,.5,.5))}getContainingAABB(){const e=u.getUnitAABB(),t=(0,r.jF)(e),n=this.getTransformationMatrix();return(0,r.nD)(t,e,n)}getOBB(){const e=(new i.Matrix4).makeRotationFromQuaternion(this.rotation),t=(new i.Matrix3).setFromMatrix4(e);return new a.OBB(this.position,this.scale.clone().multiplyScalar(.5),t)}}},35535:(e,t,n)=>{n.r(t),n.d(t,{OBB:()=>x});var i=n(68909);const s={c:null,u:[new i.Vector3,new i.Vector3,new i.Vector3],e:[]},a={c:null,u:[new i.Vector3,new i.Vector3,new i.Vector3],e:[]},r=[[],[],[]],o=[[],[],[]],l=[],u=new i.Vector3,d=new i.Vector3,h=new i.Vector3,c=new i.Vector3,g=new i.Vector3,m=new i.Vector3,M=new i.Matrix3,p=new i.Box3,f=new i.Matrix4,y=new i.Matrix4,v=new i.Ray;class x{constructor(e=new i.Vector3,t=new i.Vector3,n=new i.Matrix3){this.center=e,this.halfSize=t,this.rotation=n}set(e,t,n){return this.center=e,this.halfSize=t,this.rotation=n,this}copy(e){return this.center.copy(e.center),this.halfSize.copy(e.halfSize),this.rotation.copy(e.rotation),this}clone(){return(new this.constructor).copy(this)}getSize(e){return e.copy(this.halfSize).multiplyScalar(2)}clampPoint(e,t){const n=this.halfSize;c.subVectors(e,this.center),this.rotation.extractBasis(u,d,h),t.copy(this.center);const s=i.MathUtils.clamp(c.dot(u),-n.x,n.x);t.add(u.multiplyScalar(s));const a=i.MathUtils.clamp(c.dot(d),-n.y,n.y);t.add(d.multiplyScalar(a));const r=i.MathUtils.clamp(c.dot(h),-n.z,n.z);return t.add(h.multiplyScalar(r)),t}containsPoint(e){return c.subVectors(e,this.center),this.rotation.extractBasis(u,d,h),Math.abs(c.dot(u))<=this.halfSize.x&&Math.abs(c.dot(d))<=this.halfSize.y&&Math.abs(c.dot(h))<=this.halfSize.z}intersectsBox3(e){return this.intersectsOBB(T.fromBox3(e))}intersectsSphere(e){return this.clampPoint(e.center,m),m.distanceToSquared(e.center)<=e.radius*e.radius}intersectsOBB(e,t=Number.EPSILON){s.c=this.center,s.e[0]=this.halfSize.x,s.e[1]=this.halfSize.y,s.e[2]=this.halfSize.z,this.rotation.extractBasis(s.u[0],s.u[1],s.u[2]),a.c=e.center,a.e[0]=e.halfSize.x,a.e[1]=e.halfSize.y,a.e[2]=e.halfSize.z,e.rotation.extractBasis(a.u[0],a.u[1],a.u[2]);for(let e=0;e<3;e++)for(let t=0;t<3;t++)r[e][t]=s.u[e].dot(a.u[t]);c.subVectors(a.c,s.c),l[0]=c.dot(s.u[0]),l[1]=c.dot(s.u[1]),l[2]=c.dot(s.u[2]);for(let e=0;e<3;e++)for(let n=0;n<3;n++)o[e][n]=Math.abs(r[e][n])+t;let n,i;for(let e=0;e<3;e++)if(n=s.e[e],i=a.e[0]*o[e][0]+a.e[1]*o[e][1]+a.e[2]*o[e][2],Math.abs(l[e])>n+i)return!1;for(let e=0;e<3;e++)if(n=s.e[0]*o[0][e]+s.e[1]*o[1][e]+s.e[2]*o[2][e],i=a.e[e],Math.abs(l[0]*r[0][e]+l[1]*r[1][e]+l[2]*r[2][e])>n+i)return!1;return n=s.e[1]*o[2][0]+s.e[2]*o[1][0],i=a.e[1]*o[0][2]+a.e[2]*o[0][1],!(Math.abs(l[2]*r[1][0]-l[1]*r[2][0])>n+i)&&(n=s.e[1]*o[2][1]+s.e[2]*o[1][1],i=a.e[0]*o[0][2]+a.e[2]*o[0][0],!(Math.abs(l[2]*r[1][1]-l[1]*r[2][1])>n+i)&&(n=s.e[1]*o[2][2]+s.e[2]*o[1][2],i=a.e[0]*o[0][1]+a.e[1]*o[0][0],!(Math.abs(l[2]*r[1][2]-l[1]*r[2][2])>n+i)&&(n=s.e[0]*o[2][0]+s.e[2]*o[0][0],i=a.e[1]*o[1][2]+a.e[2]*o[1][1],!(Math.abs(l[0]*r[2][0]-l[2]*r[0][0])>n+i)&&(n=s.e[0]*o[2][1]+s.e[2]*o[0][1],i=a.e[0]*o[1][2]+a.e[2]*o[1][0],!(Math.abs(l[0]*r[2][1]-l[2]*r[0][1])>n+i)&&(n=s.e[0]*o[2][2]+s.e[2]*o[0][2],i=a.e[0]*o[1][1]+a.e[1]*o[1][0],!(Math.abs(l[0]*r[2][2]-l[2]*r[0][2])>n+i)&&(n=s.e[0]*o[1][0]+s.e[1]*o[0][0],i=a.e[1]*o[2][2]+a.e[2]*o[2][1],!(Math.abs(l[1]*r[0][0]-l[0]*r[1][0])>n+i)&&(n=s.e[0]*o[1][1]+s.e[1]*o[0][1],i=a.e[0]*o[2][2]+a.e[2]*o[2][0],!(Math.abs(l[1]*r[0][1]-l[0]*r[1][1])>n+i)&&(n=s.e[0]*o[1][2]+s.e[1]*o[0][2],i=a.e[0]*o[2][1]+a.e[1]*o[2][0],!(Math.abs(l[1]*r[0][2]-l[0]*r[1][2])>n+i)))))))))}intersectsPlane(e){this.rotation.extractBasis(u,d,h);const t=this.halfSize.x*Math.abs(e.normal.dot(u))+this.halfSize.y*Math.abs(e.normal.dot(d))+this.halfSize.z*Math.abs(e.normal.dot(h)),n=e.normal.dot(this.center)-e.constant;return Math.abs(n)<=t}intersectRay(e,t){return this.getSize(g),p.setFromCenterAndSize(c.set(0,0,0),g),f.setFromMatrix3(this.rotation),f.setPosition(this.center),y.copy(f).invert(),v.copy(e).applyMatrix4(y),v.intersectBox(p,t)?t.applyMatrix4(f):null}intersectsRay(e){return null!==this.intersectRay(e,c)}fromBox3(e){return e.getCenter(this.center),e.getSize(this.halfSize).multiplyScalar(.5),this.rotation.identity(),this}equals(e){return e.center.equals(this.center)&&e.halfSize.equals(this.halfSize)&&e.rotation.equals(this.rotation)}applyMatrix4(e){const t=e.elements;let n=c.set(t[0],t[1],t[2]).length();const i=c.set(t[4],t[5],t[6]).length(),s=c.set(t[8],t[9],t[10]).length();e.determinant()<0&&(n=-n),M.setFromMatrix4(e);const a=1/n,r=1/i,o=1/s;return M.elements[0]*=a,M.elements[1]*=a,M.elements[2]*=a,M.elements[3]*=r,M.elements[4]*=r,M.elements[5]*=r,M.elements[6]*=o,M.elements[7]*=o,M.elements[8]*=o,this.rotation.multiply(M),this.halfSize.x*=n,this.halfSize.y*=i,this.halfSize.z*=s,c.setFromMatrixPosition(e),this.center.add(c),this}}const T=new x}}]);