/*! For license information please see 2978.js.LICENSE.txt */
(self.webpackChunkmp_webgl=self.webpackChunkmp_webgl||[]).push([[2978],{44704:(e,t,n)=>{"use strict";n(74677)},74677:(e,t,n)=>{"use strict";n.r(t)},64879:()=>{},80164:()=>{},84917:(e,t,n)=>{"use strict";var s;function i(e){const t=new Date;t.setHours(0,0,0,0),e.setHours(0,0,0,0);const n=(t.getTime()-e.getTime())/864e5;if(0===n)return s.TODAY;if(1===n)return s.YESTERDAY;if(n<7)return s.THIS_WEEK;const i=Math.floor(n/7);return 1===i?s.ONE_WEEK_AGO:2===i?s.TWO_WEEKS_AGO:3===i?s.THREE_WEEKS_AGO:s.OLDER}n.d(t,{T:()=>s,n:()=>i}),function(e){e.TODAY="TODAY",e.YESTERDAY="YESTERDAY",e.THIS_WEEK="THIS_WEEK",e.ONE_WEEK_AGO="ONE_WEEK_AGO",e.TWO_WEEKS_AGO="TWO_WEEKS_AGO",e.THREE_WEEKS_AGO="THREE_WEEKS_AGO",e.OLDER="OLDER"}(s||(s={}))},25296:(e,t,n)=>{"use strict";n.d(t,{dT:()=>o,db:()=>a,q2:()=>r});var s=n(51831),i=n(53641);function o(e,t){return!!t&&t.id===e.getCurrentUserId()}function r(e,t,n,r){if(n===s.U.NOTE){return t.hasPolicy(i.O7)&&o(e,r)}return e.isEditor()}function a(e,t,n,r){if(n===s.U.NOTE){return t.hasPolicy(i.xB)&&o(e,r)||e.isOrgAdmin()}return e.isEditor()}},48198:(e,t,n)=>{"use strict";n.d(t,{y:()=>r});var s=n(96540),i=n(99438);function o(e){return e?e.floors.getOrderedValues():[]}function r(){const e=(0,i._)(),[t,n]=(0,s.useState)(o(e));return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=()=>n(o(e)),s=e.floors.getCollection().onChanged(t);return t(),()=>s.cancel()}),[e]),t}},77071:(e,t,n)=>{"use strict";n.d(t,{w:()=>r});var s=n(74848),i=n(32485),o=n.n(i);function r({current:e,min:t,max:n}){const i=void 0!==t&&e<t||e>n;return(0,s.jsxs)("div",{className:o()("text-counter",{error:i}),children:[e,"/",n]})}},2204:(e,t,n)=>{"use strict";n.d(t,{P:()=>y,F:()=>T});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(72909),c=n(77570),l=n(89244),d=n(63220),u=n(17605),h=n(48270);const p=/[^]*youtube.com\/shorts\//gi;var m,f=n(30278),g=n(56147),v=n(71687),E=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},x=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{EMBED:_}=g.A.WORKSHOP;var T;!function(e){e.NONE="none",e.INVALID_URL_SYNTAX="invalid",e.LOADING="loading",e.LOADED="loaded",e.ERROR="error"}(T||(T={}));let y=m=class extends i.Component{constructor(e){super(e),this.inputRef=(0,i.createRef)(),this.isUnmounting=!1,this.onInput=e=>{const t=(0,l.q)(e)?T.NONE:T.INVALID_URL_SYNTAX;this.setState({validationPhase:t,currentUrl:e})},this.onApply=()=>{this.isDisabled()||this.onDoneEditing(this.state.currentUrl)},this.stopPropagation=e=>{e.stopPropagation()},this.onDoneEditing=async e=>{const{onEmbed:t,onEmbedCleared:n,url:s}=this.props;if(""===e)return n&&n(),void this.setState({validationPhase:T.NONE,error:void 0,currentUrl:""});const i=(e=>{if(p.test(e))return`https://youtube.com/watch?v=${e.replace(p,"").replace(/\?(.*)/g,"")}`;return e})(e);if(i&&i!==s)try{const e=await this.loadMedia(i);if(this.isUnmounting)return;e?(this.setState({validationPhase:T.LOADED,error:void 0,currentUrl:i}),t(e)):this.onEmbedError(i)}catch(e){if(this.isUnmounting)return;this.onEmbedError(i,e)}},this.loadMedia=async e=>{const{parentId:t,parentType:n}=this.props;return this.setState({validationPhase:T.LOADING}),this.attachmentsModule.embedMedia(t,n,e)},this.state={currentUrl:e.url||"",validationPhase:T.NONE,error:void 0}}componentDidMount(){this.context.engine.getModuleBySymbol(v.qy).then((e=>{this.attachmentsModule=e}))}componentWillUnmount(){this.isUnmounting=!0,this.setState({currentUrl:"",validationPhase:T.NONE,error:void 0})}componentDidUpdate(e,t){const{url:n,onValidationPhaseChange:s}=this.props;let i=this.state.validationPhase;n!==e.url&&(i=T.NONE,this.setState({currentUrl:n||"",validationPhase:T.NONE,error:void 0})),s&&i!==t.validationPhase&&s(i)}focus(){this.inputRef.current&&this.inputRef.current.focus()}onEmbedError(e,t){this.setState({error:t,validationPhase:T.ERROR,currentUrl:e})}isDisabled(){const{validationPhase:e,currentUrl:t}=this.state;return e===T.ERROR||e===T.LOADING||e===T.INVALID_URL_SYNTAX&&""!==t||""===t}renderError(){const{locale:e}=this.context,{error:t}=this.state;let n=e.t(_.ERROR_MESSAGE);return t instanceof f.aI?n=e.t(_.PROVIDER_NOT_SUPPORTED_MESSAGE):t instanceof f.Dm&&(n=e.t(_.LINK_TYPE_NOT_SUPPORTED_MESSAGE)),(0,s.jsxs)("div",{className:"popover-message popover-message-error",children:[n," ",(0,s.jsx)("a",{className:"link",target:"_blank",rel:"noreferrer",href:m.supportPage,children:e.t(_.HELP_CTA)})]})}renderHelpMessage(){const{locale:e}=this.context,{currentUrl:t,validationPhase:n}=this.state;switch(n){case T.ERROR:return this.renderError();case T.LOADING:return(0,s.jsx)("div",{className:"popover-message",children:e.t(_.LOADING_MESSAGE)});case T.INVALID_URL_SYNTAX:if(""!==t)return(0,s.jsx)("div",{className:"popover-message popover-message-error",children:e.t(_.INVALID_URL_MESSAGE)})}return(0,s.jsx)("div",{className:"popover-message",children:(0,s.jsx)("a",{className:"link",target:"_blank",href:m.supportPage,tabIndex:-1,children:e.t(_.SUPPORTED_FORMATS_MESSAGE)})})}render(){const{locale:e}=this.context,{className:t,tabIndex:n}=this.props,{currentUrl:i}=this.state,o=void 0!==n&&n>=0,a=e.t(_.MEDIA_EMBED_PLACEHOLDER);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"media-embed-editor",onClick:this.stopPropagation,children:[(0,s.jsx)(d.A,{ref:this.inputRef,text:i,type:"url",className:r()(t),placeholder:a,onDone:this.onDoneEditing,onInput:this.onInput,allowTabbing:o,tabIndex:n}),(0,s.jsx)("div",{className:"popover-footer",children:this.renderHelpMessage()})]}),(0,s.jsx)("div",{className:"modal-footer embed-apply",children:(0,s.jsx)(u.$,{variant:h.A.PRIMARY,size:"small",disabled:this.isDisabled(),onClick:this.onApply,label:e.t(_.APPLY_CTA)})})]})}};y.contextType=c.B,y.supportPage="https://support.matterport.com/hc/en-us/articles/115006363868-Add-Multimedia-to-a-Mattertag-Post",y=m=E([a.A,x("design:paramtypes",[Object])],y)},42556:(e,t,n)=>{"use strict";n.d(t,{W:()=>i});var s=n(74848);function i({children:e}){return(0,s.jsx)("div",{className:"overlay-message",children:e})}},36981:(e,t,n)=>{"use strict";n.d(t,{b:()=>s});const s=(0,n(96540).createContext)({includeInMemory:!1})},29390:(e,t,n)=>{"use strict";n.d(t,{Q:()=>Z,r:()=>J});var s=n(74848),i=n(96540);var o=function(){return o=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)};function r(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n}Object.create;Object.create;var a=function(){return a=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)};Object.create;function c(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],s=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&s>=e.length&&(e=void 0),{value:e&&e[s++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function l(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var s,i,o=n.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(s=o.next()).done;)r.push(s.value)}catch(e){i={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return r}function d(e,t,n){if(n||2===arguments.length)for(var s,i=0,o=t.length;i<o;i++)!s&&i in t||(s||(s=Array.prototype.slice.call(t,0,i)),s[i]=t[i]);return e.concat(s||Array.prototype.slice.call(t))}Object.create;var u=n(32485),h=n.n(u),p=function(e){return(Array.isArray(e)?e:[e]).filter((function(e){return!!e})).map((function(e){return"mdc-theme--"+e.replace(/([A-Z])/g,(function(e){return"-"+e.toLowerCase()}))}))},m=i.forwardRef((function(e,t){var n=e.tag,s=void 0===n?"div":n,o=(e.theme,e.element),r=function(e,t){var n={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(n[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(s=Object.getOwnPropertySymbols(e);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(e,s[i])&&(n[s[i]]=e[s[i]])}return n}(e,["tag","theme","element"]),c=o?o.props(r):r,l=o?f(t,o.setRef):t;return i.createElement(s,a({},c,{ref:l}))})),f=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t){var n,s;try{for(var i=c(e),o=i.next();!o.done;o=i.next()){var r=o.value;"function"==typeof r?r(t):r&&"current"in r&&(r.current=t)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(s=i.return)&&s.call(i)}finally{if(n)throw n.error}}}},g=function(e,t){"function"==typeof e?e(t):e&&"current"in e&&(e.current=t)};function v(e){var t=i.forwardRef(e),n=function(e,t){return i.createElement(i.Fragment,null)};return n.displayName=e.constructor.name||"RMWCComponent",t.displayName=n.displayName,t}var E={blur:"onBlur",cancel:"onCancel",click:"onClick",close:"onClose",contextmenu:"onContextMenu",copy:"onCopy",cut:"onCut",auxclick:"onAuxClick",doubleclick:"onDoubleClick",dragend:"onDragEnd",dragstart:"onDragStart",drop:"onDrop",focus:"onFocus",input:"onInput",invalid:"onInvalid",keydown:"onKeyDown",keypress:"onKeyPress",keyup:"onKeyUp",mousedown:"onMouseDown",mouseup:"onMouseUp",paste:"onPaste",pause:"onPause",play:"onPlay",pointercancel:"onPointerCancel",pointerdown:"onPointerDown",pointerup:"onPointerUp",ratechange:"onRateChange",reset:"onReset",seeked:"onSeeked",submit:"onSubmit",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchstart:"onTouchStart",volumechange:"onVolumeChange",abort:"onAbort",animationend:"onAnimationEnd",animationiteration:"onAnimationIteration",animationstart:"onAnimationStart",canplay:"onCanPlay",canplaythrough:"onCanPlayThrough",drag:"onDrag",dragenter:"onDragEnter",dragexit:"onDragExit",dragleave:"onDragLeave",dragover:"onDragOver",durationchange:"onDurationChange",emptied:"onEmptied",encrypted:"onEncrypted",ended:"onEnded",error:"onError",gotpointercapture:"onGotPointerCapture",load:"onLoad",loadeddata:"onLoadedData",loadedmetadata:"onLoadedMetadata",loadstart:"onLoadStart",lostpointercapture:"onLostPointerCapture",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseover:"onMouseOver",playing:"onPlaying",pointermove:"onPointerMove",pointerout:"onPointerOut",pointerover:"onPointerOver",progress:"onProgress",scroll:"onScroll",seeking:"onSeeking",stalled:"onStalled",suspend:"onSuspend",timeupdate:"onTimeUpdate",toggle:"onToggle",touchmove:"onTouchMove",transitionend:"onTransitionEnd",waiting:"onWaiting",wheel:"onWheel",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",pointerenter:"onPointerEnter",pointerleave:"onPointerLeave",change:"onChange",select:"onSelect",beforeinput:"onBeforeInput",compositionend:"onCompositionEnd",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate"},x=function(e){return E[e]||e},_=function(){function e(e){this._classes=new Set,this._events={},this._style={},this._props={},this._ref=null,this._onChange=null,this._onChange=e,this.onChange=this.onChange.bind(this),this.addClass=this.addClass.bind(this),this.removeClass=this.removeClass.bind(this),this.hasClass=this.hasClass.bind(this),this.setProp=this.setProp.bind(this),this.getProp=this.getProp.bind(this),this.removeProp=this.removeProp.bind(this),this.setStyle=this.setStyle.bind(this),this.addEventListener=this.addEventListener.bind(this),this.removeEventListener=this.removeEventListener.bind(this),this.setRef=this.setRef.bind(this)}return e.prototype.onChange=function(){this._onChange&&this._onChange()},e.prototype.destroy=function(){var e=this;this._onChange=null,this._events={},this._style={},this._props={},this._classes=new Set,setTimeout((function(){e._ref=null}))},e.prototype.addClass=function(e){this._classes.has(e)||(this._classes.add(e),this.onChange())},e.prototype.removeClass=function(e){this._classes.has(e)&&(this._classes.delete(e),this.onChange())},e.prototype.hasClass=function(e){return this._classes.has(e)},e.prototype.setProp=function(e,t,n){void 0===n&&(n=!1),this._props[e]!==t&&(this._props[e]=t,!n&&this.onChange())},e.prototype.getProp=function(e){return this._props[e]},e.prototype.removeProp=function(e){void 0!==this._props[e]&&(delete this._props[e],this.onChange())},e.prototype.props=function(e){var t=this,n=e.className,s=void 0===n?"":n,i=e.style,o=void 0===i?{}:i,r=Object.entries(e).reduce((function(e,n){var s=l(n,2),i=s[0],o=s[1],r=t._events[i];if("function"==typeof o&&"function"==typeof r){e[i]=function(e){return r(e),o(e)}}return e}),a({},this._events)),c=h()(s,d([],l(this._classes))),u=a(a({},this._style),o);return a(a(a(a({},e),this._props),r),{style:u,className:c})},e.prototype.setStyle=function(e,t){e=e.startsWith("--")?e:e.replace(/(-[a-z])/g,(function(e){return e.toUpperCase().replace("-","")})),this._style[e]!==t&&(this._style[e]=t,this.onChange())},e.prototype.addEventListener=function(e,t){var n=x(e);this._events[n]!==t&&(this._events[n]=t,this.onChange())},e.prototype.removeEventListener=function(e,t){var n=x(e);this._events[n]&&(delete this._events[n],this.onChange())},e.prototype.setRef=function(e){e&&(this._ref=e)},Object.defineProperty(e.prototype,"ref",{get:function(){return this._ref},enumerable:!1,configurable:!0}),e}(),T=function(e){var t=e.foundation,n=e.props,s=e.elements,o=e.api,r=l((0,i.useState)(0),2)[1],c=(0,i.useRef)(n);c.current=n;var u=(0,i.useMemo)((function(){return Object.keys(s).reduce((function(e,t){return e[t]=new _((function(){r((function(e){return e+1}))})),e}),{})}),[]),h=(0,i.useMemo)((function(){var e=t(a(a({},u),{getProps:function(){return c.current},emit:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(e){return function(t,n,s){var i;void 0===s&&(s=!1),i=new CustomEvent(t,{detail:n,bubbles:s}),Object.defineProperty(i,"target",{value:n,writable:!1}),Object.defineProperty(i,"currentTarget",{value:n,writable:!1});var o=t;return e[o]&&e[o](i),i}}(c.current).apply(void 0,d([],l(e)))}}));return o&&g(c.current.apiRef,o(a({foundation:e},u))),e}),[]);return(0,i.useEffect)((function(){var e=h;return e.init(),o&&g(c.current.apiRef,o(a({foundation:e},u))),g(c.current.foundationRef,e),function(){e.destroy(),g(c.current.apiRef,null),g(c.current.foundationRef,null),Object.values(u).map((function(e){return e.destroy()})),c.current={}}}),[h,u]),a({foundation:h},u)},y={bottom:0,height:0,left:0,right:0,top:0,width:0},C=function(e,t){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},C(e,t)};var A=function(){return A=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},A.apply(this,arguments)};var S={animation:{prefixed:"-webkit-animation",standard:"animation"},transform:{prefixed:"-webkit-transform",standard:"transform"},transition:{prefixed:"-webkit-transition",standard:"transition"}},b={animationend:{cssProperty:"animation",prefixed:"webkitAnimationEnd",standard:"animationend"},animationiteration:{cssProperty:"animation",prefixed:"webkitAnimationIteration",standard:"animationiteration"},animationstart:{cssProperty:"animation",prefixed:"webkitAnimationStart",standard:"animationstart"},transitionend:{cssProperty:"transition",prefixed:"webkitTransitionEnd",standard:"transitionend"}};function O(e){return Boolean(e.document)&&"function"==typeof e.document.createElement}var I=function(){function e(e){void 0===e&&(e={}),this.adapter_=e}return Object.defineProperty(e,"cssClasses",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"strings",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"numbers",{get:function(){return{}},enumerable:!0,configurable:!0}),Object.defineProperty(e,"defaultAdapter",{get:function(){return{}},enumerable:!0,configurable:!0}),e.prototype.init=function(){},e.prototype.destroy=function(){},e}();var R={ACTIVE:"mdc-slider--active",DISABLED:"mdc-slider--disabled",DISCRETE:"mdc-slider--discrete",FOCUS:"mdc-slider--focus",HAS_TRACK_MARKER:"mdc-slider--display-markers",IN_TRANSIT:"mdc-slider--in-transit",IS_DISCRETE:"mdc-slider--discrete"},N={ARIA_DISABLED:"aria-disabled",ARIA_VALUEMAX:"aria-valuemax",ARIA_VALUEMIN:"aria-valuemin",ARIA_VALUENOW:"aria-valuenow",CHANGE_EVENT:"MDCSlider:change",INPUT_EVENT:"MDCSlider:input",PIN_VALUE_MARKER_SELECTOR:".mdc-slider__pin-value-marker",STEP_DATA_ATTR:"data-step",THUMB_CONTAINER_SELECTOR:".mdc-slider__thumb-container",TRACK_MARKER_CONTAINER_SELECTOR:".mdc-slider__track-marker-container",TRACK_SELECTOR:".mdc-slider__track"},L={PAGE_FACTOR:4},k=["mousedown","pointerdown","touchstart"],w=["mouseup","pointerup","touchend"],j={mousedown:"mousemove",pointerdown:"pointermove",touchstart:"touchmove"},M="ArrowDown",P="ArrowLeft",D="ArrowRight",H="ArrowUp",U="End",B="Home",F="PageDown",V="PageUp",G=function(e){function t(n){var s=e.call(this,A({},t.defaultAdapter,n))||this;return s.savedTabIndex_=NaN,s.active_=!1,s.inTransit_=!1,s.isDiscrete_=!1,s.hasTrackMarker_=!1,s.handlingThumbTargetEvt_=!1,s.min_=0,s.max_=100,s.step_=0,s.value_=0,s.disabled_=!1,s.preventFocusState_=!1,s.thumbContainerPointerHandler_=function(){return s.handlingThumbTargetEvt_=!0},s.interactionStartHandler_=function(e){return s.handleDown_(e)},s.keydownHandler_=function(e){return s.handleKeydown_(e)},s.focusHandler_=function(){return s.handleFocus_()},s.blurHandler_=function(){return s.handleBlur_()},s.resizeHandler_=function(){return s.layout()},s}return function(e,t){function n(){this.constructor=e}C(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),Object.defineProperty(t,"cssClasses",{get:function(){return R},enumerable:!0,configurable:!0}),Object.defineProperty(t,"strings",{get:function(){return N},enumerable:!0,configurable:!0}),Object.defineProperty(t,"numbers",{get:function(){return L},enumerable:!0,configurable:!0}),Object.defineProperty(t,"defaultAdapter",{get:function(){return{hasClass:function(){return!1},addClass:function(){},removeClass:function(){},getAttribute:function(){return null},setAttribute:function(){},removeAttribute:function(){},computeBoundingRect:function(){return{top:0,right:0,bottom:0,left:0,width:0,height:0}},getTabIndex:function(){return 0},registerInteractionHandler:function(){},deregisterInteractionHandler:function(){},registerThumbContainerInteractionHandler:function(){},deregisterThumbContainerInteractionHandler:function(){},registerBodyInteractionHandler:function(){},deregisterBodyInteractionHandler:function(){},registerResizeHandler:function(){},deregisterResizeHandler:function(){},notifyInput:function(){},notifyChange:function(){},setThumbContainerStyleProperty:function(){},setTrackStyleProperty:function(){},setMarkerValue:function(){},setTrackMarkers:function(){},isRTL:function(){return!1}}},enumerable:!0,configurable:!0}),t.prototype.init=function(){var e=this;this.isDiscrete_=this.adapter_.hasClass(R.IS_DISCRETE),this.hasTrackMarker_=this.adapter_.hasClass(R.HAS_TRACK_MARKER),k.forEach((function(t){e.adapter_.registerInteractionHandler(t,e.interactionStartHandler_),e.adapter_.registerThumbContainerInteractionHandler(t,e.thumbContainerPointerHandler_)})),this.adapter_.registerInteractionHandler("keydown",this.keydownHandler_),this.adapter_.registerInteractionHandler("focus",this.focusHandler_),this.adapter_.registerInteractionHandler("blur",this.blurHandler_),this.adapter_.registerResizeHandler(this.resizeHandler_),this.layout(),this.isDiscrete_&&0===this.getStep()&&(this.step_=1)},t.prototype.destroy=function(){var e=this;k.forEach((function(t){e.adapter_.deregisterInteractionHandler(t,e.interactionStartHandler_),e.adapter_.deregisterThumbContainerInteractionHandler(t,e.thumbContainerPointerHandler_)})),this.adapter_.deregisterInteractionHandler("keydown",this.keydownHandler_),this.adapter_.deregisterInteractionHandler("focus",this.focusHandler_),this.adapter_.deregisterInteractionHandler("blur",this.blurHandler_),this.adapter_.deregisterResizeHandler(this.resizeHandler_)},t.prototype.setupTrackMarker=function(){this.isDiscrete_&&this.hasTrackMarker_&&0!==this.getStep()&&this.adapter_.setTrackMarkers(this.getStep(),this.getMax(),this.getMin())},t.prototype.layout=function(){this.rect_=this.adapter_.computeBoundingRect(),this.updateUIForCurrentValue_()},t.prototype.getValue=function(){return this.value_},t.prototype.setValue=function(e){this.setValue_(e,!1)},t.prototype.getMax=function(){return this.max_},t.prototype.setMax=function(e){if(e<this.min_)throw new Error("Cannot set max to be less than the slider's minimum value");this.max_=e,this.setValue_(this.value_,!1,!0),this.adapter_.setAttribute(N.ARIA_VALUEMAX,String(this.max_)),this.setupTrackMarker()},t.prototype.getMin=function(){return this.min_},t.prototype.setMin=function(e){if(e>this.max_)throw new Error("Cannot set min to be greater than the slider's maximum value");this.min_=e,this.setValue_(this.value_,!1,!0),this.adapter_.setAttribute(N.ARIA_VALUEMIN,String(this.min_)),this.setupTrackMarker()},t.prototype.getStep=function(){return this.step_},t.prototype.setStep=function(e){if(e<0)throw new Error("Step cannot be set to a negative number");this.isDiscrete_&&("number"!=typeof e||e<1)&&(e=1),this.step_=e,this.setValue_(this.value_,!1,!0),this.setupTrackMarker()},t.prototype.isDisabled=function(){return this.disabled_},t.prototype.setDisabled=function(e){this.disabled_=e,this.toggleClass_(R.DISABLED,this.disabled_),this.disabled_?(this.savedTabIndex_=this.adapter_.getTabIndex(),this.adapter_.setAttribute(N.ARIA_DISABLED,"true"),this.adapter_.removeAttribute("tabindex")):(this.adapter_.removeAttribute(N.ARIA_DISABLED),isNaN(this.savedTabIndex_)||this.adapter_.setAttribute("tabindex",String(this.savedTabIndex_)))},t.prototype.handleDown_=function(e){var t=this;if(!this.disabled_){this.preventFocusState_=!0,this.setInTransit_(!this.handlingThumbTargetEvt_),this.handlingThumbTargetEvt_=!1,this.setActive_(!0);var n=function(e){t.handleMove_(e)},s=j[e.type],i=function(){t.handleUp_(),t.adapter_.deregisterBodyInteractionHandler(s,n),w.forEach((function(e){return t.adapter_.deregisterBodyInteractionHandler(e,i)}))};this.adapter_.registerBodyInteractionHandler(s,n),w.forEach((function(e){return t.adapter_.registerBodyInteractionHandler(e,i)})),this.setValueFromEvt_(e)}},t.prototype.handleMove_=function(e){e.preventDefault(),this.setValueFromEvt_(e)},t.prototype.handleUp_=function(){this.setActive_(!1),this.adapter_.notifyChange()},t.prototype.getClientX_=function(e){return e.targetTouches&&e.targetTouches.length>0?e.targetTouches[0].clientX:e.clientX},t.prototype.setValueFromEvt_=function(e){var t=this.getClientX_(e),n=this.computeValueFromClientX_(t);this.setValue_(n,!0)},t.prototype.computeValueFromClientX_=function(e){var t=this.max_,n=this.min_,s=(e-this.rect_.left)/this.rect_.width;return this.adapter_.isRTL()&&(s=1-s),n+s*(t-n)},t.prototype.handleKeydown_=function(e){var t=this.getKeyId_(e),n=this.getValueForKeyId_(t);isNaN(n)||(e.preventDefault(),this.adapter_.addClass(R.FOCUS),this.setValue_(n,!0),this.adapter_.notifyChange())},t.prototype.getKeyId_=function(e){return e.key===P||37===e.keyCode?P:e.key===D||39===e.keyCode?D:e.key===H||38===e.keyCode?H:e.key===M||40===e.keyCode?M:e.key===B||36===e.keyCode?B:e.key===U||35===e.keyCode?U:e.key===V||33===e.keyCode?V:e.key===F||34===e.keyCode?F:""},t.prototype.getValueForKeyId_=function(e){var t=this,n=t.max_,s=t.min_,i=t.step_||(n-s)/100;switch(this.adapter_.isRTL()&&(e===P||e===D)&&(i=-i),e){case P:case M:return this.value_-i;case D:case H:return this.value_+i;case B:return this.min_;case U:return this.max_;case V:return this.value_+i*L.PAGE_FACTOR;case F:return this.value_-i*L.PAGE_FACTOR;default:return NaN}},t.prototype.handleFocus_=function(){this.preventFocusState_||this.adapter_.addClass(R.FOCUS)},t.prototype.handleBlur_=function(){this.preventFocusState_=!1,this.adapter_.removeClass(R.FOCUS)},t.prototype.setValue_=function(e,t,n){if(void 0===n&&(n=!1),e!==this.value_||n){var s=this.min_,i=this.max_,o=e===s||e===i;this.step_&&!o&&(e=this.quantize_(e)),e<s?e=s:e>i&&(e=i),e=e||0,this.value_=e,this.adapter_.setAttribute(N.ARIA_VALUENOW,String(this.value_)),this.updateUIForCurrentValue_(),t&&(this.adapter_.notifyInput(),this.isDiscrete_&&this.adapter_.setMarkerValue(e))}},t.prototype.quantize_=function(e){return Math.round(e/this.step_)*this.step_},t.prototype.updateUIForCurrentValue_=function(){var e=this,t=this,n=t.max_,s=t.min_,i=(t.value_-s)/(n-s),o=i*this.rect_.width;this.adapter_.isRTL()&&(o=this.rect_.width-o);var r=function(e,t){if(O(e)&&t in S){var n=e.document.createElement("div"),s=S[t],i=s.standard,o=s.prefixed;return i in n.style?i:o}return t}(window,"transform"),a=function(e,t){if(O(e)&&t in b){var n=e.document.createElement("div"),s=b[t],i=s.standard,o=s.prefixed;return s.cssProperty in n.style?i:o}return t}(window,"transitionend");if(this.inTransit_){var c=function(){e.setInTransit_(!1),e.adapter_.deregisterThumbContainerInteractionHandler(a,c)};this.adapter_.registerThumbContainerInteractionHandler(a,c)}requestAnimationFrame((function(){e.adapter_.setThumbContainerStyleProperty(r,"translateX("+o+"px) translateX(-50%)"),e.adapter_.setTrackStyleProperty(r,"scaleX("+i+")")}))},t.prototype.setActive_=function(e){this.active_=e,this.toggleClass_(R.ACTIVE,this.active_)},t.prototype.setInTransit_=function(e){this.inTransit_=e,this.toggleClass_(R.IN_TRANSIT,this.inTransit_)},t.prototype.toggleClass_=function(e,t){t?this.adapter_.addClass(e):this.adapter_.removeClass(e)},t}(I);var W=i.memo(i.forwardRef((function(e,t){return i.createElement("div",{ref:t,className:"mdc-slider__track"})}))),K=i.memo(i.forwardRef((function(e,t){return i.createElement("div",{ref:t,className:"mdc-slider__track-marker-container"})}))),Y=i.memo((function(e){var t=e.value;return i.createElement("div",{className:"mdc-slider__pin"},i.createElement("span",{className:"mdc-slider__pin-value-marker"},t))})),$=i.memo((function(){return i.createElement("svg",{className:"mdc-slider__thumb",width:"21",height:"21"},i.createElement("circle",{cx:"10.5",cy:"10.5",r:"7.875"}))})),z=i.memo((function(){return i.createElement("div",{className:"mdc-slider__focus-ring"})})),X=v((function(e,t){var n=function(e){var t=(0,i.useRef)(),n=(0,i.useRef)(),s=T({props:e,elements:{rootEl:!0,thumbContainerEl:!0,sliderPinEl:!0},foundation:function(e){var s,i,o,r=e.rootEl,c=e.thumbContainerEl,l=e.sliderPinEl,d=e.emit;return new G({hasClass:function(e){return r.hasClass(e)},addClass:function(e){return r.addClass(e)},removeClass:function(e){return r.removeClass(e)},getAttribute:function(e){return r.getProp(e)},setAttribute:(s=function(e,t){return r.setProp(e,t)},i=300,function(){var e=this,t=arguments;null!==o&&clearTimeout(o),o=setTimeout((function(){o=null,s.apply(e,t)}),i)}),removeAttribute:function(e){return r.removeProp(e)},computeBoundingRect:function(){return r.ref?r.ref.getBoundingClientRect():y},getTabIndex:function(){return r.ref?r.ref.tabIndex:0},registerInteractionHandler:function(e,t){r.addEventListener(e,t)},deregisterInteractionHandler:function(e,t){r.removeEventListener(e,t)},registerThumbContainerInteractionHandler:function(e,t){c.addEventListener(e,t)},deregisterThumbContainerInteractionHandler:function(e,t){c.removeEventListener(e,t)},registerBodyInteractionHandler:function(e,t){document.body&&document.body.addEventListener(e,t)},deregisterBodyInteractionHandler:function(e,t){document.body&&document.body.removeEventListener(e,t)},registerResizeHandler:function(e){window.addEventListener("resize",e)},deregisterResizeHandler:function(e){window.removeEventListener("resize",e)},notifyInput:function(){d("onInput",{value:a.getValue()})},notifyChange:function(){d("onChange",{value:a.getValue()})},setThumbContainerStyleProperty:function(e,t){c.setStyle(e,t)},setTrackStyleProperty:function(e,n){var s;null===(s=t.current)||void 0===s||s.style.setProperty(e,n)},setMarkerValue:function(e){l.setProp("value",e)},setTrackMarkers:function(e,t,s){var i,o=e.toLocaleString(),r="linear-gradient(to right, currentColor 2px, transparent 0) 0 center / calc((100% - 2px) / (("+t.toLocaleString()+" - "+s.toLocaleString()+") / "+o+")) 100% repeat-x";null===(i=n.current)||void 0===i||i.style.setProperty("background",r)},isRTL:function(){return!!r.ref&&"rtl"===getComputedStyle(r.ref).direction}})}}),a=s.foundation,c=r(s,["foundation"]);return(0,i.useEffect)((function(){void 0!==e.max&&a.setMax(+e.max)}),[e.max,a]),(0,i.useEffect)((function(){void 0!==e.min&&a.setMin(+e.min)}),[e.min,a]),(0,i.useEffect)((function(){var t=void 0!==e.value?Number(e.value):a.getValue(),n=a.getMin(),s=a.getMax();t<n&&(console.warn("Attempted to set slider to "+t+" which is less than min: "+n),t=n),t>s&&(console.warn("Attempted to set slider to "+t+" which is greater than max: "+s),t=s),a.setValue(t)}),[e.value,a]),(0,i.useEffect)((function(){void 0!==e.step&&a.setStep(+e.step)}),[e.step,a]),(0,i.useEffect)((function(){void 0!==e.disabled&&a.setDisabled(e.disabled)}),[e.disabled,a]),(0,i.useEffect)((function(){void 0!==e.discrete&&(a.isDiscrete_=e.discrete),e.discrete&&0===a.getStep()&&a.setStep(1)}),[e.discrete,a]),(0,i.useEffect)((function(){var t=a.hasTrackMarker_;void 0!==e.displayMarkers&&e.displayMarkers!==t&&(a.hasTrackMarker_=e.displayMarkers,window.requestAnimationFrame((function(){return a.setupTrackMarker()})))}),[e.displayMarkers,a]),(0,i.useEffect)((function(){var e=a.handleDown_.bind(a);a.handleDown_=function(t){t.persist(),e(t)}}),[a]),o({setTrackRef:function(e){return t.current=e},setTrackMarkerContainerRef:function(e){return n.current=e}},c)}(e),s=n.rootEl,a=n.thumbContainerEl,c=n.sliderPinEl,u=n.setTrackRef,f=n.setTrackMarkerContainerRef,g=e.value,v=(e.min,e.max),E=e.discrete,x=e.displayMarkers,_=e.step,C=e.disabled,A=(e.onChange,e.onInput,e.children),S=(e.foundationRef,r(e,["value","min","max","discrete","displayMarkers","step","disabled","onChange","onInput","children","foundationRef"])),b=function(e,t){return h().apply(void 0,d(d([e.className],l(e.theme?p(e.theme):[])),l("function"==typeof t?t(e):t)))}(e,["mdc-slider",{"mdc-slider--discrete":E,"mdc-slider--display-markers":x&&E}]),O=_?{"data-step":_}:{};return x&&!E&&console.warn("The 'displayMarkers' prop on rmwc Slider will\n        only work in conjunction with the 'discrete' prop"),i.createElement(m,o({tabIndex:0,role:"slider","aria-valuemax":v,"aria-valuenow":g,"aria-label":"Select Value"},C?{"aria-disabled":C}:{},O,S,{ref:t,element:s,className:b}),i.createElement("div",{className:"mdc-slider__track-container"},i.createElement(W,{ref:u}),x&&i.createElement(K,{ref:f})),i.createElement(m,{element:a,className:"mdc-slider__thumb-container"},E&&i.createElement(Y,{value:c.getProp("value")}),i.createElement($,null),i.createElement(z,null)),A)}));n(44704);const q=X;let Q=0;class J extends i.Component{constructor(e){super(e),this.mdcRef=(0,i.createRef)(),this.setValue=e=>{this.setState({value:e})},this.onSliderInput=e=>{var t;const n=e.detail.value;this.layoutRecalculated||(null===(t=this.mdcRef.current)||void 0===t||t.layout(),this.layoutRecalculated=!0),this.setState({value:n}),this.props.onInput&&this.props.onInput(n)},this.onSliderChange=e=>{const t=e.detail.value;this.setState({value:t}),this.props.onChange&&this.props.onChange(t)},this.getLeftOffset=()=>100*(this.state.value-this.props.min)/(this.props.max-this.props.min)+"%",this.getSliderId=()=>`slider-with-tooltip-${this.id}`,this.getStyleElement=()=>`#${this.getSliderId()} .mdc-slider__thumb-container {\n        left: ${this.getLeftOffset()}\n    }`,this.getDisplayValue=e=>{const{formatNumbers:t,units:n}=this.props;return(t?t(e):e)+(n||"")},this.setActive=e=>()=>this.setState({active:e}),this.hasChanged=()=>{this.setState({hasChanged:!1})},this.onMouseDown=e=>{this.props.onInputStart&&this.props.onInputStart()},this.onEventMouseUp=e=>{this.props.onInputEnd&&this.props.onInputEnd()},this.onMouseUp=e=>{this.props.onInputEnd&&this.props.onInputEnd()},this.id=Q++,this.state={value:void 0!==e.initialValue?e.initialValue:(e.max+e.min)/2,active:!1,hasChanged:!1},this.setActiveSlider=this.setActive(!0),this.setInactiveSlider=this.setActive(!1)}componentDidMount(){document.addEventListener("mouseup",this.onEventMouseUp),document.addEventListener("mouseleave",this.onEventMouseUp)}componentWillUnmount(){document.removeEventListener("mouseup",this.onEventMouseUp),document.removeEventListener("mouseleave",this.onEventMouseUp)}componentDidUpdate(e,t){t.value!==this.state.value&&(clearTimeout(this.hasChangedTimeout),this.setState({hasChanged:!0}),this.hasChangedTimeout=window.setTimeout(this.hasChanged,450))}render(){const{width:e,displayBounds:t,min:n,max:i,step:o,discrete:r,tooltipPosition:a=Z.DOWN,variant:c="default",disabled:l,tabIndex:d}=this.props,{active:u,hasChanged:p,value:m}=this.state,f={left:this.getLeftOffset()},g="inline-value"===c,v=!g&&t,E=!g,x=void 0!==d?d:0;return(0,s.jsxs)("div",{id:this.getSliderId(),className:h()("slider-with-tooltip",{displayBounds:t,disabled:l}),style:{width:e},onMouseEnter:this.setActiveSlider,onMouseLeave:this.setInactiveSlider,children:[E&&a===Z.UP&&(0,s.jsx)("div",{className:h()("slider-tooltip",{active:u||p}),"data-balloon":this.getDisplayValue(m),"data-balloon-pos":Z.UP,style:f}),v&&(0,s.jsx)("div",{className:"min-amount",children:this.getDisplayValue(n)}),g&&(0,s.jsx)("div",{className:"min-amount",children:this.getDisplayValue(m)}),(0,s.jsx)(q,{discrete:r,min:n,max:i,step:o,value:m,onInput:this.onSliderInput,onChange:this.onSliderChange,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,foundationRef:this.mdcRef,disabled:l,tabIndex:x}),v&&(0,s.jsx)("div",{className:"max-amount",children:this.getDisplayValue(i)}),(0,s.jsx)("style",{dangerouslySetInnerHTML:{__html:this.getStyleElement()}}),E&&a===Z.DOWN&&(0,s.jsx)("div",{className:h()("slider-tooltip",{active:u||p}),"data-balloon":this.getDisplayValue(m),"data-balloon-pos":Z.DOWN,style:f})]})}}var Z;!function(e){e.UP="up",e.DOWN="down"}(Z||(Z={}))},56500:(e,t,n)=>{"use strict";n.d(t,{n:()=>m});var s=n(74848),i=n(96540),o=n(23339),r=n(87635),a=n(26348);const c=e=>{let t="";t+=Math.floor(e)+"'";const n=Math.floor(e%1*12);return n<10&&(t+="0"),t+=n+"''",t};var l=n(29390),d=n(13584),u=n(56147),h=n(39869),p=u.A.WORKSHOP.MATTERTAGS;function m(e){const{stemEnabled:t,stemLength:n,onLengthUpdate:u,onLengthChanged:m,onStemEnabledChanged:f,variant:g,disabled:v,tabIndex:E}=e,x=(0,i.useRef)(null),_=(0,r.J)(),T=(0,h.Y)();(0,i.useEffect)((()=>{x.current&&x.current.setValue((0,a.ld)(n))}),[n]);const y=T.t(p.SHOW_STEM_LABEL);return(0,s.jsxs)("div",{className:"stem-editor",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("div",{className:"stem-slider",children:(0,s.jsx)(l.r,{ref:x,discrete:!1,min:.1,max:9,initialValue:(0,a.ld)(n),onChange:(e,t=!0)=>{const n=t?(0,a.hV)(e):e;m(n)},onInput:(e,t=!0)=>{const s=t?(0,a.hV)(e):e;s!==n&&u(s)},displayBounds:!0,width:150,formatNumbers:e=>{if(_===o.t.IMPERIAL)return c(e);return`${Math.round(100*(0,a.hV)(e))/100}m`},tooltipPosition:l.Q.DOWN,variant:g,disabled:v,tabIndex:E})}),(0,s.jsx)(d.S,{enabled:!0,checked:t,label:y,onChange:e=>{const t=e.classList.contains("checked");f(t)}})]})}},63220:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var s=n(74848),i=n(96540),o=n(72909),r=n(77570),a=n(32485),c=n.n(a),l=n(71397),d=n(50178),u=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},h=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let p=class extends i.Component{constructor(e){super(e),this.focusTimeout=0,this.onInput=e=>{if(this.props.onInput){const t=e.target;this.props.onInput(t.value)}},this.onKeyPress=e=>{e.stopPropagation();const{allowTabbing:t}=this.props,n=e.which||e.keyCode,s=[l.D.TAB,l.D.RETURN,l.D.ESCAPE];if("keydown"===e.type&&!s.includes(n))return!1;const i=e.target;switch(this.props.maxLength&&i.value.length>this.props.maxLength&&e.preventDefault(),n){case l.D.ESCAPE:this.props.onCancel&&this.props.onCancel();break;case l.D.TAB:case l.D.RETURN:this.props.onBlur||e.shiftKey||(n===l.D.TAB&&t||e.preventDefault(),this.blur())}return!1},this.stopPropagation=e=>e.stopPropagation(),this.onFocus=e=>{this.context.messageBus.broadcast(new d.Yl(this.input,!0)),this.props.onFocus&&this.props.onFocus(e)},this.onBlur=e=>{this.context.messageBus.broadcast(new d.Yl(this.input,!1));const t=e.target.value,{onBlur:n,onDone:s}=this.props;n?n(t):s&&s(t)},this.setRef=e=>{this.input=e},this.state={currentText:e.text}}componentWillUnmount(){window.clearTimeout(this.focusTimeout),this.input&&this.input.blur()}componentDidMount(){const{focusOnMount:e,readOnly:t}=this.props;t||(0===e?this.focus():void 0!==e&&(this.focusTimeout=window.setTimeout((()=>{this.focus()}),e)))}UNSAFE_componentWillReceiveProps(e){e.text!==this.props.text&&this.setState({currentText:e.text})}getText(){return this.input?this.input.value:""}focus(){this.input.focus()}blur(){this.input.blur()}scrollIntoView(e){this.input.scrollIntoView(e)}render(){const{placeholder:e,tabIndex:t,maxLength:n,type:i,className:o,readOnly:r,disabled:a}=this.props,{currentText:l}=this.state;return(0,s.jsx)("div",{className:c()("text-field",o),children:(0,s.jsx)("input",{ref:this.setRef,className:"text-input-box",type:i||"text",value:l,placeholder:e,"aria-label":e,maxLength:n,onInput:this.onInput,onKeyPress:this.onKeyPress,onKeyDown:this.onKeyPress,onKeyUp:this.stopPropagation,onBlur:this.onBlur,onFocus:this.onFocus,tabIndex:t,readOnly:r,disabled:!!a})})}};p.contextType=r.B,p=u([o.A,h("design:paramtypes",[Object])],p);const m=p},54086:(e,t,n)=>{"use strict";n.d(t,{U:()=>A});var s=n(74848),i=n(56147),o=n(68419),r=n(22213),a=n(96540),c=n(32485),l=n.n(c),d=n(89244),u=n(27975),h=n(17605),p=n(48270),m=n(12763),f=n(39869);const{MATTERTAGS:g}=i.A.WORKSHOP;function v(e){const{url:t,text:n,error:i,newLink:o}=e,r=(0,f.Y)(),a=""===n&&""===t&&o?r.t(g.LINK_EDITOR_TIP_TEXT):null,c=i?r.t(g.LINK_EDITOR_INVALID_TIP):null,d=l()("modal-message",{"modal-message-error":!!i}),u=c||a||"";return(0,s.jsx)("div",{className:d,children:u})}const{MATTERTAGS:E,MODAL:x}=i.A.WORKSHOP;function _(e){return(0,d.q)(e)}function T(e){const{linkUrl:t,linkText:n,onSaveLink:i,onRemoveLink:o,onCancelLink:r}=e,c=(0,f.Y)(),[d,g]=(0,a.useState)(!1),[T,y]=(0,a.useState)(n),[C,A]=(0,a.useState)(t),[S,b]=(0,a.useState)(_(t));(0,a.useEffect)((()=>(A(t),y(n),b(_(t)),g(!1),()=>{})),[n,t]);const O=(0,a.useCallback)((()=>{S&&window.open(C,"_blank","noreferrer")}),[C,S]),I=(0,a.useCallback)(((e,t)=>{const n=void 0!==t?t:C;i((void 0!==e?e:T)||n,n)}),[C,T,i]),R=(0,a.useCallback)((()=>{I(T,C)}),[I,T,C]),N=(0,a.useCallback)(((e,t)=>{const n=_(e);b(n),g(!n&&""!==e),t&&n&&I(T,e)}),[T,I]),L=(0,a.useCallback)((e=>{y(e)}),[]),k=(0,a.useCallback)((e=>{A(e);const t=_(e);b(t),d&&t&&g(!1)}),[d]),w=(0,a.useCallback)((()=>{N(C,!1)}),[C,N]),j=(0,a.useCallback)((()=>{N(C,!0)}),[C,N]),M=!t,P=c.t(E.LINK_EDITOR_TEXT_PLACEHOLDER),D=c.t(x.SAVE),H=c.t(x.CANCEL),U=c.t(E.LINK_EDITOR_PREVIEW_TIP),B=c.t(E.LINK_EDITOR_REMOVE_TIP),F=!M&&o;return(0,s.jsxs)("div",{className:"modal-contents",children:[(0,s.jsxs)("div",{className:"modal-body",children:[(0,s.jsx)("div",{className:"link-editor-field link-text-field",children:(0,s.jsx)(u.k,{text:T,placeholder:P,autofocus:!n,onInput:L,onCancel:r})}),(0,s.jsxs)("div",{className:"link-editor-field link-url-field",children:[(0,s.jsx)(u.k,{text:C,type:"url",placeholder:"https://",autofocus:!!n,onBlur:w,onReturn:j,onInput:k,onCancel:r}),S&&C&&(0,s.jsx)(h.$,{className:"preview-link",icon:"ext-link",variant:p.A.TERTIARY,size:p.M.SMALL,tooltip:U,onClick:O})]}),(0,s.jsx)(v,{newLink:M,text:n,url:C,error:d})]}),(0,s.jsx)("div",{className:"modal-footer",children:(0,s.jsxs)(m.e,{className:l()("modal-footer",{stretch:F}),children:[F&&(0,s.jsx)(h.$,{icon:"delete",label:B,className:"remove-link",variant:p.A.TERTIARY,size:p.M.SMALL,onClick:o}),(0,s.jsxs)(m.e,{spacing:"small",children:[(0,s.jsx)(h.$,{label:H,variant:p.A.SECONDARY,size:p.M.SMALL,onClick:r}),(0,s.jsx)(h.$,{label:D,variant:p.A.PRIMARY,disabled:!S,size:p.M.SMALL,onClick:R})]})]})})]})}var y=n(37049);const{MATTERTAGS:C}=i.A.WORKSHOP;function A(e){const{linkUrl:t,linkText:n,onSaveLink:i,onRemoveLink:a,onCancelLink:c}=e,l=(0,f.Y)(),d=(0,o.t)(),u=""===t?l.t(C.LINK_EDITOR_LINK_ADD_LABEL):l.t(C.LINK_EDITOR_LINK_EDIT_LABEL),h=d===r.a.LINK_EDITOR;return(0,s.jsx)(y.Q,{open:h,title:u,fullModal:!1,className:"link-editor-modal",children:(0,s.jsx)(T,{linkText:n,linkUrl:t,onCancelLink:c,onSaveLink:i,onRemoveLink:a})})}},37049:(e,t,n)=>{"use strict";n.d(t,{Q:()=>m});var s=n(74848),i=n(96540),o=n(40961),r=n(32485),a=n.n(r),c=n(56848),l=n(89087),d=n(53473),u=n(81088),h=n(90087),p=n(19072);function m({children:e,className:t,title:n,open:r,onClose:m,fullModal:f=!1,noHeader:g=!1,preventClose:v=!1}){const E=(0,p.x)(),x=(0,h.L)(),_=(0,i.useRef)(!1),T=(0,i.useCallback)((()=>{v||(x.issueCommand(new u.rH),m&&m())}),[x,m,v]),y=(0,i.useCallback)((()=>{_.current=!0,window.setTimeout((()=>{_.current=!1}),500)}),[]),C=(0,i.useCallback)((()=>{_.current&&(_.current=!1,T())}),[T]),A=E.querySelector("#react-render-root")||document.body,S=a()(t,{open:r,"full-modal":f});return(0,o.createPortal)((0,s.jsx)(c.w,{open:r,className:a()("modal-background",{open:r}),onPointerUp:C,onPointerDown:y,children:(0,s.jsxs)(l.l,{className:S,onClose:T,children:[g?null:(0,s.jsxs)("header",{className:"modal-header",children:[(0,s.jsx)("div",{className:"modal-title",children:n}),(0,s.jsx)(d.J,{onClose:T})]}),e]})}),A)}},24783:(e,t,n)=>{"use strict";n.d(t,{u:()=>_});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(97800),c=n(77570),l=n(72909),d=n(71397),u=n(89244),h=n(42329),p=n(75742),m=n(39905),f=n(28684),g=n(48463),v=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},E=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const x="​";let _=class extends i.Component{constructor(e){super(e),this.emailMention=!1,this.wordToken=null,this.endTokens={"@":[","," ","!","?","/",";",":","(",")"],"#":[","," ",".","!","?","/",";",":"]},this.wordElement=null,this.linkElement=null,this.onClickAnchor=e=>{const t=e.target,n=t.dataset.blocktype;this.props.active?(e.preventDefault(),n===p.n.LINK&&this.prepareLinkForEdit(t)):n&&this.props.onClickBlock({blockType:n,text:t.innerText,value:t.dataset.value,id:t.dataset.id},e)},this.onSelectionChange=()=>{const e=this.getCurrentRange();if(e){this.range=e.cloneRange();const t=this.wordElement&&null===this.wordElement.parentElement,n=!!this.wordElement&&this.wordElement!==this.getAnchorFromSelection();(t||n)&&this.wordElement&&(this.wordElement.classList.add("link-annotation-active"),this.endWordMatching()),this.insertFocusNodeIfNeeded()}},this.addFauxHighlight=()=>{this.execCommand("backColor","#ff315840")},this.removeFauxHighlight=()=>{this.execCommand("backColor","transparent")},this.isEmailMention=(e="")=>e.lastIndexOf("@")>0,this.onInput=e=>{var t;const n=e.nativeEvent,s=n.inputType,i=s.startsWith("insert"),o="insertLineBreak"===s,r=n.data,a=this.startTokens;e.stopPropagation();const{isLinkNode:c,isSpecialNode:l,anchorNode:d}=this.tryGetAnchorNode();if(a.length&&!c&&!o){let o=r&&r.length>0?r.charAt(r.length-1):"";const c=this.getTextElement(),u=((null==c?void 0:c.innerText)||"").trim().length;if(c&&s.startsWith("delete")&&0===u&&(c.innerHTML=""),this.updateWordElement(n,l,d),!this.wordToken&&a.includes(o)?(e.preventDefault(),this.wordToken=o,this.emailMention=!1,this.createWordElement(o),this.updateSuggestions()):!this.wordToken&&r&&r.length>1&&a.includes(r[0])&&(e.preventDefault(),this.wordToken=r[0],o=r[r.length-1],this.emailMention=this.isEmailMention(r),this.createWordElement(r),this.updateSuggestions()),this.wordToken&&this.wordElement){const n=this.wordElement.textContent||"",s=this.getMatches(n),r=s.length,a=null===(t=this.endTokens[this.wordToken])||void 0===t?void 0:t.includes(o);1===r&&this.sanitizeForSearch(n)===this.sanitizeForSearch(s[0].text)&&i?(e.preventDefault(),this.chooseMatch(s[0].text,s[0].value,s[0].id)):a&&"#"===this.wordToken?(e.preventDefault(),this.finishWordElement(!0)):a&&"@"===this.wordToken?(e.preventDefault(),this.emailMention?this.finishWordElement(!0):0===r&&this.clearWordElement()):"@"===this.wordToken?(this.updateUserMatches(),this.isEmailMention(n)&&(this.wordElement.classList.add("link-annotation-active"),this.emailMention=!0)):this.filterSuggestions()}}this.props.onInput(this.getMarkdown())},this.updateUserMatches=(0,a.sg)((()=>this.fetchUserMatches()),350),this.onClickMatch=e=>{const t=e.currentTarget;if(t){const n=t.dataset.value,s=t.dataset.id,i=t.dataset.text||t.innerText;e.stopPropagation(),e.preventDefault(),this.chooseMatch(i,n,s)}},this.onHoverMatch=e=>{const t=e.currentTarget;if(t){const e=parseInt(t.dataset.index||"0",10);this.setState({activeMatch:e})}},this.onClick=e=>{const{active:t,clickToEdit:n,onStartEditing:s}=this.props;t?(this.removeFauxHighlight(),this.range=null):n&&s&&s(e)},this.handleFocus=()=>{const{onFocusChange:e}=this.props;e&&e(!0)},this.onBlur=()=>{this.endWordMatching(),this.setState({sortedSuggestions:[]});const{onFocusChange:e}=this.props;e&&e(!1)},this.onDone=()=>{const{onDoneEditing:e}=this.props;e?e():this.toggleEditing(!1)},this.onKeyDown=e=>{const{onCancelEditing:t,allowTabbing:n,allowReturnKey:s}=this.props,{matches:i,activeMatch:o}=this.state;e.stopPropagation(),this.range||(this.range=this.getCurrentRange());const r=e.which||e.keyCode;switch(r){case d.D.ESCAPE:return void(t&&t());case d.D.TAB:case d.D.RETURN:if(i.length&&o>-1)e.preventDefault(),this.chooseMatch(i[o].text,i[o].value,i[o].id);else{const{isSpecialNode:t,anchorNode:i}=this.tryGetAnchorNode();if(t&&i&&this.range&&(e.preventDefault(),this.insertAndFocusCharacter(i,!1,`\n${x}`)),this.wordToken&&(e.preventDefault(),this.finishWordElement(!1,!0)),!e.shiftKey){const t=r===d.D.TAB&&n,i=r===d.D.RETURN&&s;t||i||(e.preventDefault(),this.onDone())}}return;case d.D.DOWNARROW:return void(i.length&&(e.preventDefault(),this.setState((e=>{const t=(e.activeMatch+1)%i.length;return this.ensureActiveMatchIsVisible(t),{activeMatch:t}}))));case d.D.UPARROW:return void(i.length&&(e.preventDefault(),this.setState((e=>{const t=0===e.activeMatch?i.length-1:e.activeMatch-1;return this.ensureActiveMatchIsVisible(t),{activeMatch:t}}))));case d.D.B:case d.D.I:case d.D.U:if(e.ctrlKey||e.metaKey)return void e.preventDefault();break;case d.D.BACKSPACE:case d.D.SHIFT:case d.D.CONTROL:case d.D.ALT:case d.D.LEFTARROW:case d.D.RIGHTARROW:case d.D.DELETE:return}},this.saveRef=e=>{this.textBox=e},this.bindSuggestionMenuRef=e=>{this.suggestionMenuRef=e},this.state={activeMatch:-1,matches:[],sortedSuggestions:[]}}componentDidMount(){this.props.active&&this.toggleEditing(!0,this.props.focusOnMount)}componentWillUnmount(){this.toggleEditing(!1),this.wordElement=null}componentDidUpdate(e,t){const{active:n}=this.props;n!==e.active&&this.toggleEditing(n)}toggleEditing(e,t){this.textBox&&this.textBox.toggleEditing(e,t),this.endWordMatching(),this.setState({sortedSuggestions:[]}),e?document.addEventListener("selectionchange",this.onSelectionChange):document.removeEventListener("selectionchange",this.onSelectionChange)}ensureActiveMatchIsVisible(e){if(!this.suggestionMenuRef)return;const{scrollTop:t,offsetHeight:n}=this.suggestionMenuRef,s=this.suggestionMenuRef.querySelector(`[data-index="${e}"]`);if(!s)return;const{offsetTop:i,offsetHeight:o}=s,r=t>i;if(t+n<i+o||r){const e=r;s.scrollIntoView(e)}}getTextElement(){var e;return null===(e=this.textBox)||void 0===e?void 0:e.getTextElement()}focus(){this.textBox&&this.textBox.focus()}getMarkdown(){const e=this.getTextElement();return e?this.props.textParser.serialize(e):""}hasTextSelected(){return!(!this.range||this.range.startOffset===this.range.endOffset)}createAnchor(e,t){const n=document.createElement("a");return n.href=t,n.text=this.props.textParser.sanitizeText(e),n.classList.add(m.H.LINK),n.setAttribute("data-value",t),n}prepareLinkForEdit(e){const t=e||this.getAnchorFromSelection();let n="";const s=window.getSelection();if(s){const e=this.getTextElement();t||this.range||!e?(this.addFauxHighlight(),t||(n=this.range?this.range.toString():s.toString())):(this.focus(),s.selectAllChildren(e),s.collapseToEnd(),this.range=s.getRangeAt(0),n=this.range.toString())}n===x&&(n=""),this.linkElement=t;const i=t?t.innerText:n,o=t?t.dataset.value||t.href:"";this.props.onClickBlock({blockType:p.n.LINK,text:i,value:o})}saveLink(e,t){this.linkElement?""!==t?this.updateLink(this.linkElement,e,t):this.unlink(this.linkElement):this.linkify(e,t)}updateLink(e,t,n){const s=this.createAnchor(t,n);return e.href=s.href,e.text=s.text,e.setAttribute("data-value",n),!0}cancelLink(){this.focus(),this.removeFauxHighlight()}linkify(e,t){this.removeFauxHighlight();const n=this.getCurrentRange();if(n){const s=document.createElement("a");s.href=t,s.text=e,s.className=`link-annotation ${m.H.LINK}`,s.setAttribute("data-blocktype",p.n.LINK),s.setAttribute("data-value",t),s.onclick=this.onClickAnchor,n.deleteContents(),n.insertNode(s),this.insertAndFocusCharacter(s)}}insertAndFocusCharacter(e,t=!1,n=x){if(this.range=this.getCurrentRange(),this.range){const s=document.createTextNode(n),i=t?"setStartBefore":"setStartAfter",o=t?"setEndBefore":"setEndAfter";this.range[i](e),this.range[o](e),this.range.insertNode(s),this.range.selectNodeContents(s),n!==x&&this.range.collapse(!1),this.applyRange()}}unlink(e){const t=e.parentNode,n=e.textContent;t&&(t.removeChild(e),n&&!(0,u.q)(n)&&this.execCommand("insertText",n))}execCommand(e,t){this.range&&(this.applyRange(),document.execCommand(e,!1,t),this.onSelectionChange())}applyRange(){if(this.range){const e=window.getSelection();e&&(e.removeAllRanges(),e.addRange(this.range))}}getAnchorFromSelection(){const e=this.getCurrentRange();if(!e)return null;let t=e.commonAncestorContainer;for(;t&&"A"!==t.nodeName;){if(t===this.getTextElement())return null;t=t.parentNode}return t||null}insertFocusNodeIfNeeded(){var e,t;const n=window.getSelection();if(!n||!this.range)return;const{anchorNode:s,isLinkNode:i}=this.tryGetAnchorNode();if(s){const o=null!==(t=null===(e=s.textContent)||void 0===e?void 0:e.length)&&void 0!==t?t:0,r=0===n.focusOffset&&o>0,a=null===s.nextSibling&&o===n.focusOffset&&i;(r||a)&&this.insertAndFocusCharacter(s,r)}}getCurrentRange(){const e=window.getSelection();if(e&&e.rangeCount>0){const t=e.getRangeAt(0),n=this.getTextElement();if(n&&(n===t.commonAncestorContainer||n.compareDocumentPosition(t.commonAncestorContainer)&Node.DOCUMENT_POSITION_CONTAINED_BY))return t}return null}sortWords(e){return e.sort(((e,t)=>e.text.toLowerCase()<t.text.toLowerCase()?-1:1))}tryGetAnchorNode(){var e;const t=this.getAnchorFromSelection();if(t&&t instanceof HTMLAnchorElement){const n=null===(e=t.dataset)||void 0===e?void 0:e.blocktype,s=n===p.n.USER||n===p.n.HASH,i=n===p.n.LINK;return{isSpecialNode:s,isLinkNode:i,anchorNode:s||i?t:null}}return{isSpecialNode:!1,isLinkNode:!1,anchorNode:null}}updateWordElement(e,t,n){const s=e.inputType.startsWith("delete"),i=window.getSelection(),o=this.startTokens;if(!this.wordElement||this.wordElement.parentElement){if(t&&n&&n.parentElement&&i){const e=n.textContent||"";if(!o.includes(e[0]||""))return void this.clearWordElement();const t=e.substr(0,i.focusOffset),r=i&&i.focusOffset<e.length,a=s||r;if(this.wordElement=n,this.wordToken=t[0],this.emailMention=this.isEmailMention(t),this.updateSuggestions(),this.range=this.getCurrentRange(),a&&this.range){this.range.selectNode(n);const s=this.range.extractContents();if(s&&s.firstElementChild&&s.firstElementChild instanceof HTMLElement){const n=e.substring(t.length),i=document.createTextNode(n);s.firstElementChild.innerText=t,s.firstElementChild.classList.remove("link-annotation-active"),s.firstElementChild.removeAttribute("data-value"),s.firstElementChild.removeAttribute("data-id"),s.appendChild(i),this.range.insertNode(s),this.range.setStartBefore(i),this.range.setEndBefore(i),this.range.collapse(!1),this.range.selectNodeContents(this.wordElement),this.range.collapse(!1),this.applyRange()}}}}else this.endWordMatching()}get startTokens(){const{hashtags:e,userMentions:t}=this.props,n=[];return t&&n.push("@"),e&&n.push("#"),n}fetchUserMatches(){const e=this.wordElement?this.wordElement.textContent:null;if(this.props.active&&this.wordToken&&e){const t=this.sanitizeForSearch(e,!0);this.context.commandBinder.issueCommand(new h.ly(t)).then((()=>{this.updateSuggestions()}))}}filterSuggestions(){const{wordToken:e,wordElement:t}=this;if(e&&t&&t.textContent){const e=this.sanitizeForSearch(t.textContent),n=this.getMatches(e),s=n.length>0?0:-1;this.setState({matches:n,activeMatch:s})}}sanitizeForSearch(e="",t){if(!this.wordToken)return e;let n=(e.startsWith(this.wordToken)?e.substr(1):e).toLowerCase().trim().replace(/\s\s+/g," ");if(t){const e=/([^\s]+)/.exec(n);n=e&&e[0]||""}return n}getMatches(e){const{sortedSuggestions:t=[]}=this.state,n=this.sanitizeForSearch(e)||"";return 0===n.length?t:t.filter((e=>{let t=0===this.sanitizeForSearch(e.text).indexOf(n);return!t&&"@"===this.wordToken&&e.value&&(t=0===this.sanitizeForSearch(e.value).indexOf(n)),t}))}chooseMatch(e,t,n){const s=this.wordElement;if(s){const i=this.wordToken&&!e.startsWith(this.wordToken)?this.wordToken:"";s.innerText=`${i}${e}`,s.classList.add("link-annotation-active"),t&&s.setAttribute("data-value",t),n&&s.setAttribute("data-id",n),this.finishWordElement(!1,!0),this.props.onInput(this.getMarkdown())}}updateSuggestions(){const{wordToken:e}=this,{hashtags:t,userMentions:n}=this.props;let s=[];if("#"===e&&t)s=this.sortWords(t.map((e=>({text:e,blockType:p.n.HASH}))));else if("@"===e&&n){const e=this.context.userData.getKnownUsers();s=this.sortWords(e.map((e=>({text:e.name,id:e.id,value:e.email,blockType:p.n.USER}))))}this.setState({sortedSuggestions:s},this.filterSuggestions)}endWordMatching(){this.setState({matches:[],activeMatch:-1}),this.wordToken=null,this.wordElement=null,this.emailMention=!1}createWordElement(e){const t=window.getSelection(),n=this.range;if(!n||!t||!this.wordToken)return;const s=document.createElement("a");s.removeAttribute("href"),s.innerText=e,"#"===this.wordToken?(s.className=`link-annotation ${m.H.HASH}`,s.setAttribute("data-blocktype",p.n.HASH)):"@"===this.wordToken&&(s.className=`link-annotation ${m.H.USER}`,s.setAttribute("data-blocktype",p.n.USER));const i=n.startContainer,o=n.startOffset,r=n.endOffset+e.length,a=Math.max(0,(i.textContent||"").length);try{n.setStart(i,Math.min(o,a)),n.setEnd(i,Math.min(r,a))}catch(e){n.selectNodeContents(i)}n.deleteContents(),n.insertNode(s),n.selectNodeContents(s),n.collapse(!1),this.applyRange(),this.wordElement=s}clearWordElement(){const e=this.range,t=window.getSelection();e&&t&&this.wordElement&&this.wordToken&&(this.stripAnchorFromNode(this.wordElement),this.endWordMatching())}stripAnchorFromNode(e){const t=this.range;if(!t)return;const n=e.textContent;if(this.focus(),t.selectNode(e),t.deleteContents(),t.collapse(!1),n){const e=document.createTextNode(n);t.insertNode(e),t.selectNodeContents(e),t.collapse(!1)}this.applyRange()}isValidSpecialWord(e,t){return 0!==this.sanitizeForSearch(t).length||(this.clearWordElement(),!1)}finishWordElement(e,t){const{range:n,wordElement:s,wordToken:i}=this,o=window.getSelection();if(!(n&&o&&s&&i))return;s.contentEditable="true",s.classList.add("link-annotation-active");let r="";const a=s.textContent;if(this.isValidSpecialWord(i,a||"")){if(e&&a&&a.length>1?(r=a.charAt(a.length-1),s.textContent=a.slice(0,-1)):t&&(r=" "),this.focus(),n.setStartAfter(s),r){const e=document.createTextNode(r);n.insertNode(e),n.selectNodeContents(e),n.collapse(!1)}this.applyRange(),this.endWordMatching()}else this.clearWordElement()}renderMatch(e,t){const{activeMatch:n}=this.state,i=t===n,o=e.blockType===p.n.USER,a=o&&e.value?this.context.userData.getUserDisplay(e.value):null,c=o?e.value:void 0,l=`${e.text}-${t}`;return(0,s.jsxs)("div",{className:r()("suggestion",{selected:i}),onMouseDown:this.onClickMatch,onMouseEnter:this.onHoverMatch,"data-value":e.value,"data-id":e.id,"data-text":e.text,"data-index":t,children:[o&&a&&(0,s.jsx)(g.E,{badgeStyle:{color:a.color,borderColor:a.color,backgroundColor:"transparent"},label:a.initials}),(0,s.jsx)("span",{className:"suggestion-text",children:e.text}),c&&(0,s.jsxs)("p",{className:"suggestion-hint",children:["(",c,")"]})]},l)}renderMatches(){if(!this.props.active)return null;const{matches:e}=this.state,t=e.length>0;return(0,s.jsx)("div",{className:r()("suggestion-menu",{open:t}),ref:this.bindSuggestionMenuRef,children:t&&e.map(((e,t)=>this.renderMatch(e,t)))})}render(){const{text:e,textParser:t,clickToEdit:n,placeholder:i,tabIndex:o,className:a,active:c}=this.props;return(0,s.jsxs)("div",{className:r()("smart-text-box",a),children:[(0,s.jsx)(f.A,{ref:this.saveRef,text:e,textParser:t,active:c,placeholder:i,tabIndex:o,clickToEdit:n&&!c,onClick:this.onClick,onInput:this.onInput,onKeyDown:this.onKeyDown,onBlur:this.onBlur,onFocus:this.handleFocus,onClickAnchor:this.onClickAnchor}),this.renderMatches()]})}};_.contextType=c.B,_=v([l.F,E("design:paramtypes",[Object])],_)},71188:(e,t,n)=>{"use strict";n.d(t,{w:()=>i});var s=n(12103);function i(e){return e.width<=s._8}},89244:(e,t,n)=>{"use strict";n.d(t,{q:()=>i});var s=new RegExp("^(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+(?:[a-z\\u00a1-\\uffff]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$","i");const i=e=>(e=>s.test(e))(e)&&/^https?:\/\//.test(e)},40036:(e,t,n)=>{"use strict";if(n.d(t,{U:()=>o,t:()=>r}),5602==n.j)var s=n(96622);if(5602==n.j)var i=n(66726);var o;!function(e){e.DISC_COLOR="disc_color",e.STEM_VISIBLE="stem_visible",e.STEM_LENGTH="stem_length",e.TITLE="title",e.DESCRIPTION="description",e.MEDIA="media",e.LINKS="links",e.ENABLED="enabled",e.KEYWORDS="keywords"}(o||(o={}));class r{constructor(){this.handlers=[{msgType:s.Y_,func:(e,t)=>{const n={mattertag_sid:t.sid,mattertag_position:t.position,mattertag_distance_from_camera:t.distanceFromCamera};e.track("mattertag_add",n)}},{msgType:s.Fj,func:(e,t)=>{const n={mattertag_sid:t.sid,mattertag_remove_method:t.removeMethod};e.track("mattertag_remove",n)}},{msgType:s.On,func:(e,t)=>{const n={mattertag_sid:t.sid,mattertag_character_count:t.characterCount};e.track("mattertag_add_title",n)}},{msgType:s.GN,func:(e,t)=>{const n={mattertag_sid:t.sid,mattertag_character_count:t.characterCount};let s=1;t.tagDescriptionChunks.forEach((e=>{"link"===e.type&&void 0!==e.link&&(n["mattertag_link_domain"+s++]=(0,i.SE)(e.link.url))})),e.track("mattertag_add_description",n)}},{msgType:s.KW,func:(e,t)=>{const n={mattertag_sid:t.sid,mattertag_property:t.property,mattertag_value:t.value};e.track("mattertag_edit",n)}},{msgType:s.oO,func:(e,t)=>{const n={mattertag_sid:t.sid,mattertag_position:t.position,mattertag_distance_from_camera:t.distanceFromCamera,mattertag_distance_moved:t.distanceMoved};e.track("mattertag_moved",n)}},{msgType:s.EX,func:(e,t)=>{const n={mattertag_sid:t.sid,media_type:t.mediaType,media_src:t.mediaSrc};e.track("mattertag_add_media",n)}}]}}},96622:(e,t,n)=>{"use strict";n.d(t,{EX:()=>c,Fj:()=>o,GN:()=>a,KW:()=>l,On:()=>r,Y_:()=>i,oO:()=>d});var s=n(77201);class i extends s.QB{constructor(e,t,n){super(),this.sid=e,this.position=t,this.distanceFromCamera=n}}class o extends s.QB{constructor(e,t){super(),this.sid=e,this.removeMethod=t}}class r extends s.QB{constructor(e,t){super(),this.sid=e,this.characterCount=t}}class a extends s.QB{constructor(e,t,n){super(),this.sid=e,this.characterCount=t,this.tagDescriptionChunks=n}}class c extends s.QB{constructor(e,t,n){super(),this.sid=e,this.mediaType=t,this.mediaSrc=n}}class l extends s.QB{constructor(e,t,n){super(),this.sid=e,this.property=t,this.value=n}}class d extends s.QB{constructor(e,t,n,s){super(),this.sid=e,this.position=t,this.distanceFromCamera=n,this.distanceMoved=s}}},32502:(e,t,n)=>{"use strict";var s;n.d(t,{f:()=>s}),function(e){e[e.Standard=0]="Standard",e[e.Depth=1]="Depth",e[e.Transparent=2]="Transparent",e[e.Wireframe=3]="Wireframe",e[e.UV=4]="UV",e[e.CeilingSample=5]="CeilingSample",e[e.FloorSample=6]="FloorSample"}(s||(s={}))},86406:(e,t,n)=>{"use strict";n.d(t,{b:()=>i});var s=n(77201);class i extends s.B_{constructor(){super(...arguments),this.name="hashtag-data",this.hashtags=(0,s.Zg)([])}addHashtags(e){this.atomic((()=>{e.forEach((e=>{this.addHashtag(e)}))}))}addHashtag(e){const t=e.trim().toLowerCase();-1===this.hashtags.map((e=>e.trim().toLowerCase())).indexOf(t)&&this.hashtags.push(e)}getHashtags(){return this.hashtags.values()}}},4508:(e,t,n)=>{"use strict";n.d(t,{V:()=>d});var s=n(74848),i=n(56147),o=n(39869),r=n(95143),a=n(29397),c=n(55666);const{NOTES:l}=i.A.SHOWCASE;function d({userName:e,description:t,numAttachments:n,numComments:i,searchText:d}){const u=(0,a.V)(),h=(0,o.Y)(),p=i-1,m=(d?(0,r.x8)(e,d):e).trim(),f=h.t(l.REPLIES,p);let g="";return""===t?n>0?g=h.t(l.NUM_ATTACHMENTS,n):0===p&&(g=h.t(l.CONTENT_DELETED)):g=(d?(0,r.x8)(t,d):t).trim(),(0,s.jsxs)("div",{className:"item-details",children:[(0,s.jsxs)("div",{className:"item-header",children:[u&&(0,s.jsx)(c.L,{text:m.trim(),textParser:u,markers:r.S8}),p>0&&!d&&(0,s.jsx)("span",{className:"note-summary-info note-replies",children:f})]}),u&&(0,s.jsx)("div",{className:"item-description",children:(0,s.jsx)(c.L,{text:g,textParser:u,markers:r.S8,linksActive:!1})})]})}},28308:(e,t,n)=>{"use strict";n.d(t,{$:()=>O,B:()=>b});var s=n(74848),i=n(96540),o=n(56147),r=n(39869),a=n(13397),c=n(95541),l=n(48411),d=n(28479),u=n(87306),h=n(20263),p=n(30576),m=n(12763),f=n(88503),g=n(48270),v=n(17605),E=n(48463),x=n(88372),_=n(4508),T=(n(64879),n(38731)),y=n(90087),C=n(68375),A=n(35517);const{NOTES:S}=o.A.SHOWCASE,b=({item:e})=>e?(0,s.jsx)(O,{item:e},e.id):null,O=({item:e})=>{const t=(0,i.useRef)(null),n=(0,T.B)(),b=(0,C.s)(),O=(0,y.L)(),I=(0,r.Y)(),R=(0,c.H)(),N=(0,l.T)(),L=(0,h.r)(),k=(0,a.e)(),w=(0,d.L)(),j=(0,A.sG)(L),M=(0,A.zJ)(L),P=(0,p.XW)(),{id:D,title:H,description:U,color:B,resolved:F,numAttachments:V,numComments:G}=e,W=D,K=e.parentId;if(!K||!W)return null;const Y=K===(null==L?void 0:L.id),$=F||!e.isLayerVisible(),z=I.t(S.EDIT_LIST_ITEM_OPTION_CTA),X=I.t(S.DELETE_LIST_ITEM_OPTION_CTA),q=j||M?(0,s.jsx)(m.e,{children:(0,s.jsxs)(f.y,{ref:t,icon:"more-vert",ariaLabel:I.t(o.A.MORE_OPTIONS),variant:g.A.TERTIARY,menuArrow:!0,menuClassName:"search-result-menu",children:[(0,s.jsx)(v.$,{label:z,size:g.M.SMALL,disabled:!j,variant:g.A.TERTIARY,onClick:()=>{b.trackGuiEvent("notes_list_edit_note",{tool:w}),O.issueCommand(new u.FV(K,!0,!0,W))}}),(0,s.jsx)(v.$,{className:"menu-delete-btn",label:X,size:g.M.SMALL,disabled:!M,variant:g.A.TERTIARY,onClick:()=>{b.trackGuiEvent("notes_list_delete_note",{tool:w}),O.issueCommand(new u.T0(K))}})]})}):void 0,Q=(0,s.jsx)(_.V,{description:U,userName:H,numAttachments:V,numComments:G,searchText:k}),J=P===p.cD.AURA?{"--badge-color":B}:B?{backgroundColor:B,borderColor:B}:void 0,Z=P===p.cD.AURA?"icon-comment-outline":"icon-comment",ee=(0,s.jsx)(E.E,{badgeStyle:J,iconClass:Z});return(0,s.jsx)(x.c,{id:W,className:"search-result-item notes-list-item",title:Q,badge:ee,active:Y,disabled:$,onClick:async()=>{b.trackGuiEvent("search_item_note_click",{tool:w}),e.onSelect(n,N,R)},actions:q},W)}},34489:(e,t,n)=>{"use strict";n.d(t,{y:()=>T});var s=n(97800),i=n(17084),o=n(73566),r=n(74381),a=n(78849),c=n(81459),l=n(23500),d=n(28475),u=n(57811),h=n(75522),p=n(78450),m=n(87306),f=n(89416),g=n(28308),v=n(56147),E=n(32408),x=n(95439);const{NOTES:_}=v.A.SHOWCASE;class T{constructor(e,t){this.engine=e,this.settings=t,this.disabledAssets={[u.f]:!1,[d.RP]:!1,[l.s]:!1,[h.qE]:!1},this.settingsToggler=new c.U(this.settings,this.disabledAssets),this.initPromise=this.init()}async init(){const{market:e}=this.engine;[this.notesViewData,this.searchData]=await Promise.all([e.waitForData(p.b),e.waitForData(a.L)]),this.setSearchItemFC(!0)}async activate(){this.settingsToggler.toggle(!0),await this.initPromise,await this.engine.commandBinder.issueCommand(new m.I8(!0))}async deactivate(){await this.engine.commandBinder.issueCommand(new m.I8(!1)),this.settingsToggler.toggle(!1)}async dispose(){await this.initPromise,this.setSearchItemFC(!1)}setSearchItemFC(e){const t=this.searchData.getSearchDataTypeGroup(r.jM.NOTE);t&&(t.itemFC=e?g.$:void 0)}async deepLink(e){const t=(await this.engine.market.waitForData(p.b)).getNoteView(e);if(t)(0,E.zX)(this.settings,t,(t=>{this.engine.commandBinder.issueCommand(new m.FV(e,!0,!1,(0,s.EN)().comment,t))}));else{const e={messagePhraseKey:_.MISSING_MESSAGE,timeout:4e3,dismissesOnAction:!0};this.engine.commandBinder.issueCommand(new x.Q(e)),this.engine.commandBinder.issueCommandWhenBound(new i.yU(o.S0.NOTES,!0))}}async hasPendingEdits(){const{notesPhase:e,activeNotation:t}=this.notesViewData;switch(e){case f.f.IDLE:case f.f.CLOSED:case f.f.OPENING:return!1;case f.f.EDITING:case f.f.CREATING:return!0;default:return!!t}}}},15192:(e,t,n)=>{"use strict";n.d(t,{A:()=>B});var s=n(74848),i=n(73566),o=n(68419),r=n(78956),a=n(90087),c=n(43327),l=n(25727),d=n(89002),u=n(47013),h=n(74453),p=n(89416),m=n(87306),f=n(20263),g=n(98378),v=n(14326),E=n(70466),x=n(35517),_=n(53641),T=n(17605),y=n(48270),C=n(11439),A=n(33837),S=n(96540),b=n(56147),O=n(97800),I=n(39869),R=n(40145),N=n(42556);const{NOTES:L}=b.A.SHOWCASE;function k(){const e=(0,S.useMemo)((()=>(0,O.C8)()),[]),t=(0,d.f)(),n=(0,R.w)(),i=(0,I.Y)(),o=t===l.ce.CREATING,r=t===l.ce.PLACING;let a=null;if(o||!n||!e&&r){const t=i.t(e?L.OVERLAY_ADD_TOUCH:L.OVERLAY_ADD_CLICK),s=i.t(e?L.OVERLAY_PLACE_TOUCH:L.OVERLAY_PLACE_CLICK);a=n?t:s}return a?(0,s.jsxs)(N.W,{children:[(0,s.jsx)("div",{className:"icon icon-notes"}),(0,s.jsx)("span",{className:"message",children:a})]}):null}var w=n(94413),j=n(58338),M=n(50989),P=n(85989),D=n(68375);const{NOTES:H}=b.A.SHOWCASE;function U({canEdit:e,canDelete:t}){const n=(0,S.useRef)(null),o=(0,D.s)(),c=(0,a.L)(),u=(0,g.m)(),h=(0,f.r)(),v=(0,E.g)(),x=(0,r.O)(),_=(0,d.f)(),C=(0,w.W)(),A=(0,I.Y)(),b=_!==l.ce.IDLE,O=u===p.f.EDITING,R=A.t(H.COLOR_STEM_TOOLTIP),N=A.t(H.DELETE_TOOLTIP),L=A.t(H.ADD_TOOLTIP),k=A.t(H.CANCEL_TOOLTIP),U=b?k:L,B=x===i.L$.SIDE_PANEL,F=b?j.R.CANCEL:j.R.ADD,V=b,G=B&&e&&!b?(0,s.jsx)(T.$,{className:"action-button-outer",icon:"stem-height",variant:y.A.FAB,theme:"overlay",active:O,tooltip:R,onClick:()=>{c.issueCommand(new m.dz(!O))}}):void 0,W=B&&t&&!b?(0,s.jsx)(T.$,{className:"action-button-outer",variant:y.A.FAB,theme:"overlay",icon:"delete",tooltip:N,onClick:()=>{h&&(o.trackToolGuiEvent("notes","notes_overlay_click_delete"),c.issueCommand(new m.T0(h.id)))}}):void 0;return(0,s.jsx)(P.E,{outerLeft:G,outerRight:W,children:(0,s.jsx)(M.A,{ref:n,addIcon:F,allowLayerChange:V,disabled:!C,onClick:()=>{b?v&&c.issueCommand(new m.eg):(o.trackToolGuiEvent("notes","notes_overlay_click_add"),c.issueCommand(new m.C0))},tooltip:U,nudgeDisabled:!0})})}function B(){const e=(0,a.L)(),t=(0,o.t)(),n=(0,r.O)(),S=(0,f.r)(),b=(0,g.m)(),O=(0,d.f)(),I=(0,u.E)(),R=(0,h.S)(),N=(0,v.O)(),L=(0,E.g)(),w=b===p.f.CLOSED,j=(0,c.f)(),M=(0,x.kc)(),P=(0,x.sG)(S),D=(0,x.zJ)(S);if(t||w)return null;const H=b===p.f.OPENING,B=b===p.f.EDITING,F=M&&!j&&!N,V=n===i.L$.SIDE_PANEL,G=O===l.ce.PRESSING,W=!!S&&!H,K=!V&&!L&&S&&P;return(0,s.jsxs)("div",{className:"overlay grid-overlay notes-overlay",children:[K&&(0,s.jsx)("div",{className:"overlay-top-right",children:(0,s.jsx)(T.$,{icon:"stem-height",variant:y.A.FAB,theme:"overlay",disabled:!W,active:B,onClick:t=>{t.stopPropagation(),e.issueCommand(new m.dz(!B))}})}),(0,s.jsx)(k,{}),F&&(0,s.jsx)(U,{canEdit:P,canDelete:D}),S&&V&&P&&(0,s.jsx)(C.n,{pin:S,id:S.id,pinType:l.yY.NOTE,onSave:t=>{S&&e.issueCommand(new m.Xc(S.id,t))},onClose:()=>{e.issueCommand(new m.dz(!1))},open:B,colors:_.Ay.colors,toolPanelLayout:n}),G&&(0,s.jsx)(A.z,{progress:I,screenPosition:R})]})}},99113:(e,t,n)=>{"use strict";n.d(t,{_:()=>Lt});var s=n(74848),i=n(96540),o=n(73566),r=n(68419),a=n(78956),c=n(58062),l=n(22213),d=n(20263),u=n(62834);var h=n(70466),p=n(90087),m=n(53289),f=n(54616),g=n(25727),v=n(51831),E=n(25296),x=n(58972),_=n(87306),T=n(89416),y=n(98378),C=n(53641),A=n(32485),S=n.n(A),b=n(45205),O=n(94799),I=n(68375),R=n(3101),N=n(71687),L=n(14326),k=n(80411);function w(e){const t=[];return e&&e.comments.forEach((e=>{t.push(...e.attachments)})),t}var j=n(35517),M=n(39869),P=n(74381);function D(){const e=(0,f.P)(),[t,n]=(0,i.useState)(e.getUsersWhoMayNeedAccess()||{});return(0,i.useEffect)((()=>{function t(){n(e.getUsersWhoMayNeedAccess()||{})}const s=e.onChanged(t);return t(),()=>s.cancel()}),[e]),t}var H=n(29397),U=n(24865),B=n(93388),F=n(98236),V=n(86406);const G=(0,F.v_)(V.b);function W(){const e=G(),[t,n]=(0,i.useState)((null==e?void 0:e.getHashtags())||[]);return(0,i.useEffect)((()=>{if(!e)return()=>{};function t(){n((null==e?void 0:e.getHashtags())||[])}const s=e.onChanged(t);return t(),()=>{s.cancel()}}),[e]),t}var K=n(88503),Y=n(48270),$=n(17605),z=n(48463),X=n(72909),q=n(77570),Q=n(75742),J=n(67430),Z=n(40409),ee=n(81088),te=n(20835),ne=n(15684),se=n(12640),ie=n(50365),oe=n(12763),re=n(27482),ae=n(24783),ce=n(36220),le=n(54086),de=n(56147),ue=n(37049),he=n(2204);const{EMBED:pe}=de.A.WORKSHOP;function me(e){const{parentType:t,parentId:n,onEmbed:i,onCancel:o}=e,a=(0,M.Y)(),c=(0,r.t)(),d=a.t(pe.MEDIA_LINK_LABEL),u=c===l.a.MEDIA_EMBED_POPUP;return(0,s.jsx)(ue.Q,{open:u,title:d,fullModal:!1,className:"media-embed-popup",onClose:o,children:(0,s.jsx)(he.P,{parentId:n,parentType:t,onEmbed:i})})}var fe=n(77071),ge=(n(72286),function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r}),ve=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{ANNOTATIONS:Ee}=de.A.SHOWCASE;let xe=class extends i.Component{constructor(e){super(e),this.uploadTooltipTimeout=0,this.bindings=[],this.isUnmounting=!1,this.getAttachmentsState=()=>{if(!this.attachmentsData)return;const{active:e,parentId:t,parentType:n}=this.props;if(!e)return;return{pendingAttachments:this.attachmentsData.getPendingAttachmentsForAsset(t,n),removedAttachments:this.attachmentsData.getRemovedAttachmentsForAsset(t,n),failures:this.attachmentsData.failures.values,uploads:this.attachmentsData.uploads.values}},this.updateAttachments=()=>{const e=this.getAttachmentsState();e&&this.setState(e)},this.cancelEdits=()=>{this.props.onCancelEditing&&this.props.onCancelEditing()},this.saveEdits=()=>{this.onDoneEditing()},this.onDoneEditing=()=>{const{onDoneEditing:e}=this.props;if(e){const t=this.getMarkdown();e(t,""===t&&0===this.getAttachmentCount())}},this.onInput=e=>{this.setState({textChanged:e.trim()!==this.props.text,charCount:e.length})},this.openLinkEditor=()=>{!(this.props.openModal===l.a.LINK_EDITOR)&&this.textEditor&&(this.context.analytics.trackGuiEvent("annotation_open_link_editor",{tool:"notes"}),this.textEditor.prepareLinkForEdit())},this.onClickBlock=(e,t)=>{var n;const{active:s,annotationType:i,annotationId:o,linkHandler:r}=this.props,a=e.blockType;if(a===Q.n.LINK&&s)this.setState({selectedBlock:e}),this.context.commandBinder.issueCommand(new ee.X6(l.a.LINK_EDITOR,!0));else if(!s){if(a===Q.n.LINK&&r&&e.value){t&&t.preventDefault();const s=(0,J.A)(e.value),{url:a,modelId:c,pose:l}=s;c?r.handler.openLink({fullLink:a,modelId:c}):l?(r.handler.openLink({fullLink:a,pose:l}),null===(n=this.annotationsModule)||void 0===n||n.closeAnnotation(o,i)):r.handler.openLink(a)}this.context.messageBus.broadcast(new Z.v(i,o,e))}},this.closeLinkEditor=async()=>(this.setState({selectedBlock:null}),this.context.commandBinder.issueCommand(new ee.X6(l.a.LINK_EDITOR,!1))),this.onCancelLink=async()=>{await this.closeLinkEditor()},this.openEmbedEditor=()=>{this.context.analytics.trackGuiEvent("annotation_open_embed_editor",{tool:"notes"}),this.context.commandBinder.issueCommand(new ee.X6(l.a.MEDIA_EMBED_POPUP,!0))},this.closeEmbedEditor=()=>{this.context.commandBinder.issueCommand(new ee.X6(l.a.MEDIA_EMBED_POPUP,!1))},this.onRemoveLink=()=>{this.onSaveLink("","")},this.onSaveLink=(e,t)=>{this.props.openModal===l.a.LINK_EDITOR&&this.textEditor&&(this.setState({textChanged:!0}),this.textEditor.saveLink(e,t),this.closeLinkEditor())},this.onClickFileInput=()=>{const{active:e,onClickToEdit:t}=this.props;this.isAtMaxAttachments()?(window.clearTimeout(this.uploadTooltipTimeout),this.setState({showUploadTooltip:!0}),this.uploadTooltipTimeout=window.setTimeout((()=>{this.setState({showUploadTooltip:!1})}),2500)):!e&&t&&t()},this.onFileUpload=e=>{const{parentId:t,parentType:n}=this.props,s=Array.from(e),i=this.getAttachmentCount();e.length+i>ne.iS&&s.splice(ne.iS-i),this.attachmentsModule.uploadAttachments(t,n,s),this.edit()},this.onDrop=e=>{this.context.analytics.trackGuiEvent("attachment_drag_and_dropped",{tool:"notes"}),this.onFileUpload(e)},this.onFilesChosen=e=>{this.context.analytics.trackGuiEvent("annotation_files_chosen",{tool:"notes"}),this.onFileUpload(e)},this.dropActivated=()=>{const{active:e,creating:t,onClickToEdit:n}=this.props;t&&!e&&n&&n()},this.setTextEditorRef=e=>{this.textEditor=e},this.state={textChanged:!1,charCount:e.text.length,selectedBlock:null,showUploadTooltip:!1,pendingAttachments:[],removedAttachments:[],uploads:[],failures:[]}}componentDidMount(){this.context.market.waitForData(te.v).then((e=>{this.attachmentsData=e,this.bindings.push(this.attachmentsData.onChanged(this.updateAttachments)),this.isUnmounting||this.updateAttachments()})),this.context.engine.getModuleBySymbol(N.Et).then((e=>{this.annotationsModule=e})),this.context.engine.getModuleBySymbol(N.qy).then((e=>{this.attachmentsModule=e}))}componentWillUnmount(){this.isUnmounting=!0,window.clearTimeout(this.uploadTooltipTimeout);for(const e of this.bindings)e.cancel()}componentDidUpdate(e,t){const{active:n,parentId:s,parentType:i}=this.props;e.active&&!n?this.setState({textChanged:!1,pendingAttachments:[],removedAttachments:[],uploads:[],failures:[]}):s===e.parentId&&i===e.parentType||this.updateAttachments()}edit(){this.textEditor&&this.textEditor.toggleEditing(!0)}focus(){this.textEditor&&this.textEditor.focus()}getMarkdown(){let e;return e=this.textEditor?this.textEditor.getMarkdown():this.props.text,e.trim()}getAttachmentCount(){const{attachments:e}=this.props,{pendingAttachments:t,removedAttachments:n,uploads:s}=this.state;return e.length+t.length+s.length-n.length}isAtMaxAttachments(){return this.getAttachmentCount()>=ne.iS}inEmptyState(){const{active:e,text:t}=this.props;return!e&&""===t.trim()&&0===this.getAttachmentCount()}renderButtonBar(){const{active:e,creating:t,parentId:n,maxLength:i}=this.props;if(!e)return null;const{pendingAttachments:o,removedAttachments:r,textChanged:a,charCount:c,uploads:l,showUploadTooltip:d}=this.state,u=this.isAtMaxAttachments(),h=a||r.length>0||o.length>0,p=l.length>0,m=!u&&!p,f=h&&e&&!p&&!(i&&c>i),g=u?ce.Df.DIMMED:p?ce.Df.DISABLED:ce.Df.ENABLED,v=this.context.locale.t(u?Ee.MAX_ATTACHMENTS_TOOLTIP:Ee.UPLOAD_TOOLTIP,ne.iS),E=this.context.locale.t(u?Ee.MAX_ATTACHMENTS_TOOLTIP:Ee.EMBED_TOOLTIP,ne.iS),x=this.context.locale.t(t?Ee.ADD_CTA:Ee.SAVE_CTA),_=this.context.locale.t(Ee.LINK_TOOLTIP),T=this.context.locale.t(Ee.CANCEL_CTA);return(0,s.jsxs)("div",{className:"annotation-button-bar",children:[(0,s.jsxs)("div",{className:"annotation-editors",children:[(0,s.jsx)(ie.e,{id:`${n}-annotation`,multi:!0,enabled:m,onUpload:this.onFilesChosen,children:(0,s.jsx)(ce.K0,{iconClass:"icon-attach",buttonStyle:ce.zt.PLAIN,buttonState:g,onClick:this.onClickFileInput,tooltipMsg:v,tooltipPersist:d})}),(0,s.jsx)(ce.K0,{iconClass:"icon-media-mix",buttonStyle:ce.zt.PLAIN,buttonState:g,tooltipMsg:E,onClick:this.openEmbedEditor}),(0,s.jsx)(ce.K0,{iconClass:"icon-add-link",buttonStyle:ce.zt.PLAIN,tooltipMsg:_,onClick:this.openLinkEditor})]}),(0,s.jsxs)(oe.e,{className:"annotation-cta-buttons",spacing:"small",children:[(0,s.jsx)($.$,{variant:Y.A.TERTIARY,size:"small",onClick:this.cancelEdits,label:T},"cancel"),(0,s.jsx)($.$,{variant:Y.A.TERTIARY,size:"small",disabled:!f,onClick:this.saveEdits,label:x},"save")]})]})}renderAttachments(){const{attachments:e,active:t,onViewAttachment:n,annotationType:i,parentId:o}=this.props,{pendingAttachments:r}=this.state,a=this.attachmentsData?e.filter((e=>!this.attachmentsData.removals.get(e.id))):e;if(r.forEach((e=>a.push(e))),t)return(0,s.jsx)(se.E,{annotationType:i,parentId:o,canDelete:t,inline:t,attachments:a,onViewAttachment:n});const c=(a||[]).reduce(((e,t)=>{const n=(0,R.rV)(t)?"viewable":"nonViewable";return e[n]=[...e[n],t],e}),{viewable:[],nonViewable:[]});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(se.E,{annotationType:i,parentId:o,canDelete:t,inline:t,attachments:c.viewable,onViewAttachment:n}),(0,s.jsx)(se.E,{annotationType:i,parentId:o,canDelete:t,inline:t,attachments:c.nonViewable,nonViewable:!0,onViewAttachment:n})]})}renderSmartEditor(){const{placeholder:e,hashtags:t,text:n,creating:i,textParser:o,active:r,maxLength:a,tabIndex:c,annotationType:l,onClickToEdit:d}=this.props,u=l===v.U.NOTE,h=this.inEmptyState()&&u&&!i?this.context.locale.t(Ee.CONTENT_DELETED):e;return(0,s.jsx)(ae.u,{ref:this.setTextEditorRef,textParser:o,text:n,active:!!r,clickToEdit:!!d,placeholder:h,onClickBlock:this.onClickBlock,onStartEditing:r?void 0:d,onDoneEditing:this.onDoneEditing,onCancelEditing:this.cancelEdits,onInput:this.onInput,tabIndex:c,maxLength:a,hashtags:t||[],userMentions:u})}render(){const{className:e,creating:t,active:n,parentId:i,parentType:o,annotationType:r,onClickToEdit:a,edited:c,title:l,maxLength:d}=this.props,{uploads:u,selectedBlock:h,charCount:p}=this.state,m=this.getAttachmentCount()<ne.iS,f=!(u.length>0)&&(n||t)&&m,g=r===v.U.NOTE,E=this.inEmptyState()&&!t&&g,x=!n&&c&&!E,_={annotating:n,"editor-box":n||!!a,"annotation-emptied":E,invalid:n&&!!d&&p>d};let T="",y="";return h&&h.blockType===Q.n.LINK&&(T=h.text,y=h.value||""),(0,s.jsxs)(re.y,{className:"annotation-box",onDropped:this.onDrop,disabled:!f,onActivate:this.dropActivated,children:[l,(0,s.jsxs)("div",{className:S()("annotation-text-box",_,e),children:[this.renderSmartEditor(),n&&this.renderAttachments(),n&&this.renderButtonBar(),n&&d&&d-p<50&&(0,s.jsx)(fe.w,{current:p,max:d})]}),x&&(0,s.jsx)("div",{className:"annotation-edited",children:"(edited)"}),!n&&!t&&this.renderAttachments(),n&&!!i&&(0,s.jsx)(me,{parentId:i,parentType:o,onEmbed:this.closeEmbedEditor,onCancel:this.closeEmbedEditor}),n&&!!i&&(0,s.jsx)(le.U,{linkText:T,linkUrl:y,onCancelLink:this.onCancelLink,onSaveLink:this.onSaveLink,onRemoveLink:this.onRemoveLink})]})}};xe.contextType=q.B,xe=ge([X.A,ve("design:paramtypes",[Object])],xe);var _e=n(43457),Te=n(42329),ye=n(87193),Ce=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Ae=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{INVITE_USER:Se,INVITE_BUTTON:be,INVITE_USERS:Oe,INVITE_VISIBLE_MSG:Ie}=de.A.USERS;let Re=class extends i.Component{constructor(e){super(e),this.onInviteUsers=()=>{this.props.onInviteUsers(this.props.invitees)}}render(){const{invitees:e}=this.props;if(0===e.length)return null;const{locale:t}=this.context;let n;const i=t.t(be,e.length);n=1===e.length?t.t(Se,{email:e[0]}):t.t(Oe,{emails:e.join(", ")});const o=t.t(Ie);return(0,s.jsxs)("div",{className:"user-invite-card",children:[(0,s.jsxs)("div",{className:"user-invite-info",children:[(0,s.jsx)("span",{className:"icon icon-eye-show"}),(0,s.jsx)("span",{className:"",children:o})]}),(0,s.jsx)("p",{className:"user-invite-msg",children:n}),(0,s.jsx)($.$,{onClick:this.onInviteUsers,variant:Y.A.TERTIARY,className:S()("button-inline","user-invite-button"),label:i})]})}};Re.contextType=q.B,Re=Ce([X.A,Ae("design:paramtypes",[Object])],Re);var Ne=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Le=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{INVITE_VISIBLE_MSG:ke,INVITE_USER_FAILED:we,INVITE_USERS_FAILED:je}=de.A.USERS;let Me=class extends i.Component{constructor(e){super(e)}render(){const{failedEmails:e}=this.props,{locale:t}=this.context;if(0===e.length)return null;let n;n=1===e.length?t.t(we,{email:e[0]}):t.t(je,{failedEmails:e.join(", ")});const i=t.t(ke);return(0,s.jsxs)("div",{className:"user-invite-card",children:[(0,s.jsxs)("div",{className:"user-invite-info",children:[(0,s.jsx)("span",{className:"icon icon-eye-show"}),(0,s.jsx)("span",{className:"",children:i})]}),(0,s.jsx)("p",{className:"user-invite-msg",children:n})]})}};Me.contextType=q.B,Me=Ne([X.A,Le("design:paramtypes",[Object])],Me);var Pe=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r};const{UNKNOWN_USER:De,UNKNOWN_USERS:He,INVITE_VISIBLE_MSG:Ue}=de.A.USERS;let Be=class extends i.Component{render(){const{locale:e}=this.context,{emails:t}=this.props;if(0===t.length)return null;let n;n=1===t.length?e.t(De,{email:t[0]}):e.t(He,{emails:t.join(", ")});const i=e.t(Ue);return(0,s.jsxs)("div",{className:"user-invite-card",children:[(0,s.jsxs)("div",{className:"user-invite-info",children:[(0,s.jsx)("span",{className:"icon icon-eye-show"}),(0,s.jsx)("span",{className:"",children:i})]}),(0,s.jsx)("p",{className:"user-invite-msg",children:n})]})}};Be.contextType=q.B,Be=Pe([X.A],Be);var Fe=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},Ve=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};let Ge=class extends i.Component{constructor(e){super(e),this.inviteUsers=async e=>{if(0===e.length)return;const{noteId:t,message:n}=this.props;await this.context.commandBinder.issueCommand(new Te.jl(e,n,C.NB,t))}}getInvitees(){const{userMentions:e}=this.props,t=[];return e.forEach((e=>{(e.userStatus===ye._.MENTIONED||e.userStatus===ye._.KNOWN&&e.modelAccess===P.OQ.PUBLIC)&&t.push(e.email)})),t}getFailedEmails(){const{userMentions:e}=this.props,t=[];return e.forEach((e=>{e.userStatus===ye._.FAILED&&t.push(e.email)})),t}render(){const{expires:e,noteId:t}=this.props;if((new Date).getTime()>e)return null;const{userData:n}=this.context,i=n.isInviter(),o=this.getInvitees(),r=this.getFailedEmails();return(0,s.jsxs)("div",{className:"user-mentions-unknown",children:[i&&o.length>0&&(0,s.jsx)(Re,{invitees:o,modelAccess:C.NB,noteId:t,onInviteUsers:this.inviteUsers}),!i&&o.length>0&&(0,s.jsx)(Be,{emails:o}),r.length>0&&(0,s.jsx)(Me,{failedEmails:r})]})}};Ge.contextType=q.B,Ge=Fe([X.A,Ve("design:paramtypes",[Object])],Ge);var We=n(5013);const{NOTES:Ke}=de.A.SHOWCASE;function Ye(e){const{comment:t,noteId:n,onCancel:o,onViewAttachment:c}=e,{user:l,created:d,edited:u,id:h,text:m}=t,g=(0,I.s)(),x=(0,p.L)(),T=(0,f.P)(),y=(0,We.M)(),A=(0,M.Y)(),b=(0,r.t)(),O=(0,a.O)(),R=(0,i.useRef)(null),N=(0,H.V)(),k=(0,U.b)(),w=(0,B.Y)(),j=(0,L.O)(),F=W(),V=D();if(!w||!N)return null;function G(e){g.trackToolGuiEvent("notes",e)}const X=j===h,q=t.attachments.values(),Q=!!y&&(0,E.q2)(T,y,v.U.NOTE,l),J=!!y&&(0,E.db)(T,y,v.U.NOTE,l),Z=t.modified.getTime()+60*C._d*1e3,ee=T.getUserDisplay(l.email),te=ee.color,ne=N.getPlainText(m),se=w.getCommentUserMentions(m,V),ie=!X&&(Q||J)?(0,s.jsxs)(K.y,{icon:"more-vert",variant:Y.A.TERTIARY,ariaLabel:A.t(de.A.MORE_OPTIONS),menuArrow:!0,menuClassName:"search-result-menu",menuPlacement:"bottom-end",children:[Q&&(0,s.jsx)($.$,{label:A.t(Ke.EDIT),size:Y.M.SMALL,variant:Y.A.TERTIARY,onClick:()=>{R.current&&(G("notes_click_edit_comment"),x.issueCommand(new _.lf(t.id)),R.current.edit())}}),J&&(0,s.jsx)($.$,{className:"menu-delete-btn",label:A.t(Ke.DELETE),size:Y.M.SMALL,variant:Y.A.TERTIARY,onClick:()=>{G("notes_click_delete_comment"),x.issueCommand(new _.IN(n,t.id))}})]}):null;return(0,s.jsxs)("div",{className:S()("comment",{active:X}),"data-id":h,children:[(0,s.jsxs)("div",{className:"note-header comment-header",children:[(0,s.jsx)(z.E,{badgeStyle:{color:te,borderColor:te},label:ee.initials}),(0,s.jsxs)("div",{className:"note-details",children:[(0,s.jsx)("span",{className:"note-user",children:ee.name}),(0,s.jsx)("div",{className:"note-subheader",children:d.toLocaleString()})]}),ie]}),Q?(0,s.jsx)(xe,{ref:R,textParser:N,linkHandler:k,annotationId:n,annotationType:v.U.NOTE,parentId:h,parentType:P.pi.COMMENT,attachments:q,active:X,edited:u,creating:!1,text:m,hashtags:F,toolPanelLayout:O,openModal:b,onViewAttachment:c,onDoneEditing:(e,s)=>{s?(G("notes_delete_empty_comment"),x.issueCommand(new _.IN(n,t.id)),o()):x.issueCommand(new _.er(n,t.id,e))},onCancelEditing:o,maxLength:C.u4}):(0,s.jsx)(_e.$,{text:m,textParser:N,linkHandler:k,annotationType:v.U.NOTE,annotationId:n,attachments:q,edited:u,onViewAttachment:c}),Q&&se.length>0&&(0,s.jsx)(Ge,{noteId:n,message:ne,userMentions:se,expires:Z})]})}const{NOTES:$e}=de.A.SHOWCASE;function ze({noteId:e,replyId:t,active:n,onCancel:i,onReply:o}){const c=(0,M.Y)(),l=(0,I.s)(),d=(0,p.L)(),u=(0,r.t)(),h=(0,a.O)(),m=(0,H.V)(),f=(0,U.b)(),g=W();if(!m)return null;return(0,s.jsx)(xe,{className:"reply-box",textParser:m,linkHandler:f,annotationType:v.U.NOTE,annotationId:e,parentType:P.pi.COMMENT,parentId:t,attachments:[],active:n,edited:!1,creating:!0,text:"",hashtags:g,toolPanelLayout:h,openModal:u,placeholder:c.t($e.REPLY_PLACEHOLDER),onClickToEdit:()=>{l.trackToolGuiEvent("notes","notes_click_new_comment"),d.issueCommand(new _.lf(t))},onDoneEditing:(e,n)=>{n?i():o(t,e)},onCancelEditing:i,maxLength:C.u4})}var Xe=n(79457),qe=n(55350);const{NOTES:Qe}=de.A.SHOWCASE;function Je({note:e,active:t,onCancelNote:n}){const i=(0,I.s)(),o=(0,p.L)(),r=(0,f.P)(),a=(0,h.g)(),c=(0,M.Y)(),l=e.comments.get(0);function d(e){i.trackToolGuiEvent("notes",e)}const u=(0,j.sG)(e),m=(0,j.zJ)(e),g=r.getUserDisplay(e.user.email),v=g.color,E=!a&&!t,x=E&&m,T=E&&!e.resolved,y=E&&e.resolved,C=!a&&(u||y||x)?(0,s.jsxs)(K.y,{icon:"more-vert",ariaLabel:c.t(de.A.MORE_OPTIONS),variant:Y.A.TERTIARY,menuArrow:!0,menuClassName:"search-result-menu",menuPlacement:"bottom-end",children:[u&&(0,s.jsx)($.$,{label:c.t(Qe.EDIT),size:Y.M.SMALL,variant:Y.A.TERTIARY,onClick:()=>{d("notes_click_edit_note"),l&&o.issueCommand(new _.lf(l.id))}}),y&&(0,s.jsx)($.$,{label:c.t(Qe.UNRESOLVE),size:Y.M.SMALL,variant:Y.A.TERTIARY,onClick:()=>{d("notes_click_unresolve_note"),o.issueCommand(new _.kr(e.id,!1))}}),x&&(0,s.jsx)($.$,{className:"menu-delete-btn",label:c.t(Qe.DELETE),size:Y.M.SMALL,variant:Y.A.TERTIARY,onClick:()=>{d("notes_click_delete_note"),o.issueCommand(new _.T0(e.id))}})]}):null,A=c.t(Qe.MARK_AS_RESOLVED);return(0,s.jsxs)("header",{className:"note-header",children:[(0,s.jsx)(z.E,{badgeStyle:{color:v,borderColor:v},label:g.initials}),(0,s.jsxs)("div",{className:"note-details",children:[(0,s.jsx)("span",{className:"note-user",children:g.name}),(0,s.jsx)("div",{className:"note-subheader",children:e.created.toLocaleString()})]}),(0,s.jsxs)(oe.e,{spacing:"small",children:[a&&(0,s.jsx)($.$,{icon:"close",tooltip:c.t(Qe.CANCEL),onClick:n,tooltipOptions:{placement:"bottom-end"}}),T&&(0,s.jsx)($.$,{icon:"checkmark",size:Y.M.SMALL,variant:Y.A.FAB,theme:"dark",tooltip:A,onClick:()=>{d("notes_click_resolve_note"),o.issueCommand(new _.kr(e.id,!0))}}),E&&(0,s.jsx)(qe.k,{prefix:"note",pin:e,id:e.id,darkTheme:!0,analyticAction:"copy_note_share_link",includeCameraView:!0}),C]})]})}const{NOTES:Ze}=de.A.SHOWCASE;function et({note:e,onViewAttachment:t,onCancel:n}){var o;const c=(0,p.L)(),l=(0,M.Y)(),d=(0,r.t)(),u=(0,a.O)(),g=(0,f.P)(),E=D(),x=(0,i.useRef)(null),T=(0,B.Y)(),y=(0,L.O)(),A=(0,h.g)(),S=W(),b=(0,H.V)(),O=(0,U.b)(),I=(0,j.sG)(e),R=e.comments.get(0),N=null==R?void 0:R.id,k=!!y&&(y===N||A),w=e.id,F=(0,i.useCallback)((()=>{x.current&&y===w&&x.current.edit()}),[y,w]);if((0,m.J)(Xe.wk,(()=>{A&&F()})),(0,i.useEffect)((()=>{k&&F()}),[k,F]),!T||!b)return null;const V=(null===(o=null==R?void 0:R.attachments)||void 0===o?void 0:o.values())||[],G=(null==R?void 0:R.text)||"",K=(null==R?void 0:R.edited)||!1,Y=(null==R?void 0:R.modified.getTime())+60*C._d*1e3,$=e.user.id===g.getCurrentUserId(),z=b.getPlainText(G),X=T.getCommentUserMentions(G,E),q=k?l.t(Ze.ADD_NOTE_MESSAGE):void 0;return(0,s.jsxs)("div",{className:"note-post",children:[(0,s.jsx)(Je,{note:e,active:k,onCancelNote:n}),I?(0,s.jsx)(xe,{ref:x,textParser:b,linkHandler:O,annotationId:w,annotationType:v.U.NOTE,parentId:N||w,parentType:P.pi.COMMENT,attachments:V,active:k,edited:K,creating:A,text:G,hashtags:S,placeholder:q,toolPanelLayout:u,openModal:d,onViewAttachment:t,onDoneEditing:async(e,t)=>{t?n():A?await c.issueCommand(new _.x7(e)):await c.issueCommand(new _.iT(w,e))},onCancelEditing:n,maxLength:C.KZ}):(0,s.jsx)(_e.$,{text:G,textParser:b,linkHandler:O,annotationType:v.U.NOTE,annotationId:w,attachments:V,edited:K,onViewAttachment:t}),!A&&R&&$&&X.length>0&&(0,s.jsx)(Ge,{message:z,noteId:w,expires:Y,userMentions:X})]})}function tt({note:e}){const t=(0,I.s)(),n=(0,O.j)(N.qy),o=(0,p.L)(),r=(0,L.O)(),a=(0,h.g)(),c=function(e){const t=(0,k.Z)(e),[n,s]=(0,i.useState)(w(t));return(0,i.useEffect)((()=>{if(!t)return()=>{};function e(){s(w(t))}const n=t.comments.onChanged(e);return e(),()=>{n.cancel()}}),[t]),n}(e.id),[l,d]=(0,i.useState)((0,b.D)(11)),u=()=>{o.issueCommand(new _.up)},m=e=>{if(c.length){t.trackToolGuiEvent("notes","notes_click_view_attachment");const s=c.filter((e=>(0,R.rV)(e)));s.length>0&&n.toggleAttachmentViewer(!0,s,e)}},f={annotating:!!r,creating:a},g=r===l,v=(0,j.Wu)(),E=!a&&v&&(g||!r);return(0,s.jsxs)("div",{className:S()("note-widget",f),children:[e&&(0,s.jsx)(et,{note:e,onViewAttachment:m,onCancel:()=>{a?o.issueCommand(new _.eg):r&&u()}}),!a&&(0,s.jsx)("div",{className:"note-comments",children:e.comments.map(((t,n)=>0===n?null:(0,s.jsx)(Ye,{noteId:e.id,comment:t,onCancel:u,onViewAttachment:m},t.id)))}),E&&(0,s.jsx)(ze,{replyId:l,noteId:e.id,active:g,onCancel:()=>{u(),d((0,b.D)(11))},onReply:(t,n)=>{o.issueCommand(new _.YC(e.id,n,t)),d((0,b.D)(11))}})]})}var nt=n(16947),st=n(11439),it=n(17084),ot=n(75200),rt=n(77201),at=n(22044);const ct=(0,rt.pw)(!1);function lt(e){ct.value=e}function dt(){return[(0,at.A)(ct),lt]}var ut=n(13893),ht=n(64695),pt=n(80700),mt=n(70401);function ft(e){const{analyticAction:t}=e,n=(0,I.s)(),i=(0,p.L)(),o=(0,ht.W)(),r=(0,d.r)(),a=(0,pt.e)(null==r?void 0:r.id),[c,l]=dt();if(!(r&&o.length>1))return null;const u=o.findIndex((e=>{const t=e.id,n=e.parentId;return n&&n===(null==r?void 0:r.id)&&(!a||t===(null==a?void 0:a.id))}));return(0,s.jsx)(mt.r,{index:u,total:o.length,disabled:c,wrapAround:!0,onNavigate:e=>{const s=o[e];if(!s)return;const a=s.id,c=s.parentId;if(!a||!c)return;l(!0);const d=r?null:ut.fl.Interpolate;n.trackToolGuiEvent("notes",t),i.issueCommand(new _.FV(c,!0,!1,a,d)).then((()=>{l(!1)}))}})}var gt=n(53473);const{NOTES:vt}=de.A.SHOWCASE;function Et(){const e=(0,L.O)(),t=(0,p.L)(),n=(0,M.Y)(),i=(0,c.k)(),r=(0,ot.c)(),[a]=dt(),l=i&&r&&(r===o.S0.SEARCH||r===o.S0.LAYERS),d=l||!i,u=!e&&!l,h=d?n.t(vt.NAV_BACK):n.t(vt.NAV_CLOSE),m=d?"back":"close";return(0,s.jsxs)("div",{className:"detail-panel-header",children:[(0,s.jsx)(gt.J,{icon:m,label:h,onClose:()=>{a||(l?t.issueCommand(new it.kC).then((()=>{t.issueCommand(new it.oe(!1))})):i?t.issueCommand(new it.u3(o.S0.NOTES)):t.issueCommand(new _.sL))}}),u&&(0,s.jsx)(ft,{analyticAction:"notes_navigate_in_panel"})]})}function xt({panelOpen:e,note:t}){const n=(0,p.L)(),r=(0,f.P)(),c=(0,We.M)(),l=(0,a.O)(),d=(0,i.useRef)(null),u=(0,y.m)(),A=(0,h.g)(),S=null==t?void 0:t.id;(0,m.J)(x.F,(e=>{d.current&&d.current.scrollToSelector(`[data-id='${e.commentId}']`)})),(0,i.useEffect)((()=>{d.current&&S&&d.current.resetScrollTop()}),[S]);const b=!!(t&&r&&c)&&(0,E.q2)(r,c,v.U.NOTE,t.user),O=u===T.f.EDITING,I=l===o.L$.BOTTOM_PANEL,R=O&&I;return(0,s.jsxs)(nt.q,{ref:d,open:e,className:"note-panel",scrollingDisabled:R,onClose:()=>{n.issueCommand(new _.sL)},children:[t&&!A&&(0,s.jsx)(Et,{}),t&&(0,s.jsx)(tt,{note:t}),t&&S&&I&&b&&(0,s.jsx)(st.n,{id:S,pin:t,pinType:g.yY.NOTE,onSave:e=>{S&&n.issueCommand(new _.Xc(S,e))},onClose:()=>{n.issueCommand(new _.dz(!1))},colors:C.Ay.colors,open:O,toolPanelLayout:l},S)]})}var _t=n(13397),Tt=n(12468),yt=n(70967),Ct=n(3184),At=n(15900);n(80164);const{NOTES:St}=de.A.SHOWCASE;function bt(){const e=(0,M.Y)(),t=(0,yt.X)(),n=(0,i.useRef)(null);return(0,s.jsx)("div",{className:"search-filter",children:(0,s.jsxs)(K.y,{ref:n,icon:"filter",ariaLabel:e.t(St.FILTER),variant:Y.A.TERTIARY,size:Y.M.SMALL,menuClassName:"search-filter-menu",children:[(0,s.jsxs)("div",{className:"search-filter-menu-header",children:[(0,s.jsx)("div",{children:e.t(St.FILTER_BY)}),(0,s.jsx)(gt.J,{onClose:()=>{n.current&&n.current.closeMenu()}})]}),(0,s.jsx)(Ot,{id:Ct.S.ALL,label:e.t(St.FILTER_ALL),selected:t===Ct.S.ALL},Ct.S.ALL),(0,s.jsx)(Ot,{id:Ct.S.OPEN,label:e.t(St.FILTER_UNRESOLVED),selected:t===Ct.S.OPEN},Ct.S.OPEN),(0,s.jsx)(Ot,{id:Ct.S.RESOLVED,label:e.t(St.FILTER_RESOLVED),selected:t===Ct.S.RESOLVED},Ct.S.RESOLVED)]})})}function Ot({id:e,label:t,selected:n}){const i=(0,I.s)(),o=(0,p.L)();return(0,s.jsx)(At.M,{id:e,label:t,selected:n,onToggled:()=>{n||(i.trackToolGuiEvent("notes","notes_list_change_filter"),o.issueCommand(new _.$l(e,!0)))}})}var It=n(48928);const{NOTES:Rt}=de.A.SHOWCASE;function Nt({children:e,title:t,hideBadge:n}){const i=(0,M.Y)(),r=(0,_t.e)(),a=(0,ht.W)().length,c=(0,s.jsx)(It.M,{filter:(0,s.jsx)(bt,{})}),l=t||i.t(r?Rt.COMMENTS:Rt.NOTES,a);return(0,s.jsx)(Tt.h,{toolId:o.S0.NOTES,className:"notes-list-panel",title:l,subheader:c,hideBadge:n,children:e})}function Lt({children:e,title:t,hideBadge:n}){const p=(0,r.t)(),m=(0,a.O)(),f=(0,c.k)(),g=(0,d.r)(),v=function(){const e=(0,d.r)(),t=(0,u.X)();return(null==e?void 0:e.id)===(null==t?void 0:t.id)?e:null}(),E=(0,h.g)(),[x,_]=(0,i.useState)(v),T=f;(0,i.useEffect)((()=>{g&&(null==g?void 0:g.id)!==(null==x?void 0:x.id)&&_(g)}),[null==x?void 0:x.id,g,null==g?void 0:g.id]);const y=E?v:g,C=m===o.L$.BOTTOM_PANEL,A=p&&p!==l.a.CONFIRM,S=!(!y||C&&A);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(xt,{panelOpen:S,note:y||x}),!T&&(0,s.jsx)(Nt,{title:t,hideBadge:n,children:e})]})}},70466:(e,t,n)=>{"use strict";n.d(t,{g:()=>o});var s=n(87805),i=n(78450);const o=(0,s.u)(i.b,"isNewNote",!1)},14326:(e,t,n)=>{"use strict";n.d(t,{O:()=>o});var s=n(96540),i=n(93388);function o(){const e=(0,i.Y)(),[t,n]=(0,s.useState)((null==e?void 0:e.activeNotation)||null);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onActiveNotationChanged(n);return()=>t.cancel()}),[e]),t}},70967:(e,t,n)=>{"use strict";n.d(t,{X:()=>r});var s=n(96540),i=n(93388),o=n(3184);function r(){const e=(0,i.Y)(),[t,n]=(0,s.useState)((null==e?void 0:e.notesFilter)||o.S.OPEN);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onNotesFilterChanged(n);return()=>t.cancel()}),[e]),t}},98378:(e,t,n)=>{"use strict";n.d(t,{m:()=>r});var s=n(96540),i=n(93388),o=n(89416);function r(){const e=(0,i.Y)(),[t,n]=(0,s.useState)((null==e?void 0:e.notesPhase)||o.f.CLOSED);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onNotesPhaseChanged(n);return n(e.notesPhase),()=>t.cancel()}),[e]),t}},35517:(e,t,n)=>{"use strict";n.d(t,{Wu:()=>l,kc:()=>c,sG:()=>d,zJ:()=>u});var s=n(5013),i=n(53641),o=n(25296),r=n(54616),a=n(51831);function c(){const e=(0,s.M)();return!!e&&e.hasPolicy(i.tG)}function l(){const e=(0,s.M)();return!!e&&e.hasPolicy(i.O7)}function d(e){const t=(0,s.M)(),n=(0,r.P)();return!!t&&!!e&&(0,o.q2)(n,t,a.U.NOTE,null==e?void 0:e.user)}function u(e){const t=(0,s.M)(),n=(0,r.P)();return!!t&&!!e&&(0,o.db)(n,t,a.U.NOTE,null==e?void 0:e.user)}},20263:(e,t,n)=>{"use strict";n.d(t,{r:()=>o});var s=n(96540),i=n(93388);function o(){const e=(0,i.Y)(),[t,n]=(0,s.useState)(e?e.openNoteView:null);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onOpenNoteViewChanged(n);return n(e.openNoteView),()=>t.cancel()}),[e]),t}(0,n(61260).c)("openNoteView",o)},58972:(e,t,n)=>{"use strict";n.d(t,{F:()=>o,a:()=>i});var s=n(77201);class i extends s.QB{constructor(e,t){super(),this.id=e,this.resolved=t}}class o extends s.QB{constructor(e){super(),this.commentId=e}}},92116:(e,t,n)=>{"use strict";n.d(t,{B:()=>s});const s=Object.freeze({pink:"#f78da7",plum:"#9c4b92",purple:"#673ab7",teal:"#03687d",cerulean:"#03a9f4",ocean:"#00bcd4",fog:"#abb8c3",iron:"#607d8b",forest:"#417505",emerald:"#51a868",mint:"#37d67a",lime:"#cddc39",canary:"#fbcd00",sunflower:"#ffac17",tangerine:"#ff6900",sunset:"#f44336",sierra:"#d44441",magenta:"#e91e63"})},11439:(e,t,n)=>{"use strict";n.d(t,{n:()=>E});var s=n(74848),i=n(96540),o=n(72909),r=n(32485),a=n.n(r),c=n(77570),l=n(33699),d=n(73566),u=n(53473),h=n(63185),p=n(56500),m=n(56147),f=function(e,t,n,s){var i,o=arguments.length,r=o<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,n):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,s);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(o<3?i(r):o>3?i(t,n,r):i(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},g=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};const{PINS:v}=m.A.WORKSHOP;let E=class extends i.Component{constructor(e){super(e),this.closePinAssetEditor=()=>{this.props.onClose()},this.handleColorPicked=e=>{this.context.analytics.trackGuiEvent("pin_change_color"),this.props.onSave({color:e})},this.saveStemEnabled=e=>{this.context.analytics.trackGuiEvent(e?"pin_show_stem":"pin_hide_stem"),this.props.onSave({stemEnabled:e})},this.saveStemLength=e=>{this.context.analytics.trackGuiEvent("pin_change_stem_height"),this.props.onSave({stemLength:e})},this.previewStemLength=e=>{const{id:t,pinType:n}=this.props;this.context.commandBinder.issueCommand(new l.gx(t,n,{stemLength:e}))},this.stopPropagation=e=>{e.stopPropagation()}}renderStemEditor(){const{pin:e}=this.props;return(0,s.jsx)(p.n,{stemLength:e.stemLength,stemEnabled:e.stemEnabled,onLengthUpdate:this.previewStemLength,onLengthChanged:this.saveStemLength,onStemEnabledChanged:this.saveStemEnabled})}render(){const{toolPanelLayout:e,open:t,pin:n,colors:i}=this.props,o=e===d.L$.BOTTOM_PANEL;if(!t&&!o)return null;const r=this.context.locale.t(v.COLOR_STEM_EDITOR_TITLE);return(0,s.jsxs)("div",{className:a()("pin-tool-editor",{"tool-popup":!o,open:o&&t}),onClick:this.stopPropagation,children:[(0,s.jsxs)("div",{className:"tool-editor-title",children:[(0,s.jsx)("span",{children:r}),(0,s.jsx)(u.J,{theme:"dark",tooltip:"",onClose:this.closePinAssetEditor})]}),(0,s.jsx)(h.s,{colors:i,defaultColor:n.color,onColorPicked:this.handleColorPicked}),this.renderStemEditor()]})}};E.contextType=c.B,E=f([o.A,g("design:paramtypes",[Object])],E)},94413:(e,t,n)=>{"use strict";n.d(t,{W:()=>o});var s=n(96540),i=n(93216);function o(){const e=(0,i.d)(),[t,n]=(0,s.useState)(!!e&&e.canAdd);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onCanAddChanged(n);return n(e.canAdd),()=>t.cancel()}),[e]),t}},40145:(e,t,n)=>{"use strict";n.d(t,{w:()=>o});var s=n(96540),i=n(93216);function o(){const e=(0,i.d)(),[t,n]=(0,s.useState)(!!e&&e.canPlace);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onCanPlaceChanged(n);return n(e.canPlace),()=>t.cancel()}),[e]),t}},89002:(e,t,n)=>{"use strict";n.d(t,{f:()=>r});var s=n(96540),i=n(93216),o=n(25727);function r(){const e=(0,i.d)(),[t,n]=(0,s.useState)(e?e.pinEditorState:o.ce.IDLE);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onPinEditorStateChanged(n);return()=>t.cancel()}),[e]),t}},47013:(e,t,n)=>{"use strict";n.d(t,{E:()=>o});var s=n(96540),i=n(93216);function o(){const e=(0,i.d)(),[t,n]=(0,s.useState)((null==e?void 0:e.progress)||0);return(0,s.useEffect)((()=>{if(!e)return()=>{};const t=e.onProgressChanged(n);return n(e.progress),()=>t.cancel()}),[e]),t}},72667:(e,t,n)=>{"use strict";n.d(t,{z:()=>a});var s=n(96540),i=n(39869),o=n(51469),r=n(30169);function a(e){const t=(0,o.N)(),n=(0,i.Y)(),[a,c]=(0,s.useState)((0,r.Ay)(e,n,t));return(0,s.useEffect)((()=>{if(!t)return()=>{};function s(){c((0,r.Ay)(e,n,t))}const i=t.onRoomsChanged({onUpdated:s});return s(),()=>i.cancel()}),[n,t,e]),a}},67679:(e,t,n)=>{"use strict";n.d(t,{N:()=>l});var s=n(74848),i=n(16112),o=n(13397),r=n(39869);function a({dataTypeGroup:e}){return e.groupActionsFC?(0,s.jsx)(e.groupActionsFC,{group:e}):null}var c=n(16164);function l(e){const{id:t,numItems:n,numSelected:l,selected:d,selectDisabled:u,selectMode:h,onSelect:p}=e,m=(0,i.f)(""),f=(0,o.e)(),g=(0,r.Y)(),v=m[t];if(!v)return null;const E=f&&v.groupMatchingPhraseKey||v.groupPhraseKey,x=E?g.t(E):t;let _;if(void 0!==n){const e=h?`${l}/${n}`:`${n}`;_=(0,s.jsx)("span",{className:"mp-list-item-text",children:`(${e})`})}return(0,s.jsx)(c.u,{id:t,title:x,decals:_,actions:(0,s.jsx)(a,{dataTypeGroup:v}),selectMode:h,selectDisabled:u,selected:d,onSelect:p})}},54011:(e,t,n)=>{"use strict";n.d(t,{v:()=>r});var s=n(74848),i=n(39869),o=n(16164);function r(e){const{id:t,numItems:n,numSelected:r,selected:a,selectMode:c,onSelect:l}=e,d=(0,i.Y)().t(`SHOWCASE.NOTES.${t}`);let u;if(void 0!==n){const e=c?`${r}/${n}`:`${n}`;u=(0,s.jsx)("span",{className:"mp-list-item-text",children:`(${e})`})}return(0,s.jsx)(o.u,{id:t,title:d,decals:u,selectMode:c,selected:a,onSelect:l})}},53963:(e,t,n)=>{"use strict";n.d(t,{og:()=>L,ic:()=>j,r2:()=>k,ex:()=>P,mk:()=>w,dS:()=>M});var s=n(74848),i=n(96540),o=n(36981),r=n(56147),a=n(39869),c=n(38731),l=n(53289),d=n(64695),u=n(84917);var h=n(27817),p=n(93877),m=n(48198),f=n(50659),g=n(2716),v=n(93369);function E(e=!0){return x((0,d.W)(),function(){const e=[];for(const t in u.T)e.push({id:t});const[t]=(0,i.useState)(e);return t}(),p.Hj.DATE,e)}function x(e,t,n,s){const o=(0,h.w)(),[r,a]=(0,i.useState)([]);return(0,i.useEffect)((()=>{if(!o)return()=>{};const i=t.reduce(((e,t,s)=>Object.assign(Object.assign({},e),{[t.id]:{id:t.id,grouping:n,groupOrder:s,items:[],batchSupported:!0}})),{}),r={};e.forEach((e=>{const t=e.getGroupingId(n);if(t&&i[t])t&&i[t].items.push(e);else{const t=e.getGroupingId(p.Hj.TYPE);if(t){const n=o.getSearchDataTypeGroup(t);r[t]||(r[t]={id:t,grouping:p.Hj.TYPE,groupOrder:(0,v.E)(o,t,p.Hj.TYPE),items:[],batchSupported:n.batchSupported}),r[t].items.push(e)}}}));let c=Object.values(i);return s&&(c=c.filter((e=>e.items.length>0))),a(c.concat(Object.values(r))),()=>{}}),[o,e,t,n,s]),r}var _=n(16112),T=n(95072);var y=n(74481),C=n(78115),A=n(58024),S=n(30576),b=n(76236),O=n(45314);const{SEARCH:I}=r.A.SHOWCASE,R=({group:e})=>{const t=(0,a.Y)().t(I.EMPTY_LIST_MESSAGE);return(0,s.jsx)(O.t,{message:t})};var N=n(49138);const L=60;function k(e){const{excludeEmptyGroups:t}=e,n=function(e=!0){const t=(0,m.y)();return x((0,d.W)(),t,p.Hj.FLOOR,e)}(t);return(0,s.jsx)(D,Object.assign({},e,{dataGroups:n}))}function w(e){const{excludeEmptyGroups:t}=e,n=function(e=!0){const t=(0,f.N)();return x((0,d.W)(),t,p.Hj.ROOM,e)}(t);return(0,s.jsx)(D,Object.assign({},e,{dataGroups:n}))}function j(e){const{excludeEmptyGroups:t}=e,n=E(t);return(0,s.jsx)(D,Object.assign({},e,{dataGroups:n}))}function M(e){const{excludeEmptyGroups:t}=e,n=(0,i.useContext)(N.o),o=function(e,t=!0){const n=(0,_.f)(e),s=Object.values(n).sort(((e,t)=>(e.groupOrder||T.X$)-(t.groupOrder||T.X$))).map((e=>({id:e.id,grouping:p.Hj.TYPE,groupOrder:e.groupOrder||T.X$,items:e.matches,batchSupported:e.batchSupported})));return t?s.filter((e=>e.items.length>0)):s}((null==n?void 0:n.sourceViewId)||"",t);return(0,s.jsx)(D,Object.assign({},e,{dataGroups:o}))}function P(e){const{excludeEmptyGroups:t}=e,n=(0,c.B)(),{includeInMemory:r}=(0,i.useContext)(o.b),a=function(e=!0,t=!1){const n=(0,g.z)(t);return x((0,d.W)(),n,p.Hj.LAYER,e)}(t,!r),u=(0,A.z0)(),h=n&&(null==u?void 0:u.id)||void 0,[m,f]=(0,i.useState)(void 0),v=(0,i.useCallback)((()=>{f(void 0)}),[]);return(0,l.J)(C.V7,(({layerId:e})=>{f(e)})),(0,s.jsx)(D,Object.assign({},e,{dataGroups:a,activeGroupId:h,scrollToGroupId:m,onScrolled:v}))}function D(e){const{renderGroup:t,renderItem:n,dataGroups:o,activeItemId:c,activeGroupId:l,scrollToGroupId:d,onScrolled:u,collapseWhenNotSearching:h}=e,p=(0,i.useRef)(null),m=(0,y.M)(),f=(0,i.useRef)(void 0),g=(0,a.Y)(),v=(0,S.XW)(),[E,x]=(0,i.useState)({}),[_,T]=(0,i.useState)(!m&&h),C=(0,i.useCallback)(((e,t)=>{x(Object.assign(Object.assign({},E),{[e]:t}))}),[E]);(0,i.useEffect)((()=>(window.clearTimeout(f.current),m?(f.current=window.setTimeout((()=>{x({}),T(!1)}),300),()=>{window.clearTimeout(f.current)}):(x({}),T(h),()=>{}))),[m,x,T,h]),(0,i.useEffect)((()=>{var e;if(!d)return;(null===(e=p.current)||void 0===e?void 0:e.scrollIntoView(`[data-id='${d}']`))&&(null==u||u())}),[d,u]),(0,i.useEffect)((()=>{var e;if(c){let t=-1;const n=null===(e=o.find((e=>{const n=e.items.findIndex((e=>e.id===c));return-1!==n&&(t=n,!0)})))||void 0===e?void 0:e.id;p.current&&n&&p.current.focusGroupItem(n,t)}return()=>{}}),[o,c,p]);const A="aura"===v?44:60;return(0,s.jsx)(b.n,{ref:p,ariaExpandLabel:g.t(r.A.ACCORDIONS.EXPAND),ariaCollapseLabel:g.t(r.A.ACCORDIONS.COLLAPSE),data:o,itemHeight:A,renderItem:n,renderGroup:t,renderEmpty:R,onToggleCollapse:C,collapsedIds:E,activeGroupId:l,collapseEmptyGroups:o.length>1,defaultCollapsed:_})}},49138:(e,t,n)=>{"use strict";n.d(t,{o:()=>s});const s=(0,n(96540).createContext)(null)},37924:(e,t,n)=>{"use strict";n.d(t,{$:()=>_});var s=n(74848),i=n(96540),o=n(56147),r=n(39869),a=n(16112),c=n(75410),l=n(95072),d=n(88503),u=n(48270),h=n(53473),p=n(28479),m=n(94547),f=n(15900),g=n(90087),v=n(68375);function E({id:e,icon:t,label:n,selected:i}){const o=(0,v.s)(),r=(0,g.L)(),a=(0,p.L)();return(0,s.jsx)(f.M,{id:e,icon:t,label:n,selected:i,onToggled:t=>{t.stopPropagation(),"ALL"===e?i||r.issueCommand(new m._d):r.issueCommand(new m._w(e,!i)),i||o.trackGuiEvent(`items_filter_by_${e.toLowerCase()}`,{tool:a})}})}n(80164);const{SEARCH:x}=o.A.SHOWCASE;function _(){const e=(0,r.Y)(),t=Object.values((0,a.f)("")),n=(0,c.h)(),o=0===n.length,p=(0,i.useRef)(null),m=t.sort(((e,t)=>(e.groupOrder||l.X$)-(t.groupOrder||l.X$))).map((t=>{const{id:i,groupIcon:r,groupPhraseKey:a}=t,c=e.t(a),l=!o&&n.includes(i);return(0,s.jsx)(E,{id:i,icon:r,label:c,selected:l},i)})),f=e.t(x.FILTER_SEARCH),g=e.t(x.FILTER_SEARCH_ALL);return(0,s.jsx)("div",{className:"search-filter",onClick:e=>e.stopPropagation(),children:(0,s.jsxs)(d.y,{ariaLabel:e.t(x.FILTER_SEARCH_LABEL),ref:p,icon:"filter",variant:u.A.TERTIARY,size:u.M.SMALL,menuClassName:"search-filter-menu",children:[(0,s.jsxs)("div",{className:"search-filter-menu-header",children:[(0,s.jsx)("div",{children:f}),(0,s.jsx)(h.J,{onClose:()=>{p.current&&p.current.closeMenu()}})]}),(0,s.jsx)(E,{id:"ALL",icon:"fullscreen",label:g,selected:o}),m]})})}},15900:(e,t,n)=>{"use strict";n.d(t,{M:()=>l});var s=n(74848),i=n(39869),o=n(56147),r=n(17605),a=n(48270),c=n(93137);function l({id:e,icon:t,label:n,selected:l,onToggled:d}){const u=(0,i.Y)();return(0,s.jsx)(r.$,{icon:t,label:n,ariaLabel:l?u.t(o.A.SHOWCASE.SEARCH.FILTER_SEARCH_SELECTED):n,size:a.M.SMALL,variant:a.A.TERTIARY,onClick:d,appendChildren:!1,children:(0,s.jsx)("div",{className:"search-filter-selected",children:l&&(0,s.jsx)(c.I,{name:"checkmark"})})},e)}},99663:(e,t,n)=>{"use strict";n.d(t,{$:()=>v});var s=n(74848),i=n(56147),o=n(39869),r=n(87805),a=n(78849);const c=(0,r.u)(a.L,"searchMode",!1);var l=n(28479),d=n(78379),u=n(93877),h=n(88503),p=n(48270),m=n(17605),f=n(68375);const{SEARCH:g}=i.A.SHOWCASE;function v({phraseKeys:e={},grouping:t,onGroupBy:n}){const i=(0,o.Y)(),r=(0,d.S)(),a=c(),l=[u.Hj.DATE,u.Hj.FLOOR];"boolean"==typeof a&&l.unshift(u.Hj.TYPE),r&&l.push(u.Hj.LAYER);const m=i.t(x(t,!0,e));return(0,s.jsx)(h.y,{className:"grouping-sort-menu-button",ariaLabel:m,variant:p.A.TERTIARY,label:m,caret:!0,children:l.map((t=>(0,s.jsx)(E,{onGroupBy:n,grouping:t,phraseKeys:e},t)))})}function E({grouping:e,onGroupBy:t,phraseKeys:n={}}){const i=(0,f.s)(),r=(0,o.Y)().t(x(e,!1,n)),a=(0,l.L)();return(0,s.jsx)(m.$,{label:r,size:p.M.SMALL,variant:p.A.TERTIARY,onClick:()=>{t(e),i.trackGuiEvent(`items_group_by_${e}`,{tool:a})}},e)}function x(e,t,n){var s,i,o,r,a,c,l,d,h,p;switch(e){case u.Hj.TYPE:return t?(null===(s=n[u.Hj.TYPE])||void 0===s?void 0:s.selectedTextKey)||g.GROUP_TYPE_SELECTED:(null===(i=n[u.Hj.TYPE])||void 0===i?void 0:i.textKey)||g.GROUP_TYPE;case u.Hj.FLOOR:return t?(null===(o=n[u.Hj.FLOOR])||void 0===o?void 0:o.selectedTextKey)||g.GROUP_FLOOR_SELECTED:(null===(r=n[u.Hj.FLOOR])||void 0===r?void 0:r.textKey)||g.GROUP_FLOOR;case u.Hj.ROOM:return t?(null===(a=n[u.Hj.ROOM])||void 0===a?void 0:a.selectedTextKey)||g.GROUP_ROOM_SELECTED:(null===(c=n[u.Hj.ROOM])||void 0===c?void 0:c.textKey)||g.GROUP_ROOM;case u.Hj.LAYER:return t?(null===(l=n[u.Hj.LAYER])||void 0===l?void 0:l.selectedTextKey)||g.GROUP_LAYER_SELECTED:(null===(d=n[u.Hj.LAYER])||void 0===d?void 0:d.textKey)||g.GROUP_LAYER;case u.Hj.DATE:default:return t?(null===(h=n[u.Hj.DATE])||void 0===h?void 0:h.selectedTextKey)||g.GROUP_DATE_SELECTED:(null===(p=n[u.Hj.DATE])||void 0===p?void 0:p.textKey)||g.GROUP_DATE}}},62182:(e,t,n)=>{"use strict";n.d(t,{e:()=>m});var s=n(74848),i=n(56147),o=n(39869),r=n(1494),a=n(94547),c=n(17605),l=n(48270),d=n(90087);const{WORKSHOP:u,HIDE:h,SHOW:p}=i.A;function m({item:e,onToggle:t}){const n=(0,d.L)(),i=(0,o.Y)(),{enabled:m,id:f,typeId:g}=e,v=!e.isLayerVisible(),E=!m||v?"eye-hide":"eye-show",x=(0,r.H)(),_=v?i.t(u.LAYERS.HIDDEN_LAYER_ITEM_TOOLTIP):m?i.t(h):i.t(p);return(0,s.jsx)(c.$,{icon:E,dimmed:!m,variant:l.A.TERTIARY,onClick:e=>{e.stopPropagation(),v||(m&&x===f&&n.issueCommand(new a.Xx(null,g)),t(!m))},tooltip:_})}},82198:(e,t,n)=>{"use strict";n.d(t,{x:()=>v});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(56147),c=n(39869),l=n(93877),d=n(74481),u=n(64695),h=n(53963),p=n(53289),m=n(78115);var f=n(45314);const{SEARCH:g}=a.A.SHOWCASE;function v(e){const{excludeEmptyGroups:t,activeItemId:n,grouping:o,emptyPhrase:a,collapseWhenNotSearching:v=!1}=e,E=(0,i.useRef)(null),x=(0,c.Y)(),_=(0,d.M)(),T=(0,u.W)(),y=function(){const[e,t]=(0,i.useState)(!1),n=(0,i.useCallback)((e=>()=>t(e)),[]);return(0,p.J)(m.MT,n(!0)),(0,p.J)(m.tj,n(!1)),e}(),C=0===T.length,A=o===l.Hj.FLOOR,S=o===l.Hj.ROOM,b=o===l.Hj.LAYER,O=o===l.Hj.DATE,I=void 0!==t?t:_,R=x.t(a||g.EMPTY_LIST_MESSAGE),N=!!I&&C,L=Object.assign(Object.assign({},e),{scrollRef:null==E?void 0:E.current,excludeEmptyGroups:I,activeItemId:n,collapseWhenNotSearching:v});return N?(0,s.jsx)(f.t,{message:R}):(0,s.jsxs)("div",{className:r()("list-contents","searchable-list",{pending:y}),ref:E,children:[A?(0,s.jsx)(h.r2,Object.assign({},L)):S?(0,s.jsx)(h.mk,Object.assign({},L)):b?(0,s.jsx)(h.ex,Object.assign({},L)):O?(0,s.jsx)(h.ic,Object.assign({},L)):(0,s.jsx)(h.dS,Object.assign({},L)),e.children]})}},17337:(e,t,n)=>{"use strict";n.d(t,{f:()=>r});var s=n(74848),i=n(87912),o=n(48463);function r({item:e}){const{imgUrl:t,color:n,icon:r}=e,a={"--badge-color":n};return t?(0,s.jsx)(i.q,{className:"thumbnail-image",resource:t}):r?(0,s.jsx)(o.E,{badgeStyle:void 0!==n?a:{},iconClass:r}):null}},53223:(e,t,n)=>{"use strict";n.d(t,{$:()=>a});var s=n(74848),i=n(13397),o=n(95143),r=n(55666);function a({item:e}){const{textParser:t,title:n,description:a}=e,c=(0,i.e)();let l=n;l&&(l=(0,o.x8)(l,c));let d=a;return d&&(d=(0,o.A_)(d,c)),(0,s.jsxs)("div",{className:"item-details",children:[(0,s.jsx)("div",{className:"item-header",children:(0,s.jsx)(r.L,{text:l||"",textParser:t,markers:o.S8})}),t&&(0,s.jsx)("div",{className:"item-description",children:(0,s.jsx)(r.L,{text:d||"",textParser:t,markers:o.S8})})]})}},41622:(e,t,n)=>{"use strict";n.d(t,{P:()=>_});var s=n(74848),i=n(26868),o=n(56023),r=n(96540),a=n(39869),c=n(27817);const l=(e,t)=>Number(t.isSelected)-Number(e.isSelected)||e.text.localeCompare(t.text),d={fixtures:"KEYWORDS_FIXTURES"};function u(){const e=(0,a.Y)(),t=function(){const e=(0,c.w)(),[t,n]=(0,r.useState)((null==e?void 0:e.getKeywordSummaries())||[]);return(0,r.useEffect)((()=>{if(!e)return()=>{};function t(){e&&n(e.getKeywordSummaries())}const s=e.keywordCounts.onChanged(t),i=e.keywordFilters.onChanged(t);return t(),()=>{s.cancel(),i.cancel()}}),[e]),t}();return(0,r.useMemo)((()=>t.map((t=>Object.assign(Object.assign({},t),{text:d[t.id]?e.t(d[t.id]):t.text}))).sort(l)),[t,e])}var h=n(94547);const p=()=>{const e=u(),t=(0,o.D)(h.$M,(e=>[e.id]));return(0,s.jsx)(i.c,{className:"search-keyword-summary",tokens:e,onTokenClick:t,maxVisibleTruncated:5,allowSelect:!0})};var m=n(87137),f=n(77897),g=n(73566),v=n(64057),E=n(78956),x=n(68419);function _(){const e=(0,v.J)(),t=(0,E.O)(),n=t===g.L$.NARROW||t===g.L$.BOTTOM_PANEL,i=!e&&t===g.L$.BOTTOM_PANEL;return(0,x.t)()&&i?null:(0,s.jsx)("div",{className:"search-tool-overlay",children:n?(0,s.jsx)(m.A,{direction:f.OP.horizontal,children:(0,s.jsx)(p,{})}):(0,s.jsx)(p,{})})}},48928:(e,t,n)=>{"use strict";n.d(t,{M:()=>U});var s=n(74848),i=n(96540),o=n(32485),r=n.n(o),a=n(56147),c=n(73566),l=n(17084),d=n(78956),u=n(64057),h=n(39869),p=n(97800),m=n(12103),f=n(13397),g=n(59475),v=n(75410),E=n(94547),x=n(81609),_=n(66726),T=n(17605),y=n(48270),C=n(35404),A=n(68375),S=n(38731),b=n(50747);function O(e){const{query:t,keywordFilters:n,typeFilters:o}=e,r=(0,S.B)(),c=(0,h.Y)(),l=(0,b.F)(),d=(0,A.s)(),[u,p]=(0,i.useState)(!1),m=r||l.tryGetSetting(C.wD,!1),f=(0,i.useCallback)((()=>{const e=(0,_.Cz)(t,n,o);(0,x.l)(e),p(!0);const s=r?"workshop_gui":"showcase_gui";d.track(s,{gui_action:"space_search_share_link_clicked"})}),[t,n,o,r,d]);return(0,i.useEffect)((()=>{if(!u)return()=>{};const e=window.setTimeout((()=>p(!1)),2500);return()=>window.clearTimeout(e)}),[u]),m?u?(0,s.jsx)("span",{className:"link-copied",children:c.t(a.A.SHARE_COPIED)}):(0,s.jsx)(T.$,{onClick:f,icon:"share",variant:y.A.TERTIARY,tooltip:c.t(a.A.COPY_URL)}):null}var I=n(30576),R=n(63220),N=n(71188),L=n(78197),k=n(90087);const{SEARCH:w}=a.A.SHOWCASE;function j({filter:e,readOnly:t,shareEnabled:n}){const o=(0,k.L)(),a=(0,i.useRef)(null),x=(0,i.useRef)(null),_=(0,h.Y)(),C=(0,d.O)(),A=(0,u.J)(),S=(0,f.e)(),b=(0,g.e)(),j=(0,v.h)(),M=(0,i.useMemo)((()=>(0,p.C8)()),[]),P=C===c.L$.BOTTOM_PANEL&&A,D=(0,N.w)((0,L.A)()),H=(0,I.bt)("search-panel-header"),U=(0,i.useCallback)((e=>{o.issueCommand(new E.tA(e))}),[o]),B=_.t(w.SEARCH_IN_TOOL_PLACEHOLDER),F=_.t(w.CLEAR_SEARCH).toLocaleUpperCase(),V=b.length>0||j.length>0||""!==S,G=n&&V,W=M?void 0:m.JO;return(0,s.jsxs)("div",{ref:x,className:r()("list-search","search-panel-header",H),children:[(0,s.jsxs)("div",{className:"search-bar",children:[(0,s.jsx)("span",{className:r()("search-header-icon","icon","icon-magnifying-glass",{"search-header-icon-active":V})}),(0,s.jsx)(R.A,{text:S,onInput:U,onDone:e=>{P&&e&&o.issueCommand(new l.li(!1))},onCancel:()=>{o.issueCommand(new l.Te)},placeholder:B,onFocus:()=>{D&&P&&M&&(o.issueCommand(new l.li(!1)),window.setTimeout((()=>{x.current&&x.current.scrollIntoView({behavior:"smooth",block:"start"})}),m.JO))},ref:a,focusOnMount:W,className:"search-panel-header-input",readOnly:t}),(0,s.jsxs)("div",{className:"search-header-button-container",children:[""!==S&&(0,s.jsx)(T.$,{onClick:()=>{U(""),a.current&&!M&&a.current.focus()},label:F,size:y.M.SMALL,variant:y.A.TERTIARY}),G&&(0,s.jsx)(O,{query:S,keywordFilters:b,typeFilters:j})]})]}),e]})}var M=n(16112);const{SEARCH:P}=a.A.SHOWCASE;function D({id:e,label:t}){const n=(0,k.L)(),i=(0,h.Y)().t(P.FILTER_SEARCH_REMOVE);return(0,s.jsx)(T.$,{icon:"close",label:t,tooltip:i,tooltipOptions:{placement:"bottom"},size:y.M.SMALL,variant:y.A.FAB,theme:"dark",onClick:()=>{n.issueCommand(new E._w(e,!1))},reverse:!0})}function H(){const e=(0,h.Y)(),t=(0,M.f)(""),n=(0,v.h)();if(0===n.length)return null;const i=[];return n.forEach((n=>{const o=t[n];if(o){const t=e.t(o.groupPhraseKey);i.push((0,s.jsx)(D,{id:n,label:t},n))}})),(0,s.jsx)("div",{className:"search-filter-pills",children:i})}function U(e){const{shareEnabled:t=!1,filterPills:n=!1,filter:i}=e;return(0,s.jsxs)("div",{className:"list-subheaders",children:[(0,s.jsx)(j,{filter:i,shareEnabled:t}),n&&(0,s.jsx)(H,{})]})}},74481:(e,t,n)=>{"use strict";n.d(t,{M:()=>c});var s=n(13397),i=n(75410),o=n(59475),r=n(73566),a=n(48411);function c(){const e=(0,s.e)(),t=(0,i.h)(),n=(0,o.e)(),c=(0,a.T)(),l=c===r.S0.SEARCH||c===r.S0.LAYERS;return!!e||l&&t.length>0||n.length>0}},27817:(e,t,n)=>{"use strict";n.d(t,{w:()=>o});var s=n(98236),i=n(78849);const o=(0,s.v_)(i.L)},16112:(e,t,n)=>{"use strict";n.d(t,{f:()=>r});var s=n(96540),i=n(27817),o=n(47613);function r(e){const t=(0,i.w)(),n=(0,o._)(),[r,a]=(0,s.useState)({});return(0,s.useEffect)((()=>{if(!t||!n)return()=>{};function s(){if(t&&n)if(e&&n.getCurrentView().connections.length){const s={};for(const i of Object.keys(t.dataTypeGroups)){const o=t.dataTypeGroups[i].matches.filter((t=>{const s=t.getLayerGroupId();if(!s)return!1;const i=null==n?void 0:n.getLayerSource(s);return i===e||!i}));s[i]=Object.assign(Object.assign({},t.dataTypeGroups[i]),{matches:o,subscriptions:[]})}a(s)}else a(t.dataTypeGroups)}const i=t.onChanged(s);return s(),()=>i.cancel()}),[t,n,e]),r}},59475:(e,t,n)=>{"use strict";n.d(t,{e:()=>o});var s=n(96540),i=n(27817);function o(){const e=(0,i.w)(),[t,n]=(0,s.useState)((null==e?void 0:e.getKeywordFilters())||[]);return(0,s.useEffect)((()=>{if(!e)return()=>{};function t(){e&&n(e.getKeywordFilters())}const s=e.keywordFilters.onChanged(t);return t(),()=>s.cancel()}),[e]),t}},13397:(e,t,n)=>{"use strict";n.d(t,{e:()=>o});var s=n(87805),i=n(78849);const o=(0,s.u)(i.L,"query","")},64695:(e,t,n)=>{"use strict";n.d(t,{W:()=>c});var s=n(96540),i=n(27817),o=n(53289),r=n(78115),a=n(49138);function c(){const e=(0,s.useContext)(a.o),t=(0,i.w)(),[n,c]=(0,s.useState)([]);return(0,s.useEffect)((()=>{if(!t)return()=>{};function n(){t&&!(null==e?void 0:e.results)&&c(t.getResults())}const s=t.onSearchResultsChanged(n);return n(),()=>s.cancel()}),[null==e?void 0:e.results,t]),(0,o.J)(r.MT,(()=>{null==t||t.setResults([])})),(null==e?void 0:e.results)?e.results:n}},75410:(e,t,n)=>{"use strict";n.d(t,{h:()=>o});var s=n(96540),i=n(27817);function o(){const e=(0,i.w)(),[t,n]=(0,s.useState)((null==e?void 0:e.getTypeFilters())||[]);return(0,s.useEffect)((()=>{if(!e)return()=>{};function t(){e&&n(e.getTypeFilters())}const s=e.typeFilters.onChanged(t);return t(),()=>s.cancel()}),[e]),t}},1494:(e,t,n)=>{"use strict";n.d(t,{H:()=>o});var s=n(87805),i=n(78849);const o=(0,s.u)(i.L,"activeItemId",null)},36060:(e,t,n)=>{"use strict";n.d(t,{E:()=>c,Y:()=>a});var s=n(66416),i=n(77201),o=n(76318),r=n(95300);class a extends i.uB{constructor(e){super(),this.payload={maxSize:e.maxSize||o.MF.ULTRAHIGH,aspect:e.aspect||r.BE,origin:e.origin,category:e.category||s.X.USER,onProgress:e.onProgress,waitForUpload:void 0===e.waitForUpload||e.waitForUpload}}}a.id="CAPTURE_SNAPSHOT";class c extends i.uB{constructor(e){super(),this.payload={origin:e.origin,onProgress:e.onProgress,waitForUpload:void 0===e.waitForUpload||e.waitForUpload}}}c.id="EQUIRECTANGULAR_SNAPSHOT"},72790:(e,t,n)=>{"use strict";n.d(t,{G:()=>i});var s=n(77201);class i extends s.QB{constructor(e){super(),this.error=e}}},86426:(e,t,n)=>{"use strict";n.d(t,{Ns:()=>r,gp:()=>i,t6:()=>a,tZ:()=>o});var s=n(77201);class i extends s.uB{constructor(e,t){super(),this.payload={id:e,name:t}}}i.id="RENAME_SNAPSHOT";class o extends s.uB{constructor(e){super(),this.payload={id:e}}}o.id="DELETE_SNAPSHOT";class r extends s.uB{constructor(e,t){super(),this.payload={snapshot:e,viewId:t}}}r.id="UPLOAD_SNAPSHOT";class a extends s.uB{constructor(e){super(),this.payload={id:e}}}a.id="SET_CURRENT_SNAPSHOT_PHOTO"},20172:(e,t,n)=>{"use strict";n.d(t,{Bb:()=>o,LW:()=>i,iM:()=>r});var s=n(77201);class i extends s.QB{constructor(e){super(),this.sweepId=e}}class o extends s.QB{constructor(e,t,n){super(),this.sweepId=e,this.orientation=t,this.deltaAngle=n}}class r extends s.QB{constructor(e){super(),this.sweepId=e}}},8175:(e,t,n)=>{"use strict";n.d(t,{im:()=>f,jd:()=>E});var s=n(68909),i=n(85641),o=n.n(i),r=n(81019),a=n.n(r);class c extends s.ShaderMaterial{constructor(e,t){const n={tMask:{value:e},tPinHole:{value:t},pinColor:{value:new s.Color},opacity:{value:1}};super({vertexShader:o(),fragmentShader:a(),uniforms:n,name:"PinMaterial",transparent:!0})}}var l=n(32024),d=n(3249),u=n(37458),h=n(38069),p=n(95102);const m=n.p+"images/360_placement_pin_mask.png";class f extends s.Mesh{}let g;const v=()=>g||(g=(0,l.y)(m),g);class E extends p.m{constructor(e,t,n,s){const i=new c(v(),t);super(E.geometry,i),this.layers.mask=s.mask,this.name="PinMesh",this.cameraData=n,this._collider=new f(E.colliderGeometry,E.colliderMaterial),this._collider.name="PinMeshCollider",this._collider.material.visible=!1,this.add(this._collider),this.opacityProgress=0,this.shouldHide=!0,this.uniforms=i.uniforms,this.unhover(),this.selected=0,this.visible=!1,this.position.copy(e),this.renderOrder=u.X.pins360}updatePosition(e){this.position.copy(e)}get collider(){return this._collider}render(e){this.quaternion.copy(this.cameraData.pose.rotation),null===this.uniforms.tPinHole.value?this.opacityProgress=0:!this.shouldHide&&this.opacityProgress<1?this.opacityProgress+=e/E.FADE_DURATION:this.shouldHide&&this.opacityProgress>0&&(this.opacityProgress-=e/E.FADE_DURATION),this.opacityProgress=(0,d.qE)(this.opacityProgress,0,1),this.uniforms.opacity.value=this.opacityProgress,this.visible=0!==this.opacityProgress}activate(){this.shouldHide=!1}deactivate(){this.shouldHide=!0}isActive(){return!this.shouldHide}dispose(){this.collider.geometry.dispose(),this.collider.material.dispose()}setPinHover(e,t=!0,n=!0){const s=Math.min(Math.max(e,0),1);this.selected!==s&&(n&&this.uniforms.pinColor.value.copy(h.V.WHITE).lerp(h.V.MP_BRAND,s),t&&s>0&&s<=1&&(this.material.depthTest=!1),0===s&&(this.material.depthTest=!0),this.selected=s)}unhover(){this.uniforms.pinColor.value.copy(h.V.WHITE)}}E.FADE_DURATION=500,E.geometry=new s.PlaneGeometry(1.5,1.5),E.colliderGeometry=new s.SphereGeometry(1.5*.65),E.colliderMaterial=new s.MeshBasicMaterial({transparent:!0,opacity:.5,depthWrite:!1,color:16724312})},85357:(e,t,n)=>{"use strict";var s;n.d(t,{j:()=>s}),function(e){e.CLOSED="closed",e.IDLE="idle",e.PRESSING="pressing",e.PLACING="placing",e.MOVING="moving",e.ROTATING="rotating",e.ROTATED="rotated"}(s||(s={}))},11525:(e,t,n)=>{"use strict";n.d(t,{N:()=>i,k:()=>o});var s=n(77201);class i extends s.QB{constructor(e,t){super(),this.sweepId=e,this.selected=t}}class o extends s.QB{constructor(e,t,n){super(),this.sweepId=e,this.pinIndex=t,this.placed=n}}},16716:(e,t,n)=>{"use strict";n.d(t,{l:()=>l});var s=n(32024);const i=n.p+"images/exterior.png",o=n.p+"images/exterior_hover.png",r=n.p+"images/interior.png",a=n.p+"images/interior_hover.png";let c;const l={get:()=>c||(c={toExteriorTexture:(0,s.y)(i),toExteriorHoverTexture:(0,s.y)(o),toInteriorTexture:(0,s.y)(r),toInteriorHoverTexture:(0,s.y)(a)},c)}},70836:(e,t,n)=>{"use strict";n.d(t,{y:()=>i});var s=n(38069);const i=[{outerRadius:1,innerRadius:.97,color:s.V.BLACK.clone(),opacity:.1},{outerRadius:.97,innerRadius:.65,color:s.V.WHITE.clone(),opacity:.64},{outerRadius:.65,innerRadius:.62,color:s.V.BLACK.clone(),opacity:.13}]},58062:(e,t,n)=>{"use strict";n.d(t,{k:()=>o});var s=n(87805),i=n(96319);const o=(0,s.u)(i.M,"softOpening",!1)},42329:(e,t,n)=>{"use strict";n.d(t,{jl:()=>r,ly:()=>i,qO:()=>o});var s=n(77201);class i extends s.uB{constructor(e){super(),this.payload={search:e}}}i.id="USERS_SEARCH";class o extends s.uB{constructor(e){super(),this.payload={userMentions:e}}}o.id="USERS_MENTIONS_FETCH";class r extends s.uB{constructor(e,t,n,s){super(),this.payload={emails:e,message:t,modelAccess:n,noteId:s}}}r.id="USERS_INVITE"},304:(e,t,n)=>{"use strict";n.d(t,{_:()=>o,x:()=>i});var s=n(77201);class i extends s.uB{constructor(){super()}}i.id="LOCK_VIEWMODE";class o extends s.uB{constructor(){super()}}o.id="UNLOCK_VIEWMODE"},79388:(e,t,n)=>{"use strict";n.d(t,{aF:()=>r,lo:()=>i,ul:()=>o});var s=n(77201);class i extends s.QB{constructor(e){super(),this.pixelRatio=e}}class o extends s.QB{constructor(e){super(),this.event=e}}class r extends s.QB{constructor(e){super(),this.event=e}}},73586:(e,t,n)=>{"use strict";n.d(t,{i:()=>o});var s=n(76185),i=n(77201);class o{constructor(e){this.waitingGets=new Map,this.comparer=e||this.defaultComparer,this.poolArray=[]}add(e,t=!0){const n=this.createObjectDescriptor(e);return n.object=e,n.inUse=t,this.addObjectDescriptorToPool(n),n}get(e){for(const t of this.poolArray)if(!t.inUse&&this.comparer(t,e))return t.inUse=!0,t;return null}async tryGetAndWait(e){const t=this.get(e);if(t)return Promise.resolve(t);{const t=e||"no-criteria";this.waitingGets.has(t)||this.waitingGets.set(t,[]);const n=this.waitingGets.get(t);(0,s.$)(n);const o=new i.iB;return n.push(o),o.nativePromise()}}free(e){for(const t of this.poolArray)if(t.object===e){const e=this.isWaitingForObject(t);return e?e.resolve(t):t.inUse=!1,!0}return!1}isWaitingForObject(e){if(this.waitingGets.size>0)for(const[t,n]of this.waitingGets.entries())if(n.length>0){if("no-criteria"===t||this.comparer(e,t)){const e=n.shift();if(e)return e}}return null}all(){return this.poolArray}defaultComparer(e,t){return!0}createObjectDescriptor(e){return{object:e,inUse:!1}}addObjectDescriptorToPool(e){this.poolArray.push(e)}}},81019:e=>{e.exports="precision highp float;precision highp int;varying vec2 vUv;uniform sampler2D tMask;uniform sampler2D tPinHole;uniform vec3 pinColor;uniform float opacity;void main(){vec4 maskColor=texture2D(tMask,vUv);vec4 pinHoleColor=vec4(texture2D(tPinHole,vec2(vUv.x,vUv.y-0.11)).xyz,1.);float redness=maskColor.r-maskColor.b;vec4 mixedPinColor=mix(vec4(pinColor,1.),pinHoleColor,redness);mixedPinColor.a=min(mixedPinColor.a,maskColor.a)*opacity;if(mixedPinColor.a==0.)discard;gl_FragColor=linearToOutputTexel(mixedPinColor);}"},85641:e=>{e.exports="precision highp float;precision highp int;varying vec2 vUv;void main(){vUv=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);}"}}]);